{
    "id":"001404",
    "text": "分行业指标",
    "layout": {
        "xtype": "tab"
    },
    "showDims": ["year","month","company","conversion"],
        // 切换公司时做处理（合并显示，单体隐藏）
    "changeCompanyBefore":function(newcompany,option){
        debugger
        this.showSet(this.items); 
        option.closeTabTaget(newcompany,option);
    },
    "changeYearBefore":function(newyear,option){
        option.closeTabTaget(newyear,option);
    },
    "changeMonthBefore":function(newmonth,option){
        debugger
        option.closeTabTaget(newmonth,option);
    },
    "config": {
        // sql2的语句为科目固定显示
        // "sql2":" WITH T1 AS( SELECT DIM_COMPANY, SUM((CASE WHEN DIM_ITEMPOINT='1100100' AND DIM_PERIOD=:period THEN FACT_B ELSE 0 END)) AS ZCZE, SUM((CASE WHEN DIM_ITEMPOINT='1100100' AND DIM_PERIOD=:comparePeriod THEN FACT_B ELSE 0 END)) AS ZCZETQ, SUM((CASE WHEN DIM_ITEMPOINT='1300100' AND DIM_PERIOD=:period THEN FACT_B ELSE 0 END)) AS SYZQY, SUM((CASE WHEN DIM_ITEMPOINT='1300100' AND DIM_PERIOD=:comparePeriod THEN FACT_B ELSE 0 END)) AS SYZQYTQ FROM DW_FACTFINANCEPOINT WHERE DIM_ITEMPOINT IN ('1100100','1300100') AND DIM_PERIOD IN( :period, :comparePeriod) GROUP BY DIM_COMPANY), T2 AS ( SELECT A.SCODE COMCODE,A.SNAME COMNAME, B.SCODE INSCODE, B.SNAME INNAME FROM DW_DIMCOMPANY A RIGHT JOIN DW_DIMINDUSTRY B ON A.SINDCODE=B.SCODE order by B.SCODE ), T3 AS( SELECT T2.COMCODE AS DIM_COMPANY,T2.INNAME,T2.INSCODE, SUM((CASE WHEN DIM_ITEMPERIOD='1416001' AND DIM_PERIOD=:period THEN FACT_B ELSE 0 END)) AS YYSR, SUM((CASE WHEN DIM_ITEMPERIOD='1416001' AND DIM_PERIOD=:comparePeriod THEN FACT_B ELSE 0 END)) AS YYSRTQ, SUM((CASE WHEN DIM_ITEMPERIOD='1426400' AND DIM_PERIOD=:period THEN FACT_B ELSE 0 END)) AS YYCB, SUM((CASE WHEN DIM_ITEMPERIOD='1426400' AND DIM_PERIOD=:comparePeriod THEN FACT_B ELSE 0 END)) AS YYCBTQ, SUM((CASE WHEN DIM_ITEMPERIOD='1436601' AND DIM_PERIOD=:period THEN FACT_B ELSE 0 END)) AS XSFY, SUM((CASE WHEN DIM_ITEMPERIOD='1436601' AND DIM_PERIOD=:comparePeriod THEN FACT_B ELSE 0 END)) AS XSFYTQ, SUM((CASE WHEN DIM_ITEMPERIOD='1436602' AND DIM_PERIOD=:period THEN FACT_B ELSE 0 END)) AS GLFY, SUM((CASE WHEN DIM_ITEMPERIOD='1436602' AND DIM_PERIOD=:comparePeriod THEN FACT_B ELSE 0 END)) AS GLFYTQ, SUM((CASE WHEN DIM_ITEMPERIOD='1436603' AND DIM_PERIOD=:period THEN FACT_B ELSE 0 END)) AS CWFY, SUM((CASE WHEN DIM_ITEMPERIOD='1436603' AND DIM_PERIOD=:comparePeriod THEN FACT_B ELSE 0 END)) AS CWFYTQ, SUM((CASE WHEN DIM_ITEMPERIOD='1403100' AND DIM_PERIOD=:period THEN FACT_B ELSE 0 END)) AS LRZE, SUM((CASE WHEN DIM_ITEMPERIOD='1403100' AND DIM_PERIOD=:comparePeriod THEN FACT_B ELSE 0 END)) AS LRZETQ, ZCZE, ZCZETQ, SYZQY, SYZQYTQ FROM T2 left JOIN DW_FACTFINANCEPERIOD C ON C.DIM_COMPANY=T2.COMCODE and DIM_ITEMPERIOD IN ('1416001','1426400','1436601','1436602','1436603','1403100') AND DIM_PERIOD IN( :period, :comparePeriod) LEFT JOIN T1 ON C.DIM_COMPANY=T1.DIM_COMPANY GROUP BY T2.INNAME,T2.INSCODE,ZCZE, ZCZETQ, SYZQY, SYZQYTQ,T2.COMCODE ) , T4 AS ( SELECT CONNECT_BY_ROOT SCODE AS ROOT_SCODE, SCODE FROM DW_DIMCOMPANY WHERE CISDEL='N' AND STYPE='1' CONNECT BY PRIOR SCODE = SPCODE ), T5 AS( SELECT ROOT_SCODE,SCODE FROM T4 WHERE ROOT_SCODE IN(SELECT SCODE FROM DW_DIMCOMPANY WHERE CISDEL='N' START WITH SCODE=:company CONNECT BY PRIOR SCODE = SPCODE ) ) SELECT INNAME，INSCODE， SUM(YYSR) yysr, SUM(YYSRTQ) yysrtq, SUM(YYCB) yycb, SUM(YYCBTQ) yycbtq, SUM(XSFY) xsfy, SUM(XSFYTQ) xsfytq, SUM(GLFY) glfy, SUM(GLFYTQ) glfytq, SUM(CWFY) cwfy, SUM(CWFYTQ) cwfytq, SUM(LRZE) lrze, SUM(LRZETQ) lizetq, SUM(ZCZE) zcze, SUM(ZCZETQ) zczetq, SUM(SYZQY) syzqy, SUM(SYZQYTQ) syzqytq FROM T3 left join t5 on t5.scode = t3.dim_company GROUP BY INSCODE, INNAME order by to_number(t3.INSCODE)",
        "sql" : "WITH T1 AS( SELECT DIM_COMPANY, SUM((CASE WHEN DIM_ITEMPOINT='1100100' AND DIM_PERIOD=:period THEN FACT_B ELSE 0 END)) AS ZCZE, SUM((CASE WHEN DIM_ITEMPOINT='1100100' AND DIM_PERIOD=:comparePeriod THEN FACT_B ELSE 0 END)) AS ZCZETQ, SUM((CASE WHEN DIM_ITEMPOINT='1300100' AND DIM_PERIOD=:period THEN FACT_B ELSE 0 END)) AS SYZQY, SUM((CASE WHEN DIM_ITEMPOINT='1300100' AND DIM_PERIOD=:comparePeriod THEN FACT_B ELSE 0 END)) AS SYZQYTQ FROM DW_FACTFINANCEPOINT WHERE DIM_ITEMPOINT IN ('1100100','1300100') AND DIM_PERIOD IN( :period, :comparePeriod) GROUP BY DIM_COMPANY), T2 AS ( SELECT A.SCODE COMCODE,A.SNAME COMNAME, B.SCODE INSCODE, B.SNAME INNAME FROM DW_DIMCOMPANY A RIGHT JOIN DW_DIMINDUSTRY B ON A.SINDCODE=B.SCODE ), T3 AS( SELECT C.DIM_COMPANY,T2.INNAME,T2.INSCODE, SUM((CASE WHEN DIM_ITEMPERIOD='1416001' AND DIM_PERIOD=:period THEN FACT_B ELSE 0 END)) AS YYSR, SUM((CASE WHEN DIM_ITEMPERIOD='1416001' AND DIM_PERIOD=:comparePeriod THEN FACT_B ELSE 0 END)) AS YYSRTQ, SUM((CASE WHEN DIM_ITEMPERIOD='1426400' AND DIM_PERIOD=:period THEN FACT_B ELSE 0 END)) AS YYCB, SUM((CASE WHEN DIM_ITEMPERIOD='1426400' AND DIM_PERIOD=:comparePeriod THEN FACT_B ELSE 0 END)) AS YYCBTQ, SUM((CASE WHEN DIM_ITEMPERIOD='1436601' AND DIM_PERIOD=:period THEN FACT_B ELSE 0 END)) AS XSFY, SUM((CASE WHEN DIM_ITEMPERIOD='1436601' AND DIM_PERIOD=:comparePeriod THEN FACT_B ELSE 0 END)) AS XSFYTQ, SUM((CASE WHEN DIM_ITEMPERIOD='1436602' AND DIM_PERIOD=:period THEN FACT_B ELSE 0 END)) AS GLFY, SUM((CASE WHEN DIM_ITEMPERIOD='1436602' AND DIM_PERIOD=:comparePeriod THEN FACT_B ELSE 0 END)) AS GLFYTQ, SUM((CASE WHEN DIM_ITEMPERIOD='1436603' AND DIM_PERIOD=:period THEN FACT_B ELSE 0 END)) AS CWFY, SUM((CASE WHEN DIM_ITEMPERIOD='1436603' AND DIM_PERIOD=:comparePeriod THEN FACT_B ELSE 0 END)) AS CWFYTQ, SUM((CASE WHEN DIM_ITEMPERIOD='1403100' AND DIM_PERIOD=:period THEN FACT_B ELSE 0 END)) AS LRZE, SUM((CASE WHEN DIM_ITEMPERIOD='1403100' AND DIM_PERIOD=:comparePeriod THEN FACT_B ELSE 0 END)) AS LRZETQ, ZCZE, ZCZETQ, SYZQY, SYZQYTQ FROM DW_FACTFINANCEPERIOD C LEFT JOIN T1 ON C.DIM_COMPANY=T1.DIM_COMPANY RIGHT JOIN T2 ON C.DIM_COMPANY=T2.COMCODE WHERE DIM_ITEMPERIOD IN ('1416001','1426400','1436601','1436602','1436603','1403100') AND DIM_PERIOD IN( :period, :comparePeriod) GROUP BY C.DIM_COMPANY,ZCZE, ZCZETQ, SYZQY, SYZQYTQ,T2.INNAME,T2.INSCODE ) , T4 AS ( SELECT CONNECT_BY_ROOT SCODE AS ROOT_SCODE, SCODE FROM DW_DIMCOMPANY WHERE CISDEL='N' AND STYPE='1' CONNECT BY PRIOR SCODE = SPCODE ), T5 AS( SELECT ROOT_SCODE,SCODE FROM T4 WHERE ROOT_SCODE IN(SELECT SCODE FROM DW_DIMCOMPANY WHERE CISDEL='N' START WITH SCODE=:company CONNECT BY PRIOR SCODE = SPCODE ) ) SELECT INNAME， SUM(YYSR) yysr, SUM(YYSRTQ) yysrtq, SUM(YYCB) yycb, SUM(YYCBTQ) yycbtq, SUM(XSFY) xsfy, SUM(XSFYTQ) xsfytq, SUM(GLFY) glfy, SUM(GLFYTQ) glfytq, SUM(CWFY) cwfy, SUM(CWFYTQ) cwfytq, SUM(LRZE) lrze, SUM(LRZETQ) lrzetq, SUM(ZCZE) zcze, SUM(ZCZETQ) zczetq, SUM(SYZQY) syzqy, SUM(SYZQYTQ) syzqytq FROM T3 inner join t5 on t5.scode = t3.dim_company GROUP BY INNAME"
        ,"_cube": {
            "cubeId": 4 ,
            "subject": "0002"
        },
        "mainDim":"itempoint",
        "needDims":["year","month","company","conversion"],
        "random":{"min":100,"max":100000},
        "tableHeads":true,
        "type":1,
        "generateVar":{//生成变量rows
            "periodCount":2,
            "compareType":"-1&0",
            "reverse":true
        }   
    },
    "columns": [
        {
            "id" : "",
            "type" : "string",
            "text" : "所有者权益累计数",
            "children" : [
                {
                    "id" : "syzqy",
                    "type" : "decimal",
                    "text" : "本期",
                    "width": "170px"
                },
                {
                    "id" : "syzqytq",
                    "type" : "decimal",
                    "text" : "上年同期",
                    "width": "170px"
                }
            ]
        },
        {
            "id": "inname",
            "type": "string",
            "width": "230px",
            "text": "行业名称"
        },
        {
            "id": "",
            "type" : "string",
            "text" : "营业收入累计数",
            "children": [
                {
                    "id" : "yysr",
                    "type" : "decimal",
                    "text" : "本期",
                    "width": "170px"
                },
                {
                    "id" : "yysrtq",
                    "type" : "decimal",
                    "text" : "同期",
                    "width": "170px"
                }
            ]
        },
        {
            "id" : "",
            "type" : "string",
            "text" : "营业成本累计数",
            "children": [
                {
                    "id" : "yycb",
                    "type" : "decimal",
                    "text" : "本期",
                    "width": "170px"
                },
                {
                    "id" : "yycbtq",
                    "type" : "decimal",
                    "text" : "同期",
                    "width": "170px"
                }
            ]
        },
        {
            "id" : "",
            "type" : "string",
            "text" : "销售费用累计数",
            "children" : [
                {
                    "id" : "xsfy",
                    "type" : "decimal",
                    "text" : "本期",
                    "width": "170px"
                },
                {
                    "id" : "xsfytq",
                    "type" : "decimal",
                    "text" : "同期",
                    "width": "170px"
                }
            ]
        },
        {
            "id" : "",
            "type" : "string",
            "text" : "管理费用累计数",
            "children" : [
                {
                    "id" : "glfy",
                    "type" : "decimal",
                    "text" : "本期",
                    "width": "170px"
                },
                {
                    "id" : "glfytq",
                    "type" : "decimal",
                    "text" : "同期",
                    "width": "170px"
                }
            ]
        },
        {
            "id" : "",
            "type" : "string",
            "text" : "财务费用累计数",
            "children" : [
                {
                    "id" : "cwfy",
                    "type" : "decimal",
                    "text" : "本期",
                    "width": "170px"
                },
                {
                    "id" : "cwfytq",
                    "type" : "decimal",
                    "text" : "同期",
                    "width": "170px"
                }
            ]
        },
        {
            "id" : "",
            "type" : "string",
            "text" : "利润总额累计数",
            "children": [
                {
                    "id" : "lrze",
                    "type" : "decimal",
                    "text" : "本期",
                    "width": "170px"
                },
                {
                    "id" : "lrzetq",
                    "type" : "decimal",
                    "text" : "同期",
                    "width": "170px"
                }
            ]
        },
        {
            "id" : "",
            "type" : "string",
            "text" : "资产总额累计数",
            "children": [
                {
                    "id" : "zcze",
                    "type" : "decimal",
                    "text" : "本期",
                    "width": "170px"
                },
                {
                    "id" : "zczetq",
                    "type" : "decimal",
                    "text" : "同期",
                    "width": "170px"
                }
            ]
        }
    ],
    "rows": [
        // {
        //     "hymc" : "现代农牧渔业"
        // },
        // {
        //     "hymc" : "食品加工业"
        // },
        // {
        //     "hymc" : "食品贸易"
        // },
        // {
        //     "hymc" : "粮油贸易"
        // },
        // {
        //     "hymc" : "冷链仓库"
        // },
        // {
        //     "hymc" : "房地产业"
        // },
        // {
        //     "hymc" : "商品贸易"
        // },
        // {
        //     "hymc" : "钢材贸易"
        // },
        // {
        //     "hymc" : "非食品加工业"
        // },
        // {
        //     "hymc" : "金融业"
        // },
        // {
        //     "hymc" : "服务业"
        // },
        // {
        //     "hymc" : "抵消差额"
        // }
    ],
    "items":[
        {
            "xtype" : "bi-table",
            "id" : "fhyzb",
            "text" : "分行业指标",
            "show": true,
            "toolbar":[{    
                "id":"1",
                "text":"刷新",
                "xtype":"button",
                "cellStyle":{
                    "color":"black",
                    // "background-color":"#189271"
                    "background-color":"#fff"
                },
                "handler":function(vue,btn){
                    debugger
                    console.log(vue);
                    let $vue = vue.item.$vue;
                    $vue.closeTabTaget({}, $vue);
                    vue.item.updateView("company");
                }
            },{
                "id":"2",
                "text":"导出",
                "xtype":"button",
                "cellStyle":{
                    "color":"black",
                    // "background-color":"#189271"
                    "background-color":"#fff"
                },
                "handler":function(vue,btn){
                    debugger
                    console.log(vue);
                    vue.handleDownload(vue);
                }
            }]
            // "showFun":function($store){
            //     debugger
            //     if($store.getters.treeInfo.leaf){
            //         return false ;
            //     }else{
            //         return true ;
            //     }                       
            // }
        }
    ]
}