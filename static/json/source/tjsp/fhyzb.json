{
    "id":"001404",
    "text": "分行业指标",
    "layout": {
        "xtype": "tab"
    },
    "showDims": ["year","month","company","conversion"],
        // 切换公司时做处理（合并显示，单体隐藏）
    "changeCompanyBefore":function(newcompany,option){
        debugger
        this.showSet(this.items); 
        option.closeTabTaget(newcompany,option);
    },
    "changeYearBefore":function(newyear,option){
        option.closeTabTaget(newyear,option);
    },
    "changeMonthBefore":function(newmonth,option){
        debugger
        option.closeTabTaget(newmonth,option);
    },
    "__queryDataAfter":function(data,$vue){//数据的后置处理
        debugger
        
        let me = this;
        me.items[0].updateView = $vue.updateView;
        me.items[0].$vue = $vue;
        return data;
    },
    "config": {
        // sql2的语句为科目固定显示
        // "sql2":" WITH T1 AS( SELECT DIM_COMPANY, SUM((CASE WHEN DIM_ITEMPOINT='1100100' AND DIM_PERIOD=:period THEN FACT_B ELSE 0 END)) AS ZCZE, SUM((CASE WHEN DIM_ITEMPOINT='1100100' AND DIM_PERIOD=:comparePeriod THEN FACT_B ELSE 0 END)) AS ZCZETQ, SUM((CASE WHEN DIM_ITEMPOINT='1300100' AND DIM_PERIOD=:period THEN FACT_B ELSE 0 END)) AS SYZQY, SUM((CASE WHEN DIM_ITEMPOINT='1300100' AND DIM_PERIOD=:comparePeriod THEN FACT_B ELSE 0 END)) AS SYZQYTQ FROM DW_FACTFINANCEPOINT WHERE DIM_ITEMPOINT IN ('1100100','1300100') AND DIM_PERIOD IN( :period, :comparePeriod) GROUP BY DIM_COMPANY), T2 AS ( SELECT A.SCODE COMCODE,A.SNAME COMNAME, B.SCODE INSCODE, B.SNAME INNAME FROM DW_DIMCOMPANY A RIGHT JOIN DW_DIMINDUSTRY B ON A.SINDCODE=B.SCODE order by B.SCODE ), T3 AS( SELECT T2.COMCODE AS DIM_COMPANY,T2.INNAME,T2.INSCODE, SUM((CASE WHEN DIM_ITEMPERIOD='1416001' AND DIM_PERIOD=:period THEN FACT_B ELSE 0 END)) AS YYSR, SUM((CASE WHEN DIM_ITEMPERIOD='1416001' AND DIM_PERIOD=:comparePeriod THEN FACT_B ELSE 0 END)) AS YYSRTQ, SUM((CASE WHEN DIM_ITEMPERIOD='1426400' AND DIM_PERIOD=:period THEN FACT_B ELSE 0 END)) AS YYCB, SUM((CASE WHEN DIM_ITEMPERIOD='1426400' AND DIM_PERIOD=:comparePeriod THEN FACT_B ELSE 0 END)) AS YYCBTQ, SUM((CASE WHEN DIM_ITEMPERIOD='1436601' AND DIM_PERIOD=:period THEN FACT_B ELSE 0 END)) AS XSFY, SUM((CASE WHEN DIM_ITEMPERIOD='1436601' AND DIM_PERIOD=:comparePeriod THEN FACT_B ELSE 0 END)) AS XSFYTQ, SUM((CASE WHEN DIM_ITEMPERIOD='1436602' AND DIM_PERIOD=:period THEN FACT_B ELSE 0 END)) AS GLFY, SUM((CASE WHEN DIM_ITEMPERIOD='1436602' AND DIM_PERIOD=:comparePeriod THEN FACT_B ELSE 0 END)) AS GLFYTQ, SUM((CASE WHEN DIM_ITEMPERIOD='1436603' AND DIM_PERIOD=:period THEN FACT_B ELSE 0 END)) AS CWFY, SUM((CASE WHEN DIM_ITEMPERIOD='1436603' AND DIM_PERIOD=:comparePeriod THEN FACT_B ELSE 0 END)) AS CWFYTQ, SUM((CASE WHEN DIM_ITEMPERIOD='1403100' AND DIM_PERIOD=:period THEN FACT_B ELSE 0 END)) AS LRZE, SUM((CASE WHEN DIM_ITEMPERIOD='1403100' AND DIM_PERIOD=:comparePeriod THEN FACT_B ELSE 0 END)) AS LRZETQ, ZCZE, ZCZETQ, SYZQY, SYZQYTQ FROM T2 left JOIN DW_FACTFINANCEPERIOD C ON C.DIM_COMPANY=T2.COMCODE and DIM_ITEMPERIOD IN ('1416001','1426400','1436601','1436602','1436603','1403100') AND DIM_PERIOD IN( :period, :comparePeriod) LEFT JOIN T1 ON C.DIM_COMPANY=T1.DIM_COMPANY GROUP BY T2.INNAME,T2.INSCODE,ZCZE, ZCZETQ, SYZQY, SYZQYTQ,T2.COMCODE ) , T4 AS ( SELECT CONNECT_BY_ROOT SCODE AS ROOT_SCODE, SCODE FROM DW_DIMCOMPANY WHERE CISDEL='N' AND STYPE='1' CONNECT BY PRIOR SCODE = SPCODE ), T5 AS( SELECT ROOT_SCODE,SCODE FROM T4 WHERE ROOT_SCODE IN(SELECT SCODE FROM DW_DIMCOMPANY WHERE CISDEL='N' START WITH SCODE=:company CONNECT BY PRIOR SCODE = SPCODE ) ) SELECT INNAME，INSCODE， SUM(YYSR) yysr, SUM(YYSRTQ) yysrtq, SUM(YYCB) yycb, SUM(YYCBTQ) yycbtq, SUM(XSFY) xsfy, SUM(XSFYTQ) xsfytq, SUM(GLFY) glfy, SUM(GLFYTQ) glfytq, SUM(CWFY) cwfy, SUM(CWFYTQ) cwfytq, SUM(LRZE) lrze, SUM(LRZETQ) lizetq, SUM(ZCZE) zcze, SUM(ZCZETQ) zczetq, SUM(SYZQY) syzqy, SUM(SYZQYTQ) syzqytq FROM T3 left join t5 on t5.scode = t3.dim_company GROUP BY INSCODE, INNAME order by to_number(t3.INSCODE)",
        // 不固定  没有关联公司表
        // "sql" : "WITH T1 AS( SELECT DIM_COMPANY, SUM((CASE WHEN DIM_ITEMPOINT='1100100' AND DIM_PERIOD=:period THEN FACT_B ELSE 0 END)) AS ZCZE, SUM((CASE WHEN DIM_ITEMPOINT='1100100' AND DIM_PERIOD=:comparePeriod THEN FACT_B ELSE 0 END)) AS ZCZETQ, SUM((CASE WHEN DIM_ITEMPOINT='1300100' AND DIM_PERIOD=:period THEN FACT_B ELSE 0 END)) AS SYZQY, SUM((CASE WHEN DIM_ITEMPOINT='1300100' AND DIM_PERIOD=:comparePeriod THEN FACT_B ELSE 0 END)) AS SYZQYTQ FROM DW_FACTFINANCEPOINT WHERE DIM_ITEMPOINT IN ('1100100','1300100') AND DIM_PERIOD IN( :period, :comparePeriod) GROUP BY DIM_COMPANY), T2 AS ( SELECT A.SCODE COMCODE,A.SNAME COMNAME, B.SCODE INSCODE, B.SNAME INNAME FROM DW_DIMCOMPANY A RIGHT JOIN DW_DIMINDUSTRY B ON A.SINDCODE=B.SCODE ), T3 AS( SELECT C.DIM_COMPANY,T2.INNAME,T2.INSCODE, SUM((CASE WHEN DIM_ITEMPERIOD='1416001' AND DIM_PERIOD=:period THEN FACT_B ELSE 0 END)) AS YYSR, SUM((CASE WHEN DIM_ITEMPERIOD='1416001' AND DIM_PERIOD=:comparePeriod THEN FACT_B ELSE 0 END)) AS YYSRTQ, SUM((CASE WHEN DIM_ITEMPERIOD='1426400' AND DIM_PERIOD=:period THEN FACT_B ELSE 0 END)) AS YYCB, SUM((CASE WHEN DIM_ITEMPERIOD='1426400' AND DIM_PERIOD=:comparePeriod THEN FACT_B ELSE 0 END)) AS YYCBTQ, SUM((CASE WHEN DIM_ITEMPERIOD='1436601' AND DIM_PERIOD=:period THEN FACT_B ELSE 0 END)) AS XSFY, SUM((CASE WHEN DIM_ITEMPERIOD='1436601' AND DIM_PERIOD=:comparePeriod THEN FACT_B ELSE 0 END)) AS XSFYTQ, SUM((CASE WHEN DIM_ITEMPERIOD='1436602' AND DIM_PERIOD=:period THEN FACT_B ELSE 0 END)) AS GLFY, SUM((CASE WHEN DIM_ITEMPERIOD='1436602' AND DIM_PERIOD=:comparePeriod THEN FACT_B ELSE 0 END)) AS GLFYTQ, SUM((CASE WHEN DIM_ITEMPERIOD='1436603' AND DIM_PERIOD=:period THEN FACT_B ELSE 0 END)) AS CWFY, SUM((CASE WHEN DIM_ITEMPERIOD='1436603' AND DIM_PERIOD=:comparePeriod THEN FACT_B ELSE 0 END)) AS CWFYTQ, SUM((CASE WHEN DIM_ITEMPERIOD='1403100' AND DIM_PERIOD=:period THEN FACT_B ELSE 0 END)) AS LRZE, SUM((CASE WHEN DIM_ITEMPERIOD='1403100' AND DIM_PERIOD=:comparePeriod THEN FACT_B ELSE 0 END)) AS LRZETQ, ZCZE, ZCZETQ, SYZQY, SYZQYTQ FROM DW_FACTFINANCEPERIOD C LEFT JOIN T1 ON C.DIM_COMPANY=T1.DIM_COMPANY RIGHT JOIN T2 ON C.DIM_COMPANY=T2.COMCODE WHERE DIM_ITEMPERIOD IN ('1416001','1426400','1436601','1436602','1436603','1403100') AND DIM_PERIOD IN( :period, :comparePeriod) GROUP BY C.DIM_COMPANY,ZCZE, ZCZETQ, SYZQY, SYZQYTQ,T2.INNAME,T2.INSCODE ) , T4 AS ( SELECT CONNECT_BY_ROOT SCODE AS ROOT_SCODE, SCODE FROM DW_DIMCOMPANY WHERE CISDEL='N' AND STYPE='1' CONNECT BY PRIOR SCODE = SPCODE ), T5 AS( SELECT ROOT_SCODE,SCODE FROM T4 WHERE ROOT_SCODE IN(SELECT SCODE FROM DW_DIMCOMPANY WHERE CISDEL='N' START WITH SCODE=:company CONNECT BY PRIOR SCODE = SPCODE ) ) SELECT INNAME， SUM(YYSR) yysr, SUM(YYSRTQ) yysrtq, SUM(YYCB) yycb, SUM(YYCBTQ) yycbtq, SUM(XSFY) xsfy, SUM(XSFYTQ) xsfytq, SUM(GLFY) glfy, SUM(GLFYTQ) glfytq, SUM(CWFY) cwfy, SUM(CWFYTQ) cwfytq, SUM(LRZE) lrze, SUM(LRZETQ) lrzetq, SUM(ZCZE) zcze, SUM(ZCZETQ) zczetq, SUM(SYZQY) syzqy, SUM(SYZQYTQ) syzqytq FROM T3 inner join t5 on t5.scode = t3.dim_company GROUP BY INNAME",
        // "sql":"WITH T1 AS( SELECT DIM_COMPANY, SUM(( CASE WHEN DIM_ITEMPOINT='1100100' AND DIM_PERIOD=:period THEN FACT_B ELSE 0 END)) AS ZCZE, SUM(( CASE WHEN DIM_ITEMPOINT='1100100' AND DIM_PERIOD=:comparePeriod THEN FACT_B ELSE 0 END)) AS ZCZETQ, SUM(( CASE WHEN DIM_ITEMPOINT='1300100' AND DIM_PERIOD=:period THEN FACT_B ELSE 0 END)) AS SYZQY, SUM(( CASE WHEN DIM_ITEMPOINT='1300100' AND DIM_PERIOD=:comparePeriod THEN FACT_B ELSE 0 END)) AS SYZQYTQ FROM DW_FACTFINANCEPOINT WHERE DIM_ITEMPOINT IN ('1100100', '1300100') AND DIM_PERIOD IN( :period, :comparePeriod) GROUP BY DIM_COMPANY) , T4 AS ( SELECT CONNECT_BY_ROOT SCODE AS ROOT_SCODE, SCODE FROM DW_DIMCOMPANY WHERE CISDEL='N' AND STYPE='1' CONNECT BY PRIOR SCODE = SPCODE ) , T5 AS ( SELECT ROOT_SCODE, SCODE FROM T4 WHERE ROOT_SCODE IN ( SELECT SCODE FROM DW_DIMCOMPANY WHERE CISDEL='N' START WITH SCODE=:company CONNECT BY PRIOR SCODE = SPCODE ) ) , T2 AS ( SELECT A.SCODE COMCODE, A.SNAME COMNAME, B.SCODE INSCODE, B.SNAME INNAME FROM DW_DIMCOMPANY A RIGHT JOIN DW_DIMINDUSTRY B ON A.SINDCODE=B.SCODE ) , T3 AS ( SELECT C.DIM_COMPANY, T2.INNAME, T2.INSCODE, SUM(( CASE WHEN DIM_ITEMPERIOD='1416001' AND DIM_PERIOD=:period THEN FACT_B ELSE 0 END)) AS YYSR, SUM(( CASE WHEN DIM_ITEMPERIOD='1416001' AND DIM_PERIOD=:comparePeriod THEN FACT_B ELSE 0 END)) AS YYSRTQ, SUM(( CASE WHEN DIM_ITEMPERIOD='1426400' AND DIM_PERIOD=:period THEN FACT_B ELSE 0 END)) AS YYCB, SUM(( CASE WHEN DIM_ITEMPERIOD='1426400' AND DIM_PERIOD=:comparePeriod THEN FACT_B ELSE 0 END)) AS YYCBTQ, SUM(( CASE WHEN DIM_ITEMPERIOD='1436601' AND DIM_PERIOD=:period THEN FACT_B ELSE 0 END)) AS XSFY, SUM(( CASE WHEN DIM_ITEMPERIOD='1436601' AND DIM_PERIOD=:comparePeriod THEN FACT_B ELSE 0 END)) AS XSFYTQ, SUM(( CASE WHEN DIM_ITEMPERIOD='1436602' AND DIM_PERIOD=:period THEN FACT_B ELSE 0 END)) AS GLFY, SUM(( CASE WHEN DIM_ITEMPERIOD='1436602' AND DIM_PERIOD=:comparePeriod THEN FACT_B ELSE 0 END)) AS GLFYTQ, SUM(( CASE WHEN DIM_ITEMPERIOD='1436603' AND DIM_PERIOD=:period THEN FACT_B ELSE 0 END)) AS CWFY, SUM(( CASE WHEN DIM_ITEMPERIOD='1436603' AND DIM_PERIOD=:comparePeriod THEN FACT_B ELSE 0 END)) AS CWFYTQ, SUM(( CASE WHEN DIM_ITEMPERIOD='1403100' AND DIM_PERIOD=:period THEN FACT_B ELSE 0 END)) AS LRZE, SUM(( CASE WHEN DIM_ITEMPERIOD='1403100' AND DIM_PERIOD=:comparePeriod THEN FACT_B ELSE 0 END)) AS LRZETQ, ZCZE, ZCZETQ, SYZQY, SYZQYTQ FROM DW_FACTFINANCEPERIOD C LEFT JOIN T1 ON C.DIM_COMPANY=T1.DIM_COMPANY RIGHT JOIN T2 ON C.DIM_COMPANY=T2.COMCODE WHERE DIM_ITEMPERIOD IN ('1416001', '1426400', '1436601', '1436602', '1436603', '1403100') AND DIM_PERIOD IN( :period, :comparePeriod) and c.DIM_COMPANY in (select ROOT_SCODE from t5) GROUP BY C.DIM_COMPANY, ZCZE, ZCZETQ, SYZQY, SYZQYTQ, T2.INNAME, T2.INSCODE ) , t6 AS ( SELECT DISTINCT tt55.scode, tt55.sname FROM t5 LEFT JOIN DW_DIMCOMPANY tt5 ON t5.scode=tt5.SCODE left JOIN DW_DIMINDUSTRY tt55 ON tt5.SINDCODE=tt55.scode )  SELECT tt77.sname, nvl(yysr,0) yysr, nvl(yysrtq,0) yysrtq, nvl(yycb,0) yycb, nvl(yycbtq,0) yycbtq, nvl(xsfy,0) xsfy, nvl(xsfytq,0) xsfytq, nvl(glfy,0) glfy, nvl(glfytq,0) glfytq, nvl(cwfy,0) cwfy, nvl(cwfytq,0) cwfytq, nvl(lrze,0) lrze, nvl(lizetq,0) lizetq, nvl(zcze,0) zcze, nvl(zczetq,0) zczetq, nvl(syzqy,0) syzqy, nvl(syzqytq,0) syzqytq FROM t6 LEFT JOIN ( SELECT INSCODE, SUM(YYSR) yysr, SUM(YYSRTQ) yysrtq, SUM(YYCB) yycb, SUM(YYCBTQ) yycbtq, SUM(XSFY) xsfy, SUM(XSFYTQ) xsfytq, SUM(GLFY) glfy, SUM(GLFYTQ) glfytq, SUM(CWFY) cwfy, SUM(CWFYTQ) cwfytq, SUM(LRZE) lrze, SUM(LRZETQ) lizetq, SUM(ZCZE) zcze, SUM(ZCZETQ) zczetq, SUM(SYZQY) syzqy, SUM(SYZQYTQ) syzqytq FROM T3 GROUP BY INSCODE ) t66 ON t66.INSCODE=t6.scode right JOIN DW_DIMINDUSTRY tt77 ON tt77.scode=t6.scode ORDER BY tt77.scode",
        // "sql":"WITH T1 AS( SELECT DIM_COMPANY, SUM(( CASE WHEN DIM_ITEMPOINT='1100100' AND DIM_PERIOD=:period THEN FACT_B ELSE 0 END)) AS ZCZE, SUM(( CASE WHEN DIM_ITEMPOINT='1100100' AND DIM_PERIOD=:comparePeriod THEN FACT_B ELSE 0 END)) AS ZCZETQ, SUM(( CASE WHEN DIM_ITEMPOINT='1300100' AND DIM_PERIOD=:period THEN FACT_B ELSE 0 END)) AS SYZQY, SUM(( CASE WHEN DIM_ITEMPOINT='1300100' AND DIM_PERIOD=:comparePeriod THEN FACT_B ELSE 0 END)) AS SYZQYTQ FROM DW_FACTFINANCEPOINT WHERE DIM_ITEMPOINT IN ('1100100', '1300100') AND DIM_PERIOD IN( :period, :comparePeriod) GROUP BY DIM_COMPANY) , T4 AS ( SELECT CONNECT_BY_ROOT SCODE AS ROOT_SCODE, SCODE FROM DW_DIMCOMPANY WHERE CISDEL='N' AND STYPE='1' CONNECT BY PRIOR SCODE = SPCODE ) , T5 AS ( SELECT ROOT_SCODE, SCODE FROM T4 WHERE ROOT_SCODE IN ( SELECT SCODE FROM DW_DIMCOMPANY WHERE CISDEL='N' START WITH SCODE=:company CONNECT BY PRIOR SCODE = SPCODE ) ) , T2 AS ( SELECT A.SCODE COMCODE, A.SNAME COMNAME, B.SCODE INSCODE, B.SNAME INNAME FROM DW_DIMCOMPANY A RIGHT JOIN DW_DIMINDUSTRY B ON A.SINDCODE=B.SCODE ) , T3 AS ( SELECT C.DIM_COMPANY, T2.INNAME, T2.INSCODE, SUM(( CASE WHEN DIM_ITEMPERIOD='1416001' AND DIM_PERIOD=:period THEN FACT_B ELSE 0 END)) AS YYSR, SUM(( CASE WHEN DIM_ITEMPERIOD='1416001' AND DIM_PERIOD=:comparePeriod THEN FACT_B ELSE 0 END)) AS YYSRTQ, SUM(( CASE WHEN DIM_ITEMPERIOD='1426400' AND DIM_PERIOD=:period THEN FACT_B ELSE 0 END)) AS YYCB, SUM(( CASE WHEN DIM_ITEMPERIOD='1426400' AND DIM_PERIOD=:comparePeriod THEN FACT_B ELSE 0 END)) AS YYCBTQ, SUM(( CASE WHEN DIM_ITEMPERIOD='1436601' AND DIM_PERIOD=:period THEN FACT_B ELSE 0 END)) AS XSFY, SUM(( CASE WHEN DIM_ITEMPERIOD='1436601' AND DIM_PERIOD=:comparePeriod THEN FACT_B ELSE 0 END)) AS XSFYTQ, SUM(( CASE WHEN DIM_ITEMPERIOD='1436602' AND DIM_PERIOD=:period THEN FACT_B ELSE 0 END)) AS GLFY, SUM(( CASE WHEN DIM_ITEMPERIOD='1436602' AND DIM_PERIOD=:comparePeriod THEN FACT_B ELSE 0 END)) AS GLFYTQ, SUM(( CASE WHEN DIM_ITEMPERIOD='1436603' AND DIM_PERIOD=:period THEN FACT_B ELSE 0 END)) AS CWFY, SUM(( CASE WHEN DIM_ITEMPERIOD='1436603' AND DIM_PERIOD=:comparePeriod THEN FACT_B ELSE 0 END)) AS CWFYTQ, SUM(( CASE WHEN DIM_ITEMPERIOD='1403100' AND DIM_PERIOD=:period THEN FACT_B ELSE 0 END)) AS LRZE, SUM(( CASE WHEN DIM_ITEMPERIOD='1403100' AND DIM_PERIOD=:comparePeriod THEN FACT_B ELSE 0 END)) AS LRZETQ, ZCZE, ZCZETQ, SYZQY, SYZQYTQ FROM DW_FACTFINANCEPERIOD C LEFT JOIN T1 ON C.DIM_COMPANY=T1.DIM_COMPANY RIGHT JOIN T2 ON C.DIM_COMPANY=T2.COMCODE WHERE DIM_ITEMPERIOD IN ('1416001', '1426400', '1436601', '1436602', '1436603', '1403100') AND DIM_PERIOD IN( :period, :comparePeriod) AND c.DIM_COMPANY IN ( SELECT ROOT_SCODE FROM t5) GROUP BY C.DIM_COMPANY, ZCZE, ZCZETQ, SYZQY, SYZQYTQ, T2.INNAME, T2.INSCODE ) , t6 AS ( SELECT DISTINCT tt55.scode, tt55.sname FROM t5 LEFT JOIN DW_DIMCOMPANY tt5 ON t5.scode=tt5.SCODE LEFT JOIN DW_DIMINDUSTRY tt55 ON tt5.SINDCODE=tt55.scode ) SELECT tt77.sname, NVL(yysr,0) yysr, NVL(yysrtq,0) yysrtq, NVL(yycb,0) yycb, NVL(yycbtq,0) yycbtq, NVL(xsfy,0) xsfy, NVL(xsfytq,0) xsfytq, NVL(glfy,0) glfy, NVL(glfytq,0) glfytq, NVL(cwfy,0) cwfy, NVL(cwfytq,0) cwfytq, NVL(lrze,0) lrze, NVL(lizetq,0) lizetq, NVL(zcze,0) zcze, NVL(zczetq,0) zczetq, NVL(syzqy,0) syzqy, NVL(syzqytq,0) syzqytq FROM t6 LEFT JOIN ( SELECT INSCODE, SUM(YYSR) yysr, SUM(YYSRTQ) yysrtq, SUM(YYCB) yycb, SUM(YYCBTQ) yycbtq, SUM(XSFY) xsfy, SUM(XSFYTQ) xsfytq, SUM(GLFY) glfy, SUM(GLFYTQ) glfytq, SUM(CWFY) cwfy, SUM(CWFYTQ) cwfytq, SUM(LRZE) lrze, SUM(LRZETQ) lizetq, SUM(ZCZE) zcze, SUM(ZCZETQ) zczetq, SUM(SYZQY) syzqy, SUM(SYZQYTQ) syzqytq FROM T3 GROUP BY INSCODE ) t66 ON t66.INSCODE=t6.scode RIGHT JOIN DW_DIMINDUSTRY tt77 ON tt77.scode=t6.scode ORDER BY tt77.scode",
        // "sql": "WITH T1 AS( SELECT DIM_COMPANY, SUM(( CASE WHEN DIM_ITEMPOINT='1100100' AND DIM_PERIOD=:period THEN FACT_B ELSE 0 END)) AS ZCZE, SUM(( CASE WHEN DIM_ITEMPOINT='1100100' AND DIM_PERIOD=:comparePeriod THEN FACT_B ELSE 0 END)) AS ZCZETQ, SUM(( CASE WHEN DIM_ITEMPOINT='1300100' AND DIM_PERIOD=:period THEN FACT_B ELSE 0 END)) AS SYZQY, SUM(( CASE WHEN DIM_ITEMPOINT='1300100' AND DIM_PERIOD=:comparePeriod THEN FACT_B ELSE 0 END)) AS SYZQYTQ FROM DW_FACTFINANCEPOINT WHERE DIM_ITEMPOINT IN ('1100100', '1300100') AND DIM_PERIOD IN( :period, :comparePeriod) GROUP BY DIM_COMPANY) , T4 AS ( SELECT CONNECT_BY_ROOT SCODE AS ROOT_SCODE, SCODE FROM DW_DIMCOMPANY WHERE CISDEL='N' AND STYPE='1' CONNECT BY PRIOR SCODE = SPCODE ) , T5 AS ( SELECT ROOT_SCODE, SCODE FROM T4 WHERE ROOT_SCODE IN ( SELECT SCODE FROM DW_DIMCOMPANY WHERE CISDEL='N' START WITH SCODE=:company CONNECT BY PRIOR SCODE = SPCODE ) ) , T2 AS ( SELECT A.SCODE COMCODE, A.SNAME COMNAME, B.SCODE INSCODE, B.SNAME INNAME FROM DW_DIMCOMPANY A RIGHT JOIN DW_DIMINDUSTRY B ON A.SINDCODE=B.SCODE ) , T3 AS ( SELECT C.DIM_COMPANY, T2.INNAME, T2.INSCODE, SUM(( CASE WHEN DIM_ITEMPERIOD='1416001' AND DIM_PERIOD=:period THEN FACT_B ELSE 0 END)) AS YYSR, SUM(( CASE WHEN DIM_ITEMPERIOD='1416001' AND DIM_PERIOD=:comparePeriod THEN FACT_B ELSE 0 END)) AS YYSRTQ, SUM(( CASE WHEN DIM_ITEMPERIOD='1426400' AND DIM_PERIOD=:period THEN FACT_B ELSE 0 END)) AS YYCB, SUM(( CASE WHEN DIM_ITEMPERIOD='1426400' AND DIM_PERIOD=:comparePeriod THEN FACT_B ELSE 0 END)) AS YYCBTQ, SUM(( CASE WHEN DIM_ITEMPERIOD='1436601' AND DIM_PERIOD=:period THEN FACT_B ELSE 0 END)) AS XSFY, SUM(( CASE WHEN DIM_ITEMPERIOD='1436601' AND DIM_PERIOD=:comparePeriod THEN FACT_B ELSE 0 END)) AS XSFYTQ, SUM(( CASE WHEN DIM_ITEMPERIOD='1436602' AND DIM_PERIOD=:period THEN FACT_B ELSE 0 END)) AS GLFY, SUM(( CASE WHEN DIM_ITEMPERIOD='1436602' AND DIM_PERIOD=:comparePeriod THEN FACT_B ELSE 0 END)) AS GLFYTQ, SUM(( CASE WHEN DIM_ITEMPERIOD='1436603' AND DIM_PERIOD=:period THEN FACT_B ELSE 0 END)) AS CWFY, SUM(( CASE WHEN DIM_ITEMPERIOD='1436603' AND DIM_PERIOD=:comparePeriod THEN FACT_B ELSE 0 END)) AS CWFYTQ, SUM(( CASE WHEN DIM_ITEMPERIOD='1403100' AND DIM_PERIOD=:period THEN FACT_B ELSE 0 END)) AS LRZE, SUM(( CASE WHEN DIM_ITEMPERIOD='1403100' AND DIM_PERIOD=:comparePeriod THEN FACT_B ELSE 0 END)) AS LRZETQ, ZCZE, ZCZETQ, SYZQY, SYZQYTQ FROM DW_FACTFINANCEPERIOD C LEFT JOIN T1 ON C.DIM_COMPANY=T1.DIM_COMPANY RIGHT JOIN T2 ON C.DIM_COMPANY=T2.COMCODE WHERE DIM_ITEMPERIOD IN ('1416001', '1426400', '1436601', '1436602', '1436603', '1403100') AND DIM_PERIOD IN( :period, :comparePeriod) AND c.DIM_COMPANY IN ( SELECT ROOT_SCODE FROM t5) GROUP BY C.DIM_COMPANY, ZCZE, ZCZETQ, SYZQY, SYZQYTQ, T2.INNAME, T2.INSCODE ) , t6 AS ( SELECT DISTINCT tt55.scode, tt55.sname FROM t5 LEFT JOIN DW_DIMCOMPANY tt5 ON t5.scode=tt5.SCODE LEFT JOIN DW_DIMINDUSTRY tt55 ON tt5.SINDCODE=tt55.scode ) SELECT tt77.sname, NVL(yysr,0) yysr, NVL(yysrtq,0) yysrtq, NVL(yycb,0) yycb, NVL(yycbtq,0) yycbtq, NVL(xsfy,0) xsfy, NVL(xsfytq,0) xsfytq, NVL(glfy,0) glfy, NVL(glfytq,0) glfytq, NVL(cwfy,0) cwfy, NVL(cwfytq,0) cwfytq, NVL(lrze,0) lrze, NVL(lizetq,0) lizetq, NVL(zcze,0) zcze, NVL(zczetq,0) zczetq, NVL(syzqy,0) syzqy, NVL(syzqytq,0) syzqytq FROM t6 LEFT JOIN ( SELECT INSCODE, SUM(YYSR) yysr, SUM(YYSRTQ) yysrtq, SUM(YYCB) yycb, SUM(YYCBTQ) yycbtq, SUM(XSFY) xsfy, SUM(XSFYTQ) xsfytq, SUM(GLFY) glfy, SUM(GLFYTQ) glfytq, SUM(CWFY) cwfy, SUM(CWFYTQ) cwfytq, SUM(LRZE) lrze, SUM(LRZETQ) lizetq, SUM(ZCZE) zcze, SUM(ZCZETQ) zczetq, SUM(SYZQY) syzqy, SUM(SYZQYTQ) syzqytq FROM T3 GROUP BY INSCODE ) t66 ON t66.INSCODE=t6.scode RIGHT JOIN (select scode, sname from DW_DIMINDUSTRY where spcode='0' and SRANGEID is null) tt77 ON tt77.scode=t6.scode ORDER BY to_number(tt77.scode)",
        // "sql": "WITH T1 AS( SELECT DIM_COMPANY, SUM(( CASE WHEN DIM_ITEMPOINT='1100100' AND DIM_PERIOD=:period THEN FACT_B ELSE 0 END)) AS ZCZE, SUM(( CASE WHEN DIM_ITEMPOINT='1100100' AND DIM_PERIOD=:comparePeriod THEN FACT_B ELSE 0 END)) AS ZCZETQ, SUM(( CASE WHEN DIM_ITEMPOINT='1300100' AND DIM_PERIOD=:period THEN FACT_B ELSE 0 END)) AS SYZQY, SUM(( CASE WHEN DIM_ITEMPOINT='1300100' AND DIM_PERIOD=:comparePeriod THEN FACT_B ELSE 0 END)) AS SYZQYTQ FROM DW_FACTFINANCEPOINT WHERE DIM_ITEMPOINT IN ('1100100', '1300100') AND DIM_PERIOD IN( :period, :comparePeriod) GROUP BY DIM_COMPANY) , T4 AS ( SELECT CONNECT_BY_ROOT SCODE AS ROOT_SCODE, SCODE FROM DW_DIMCOMPANY WHERE CISDEL='N' AND STYPE='1' CONNECT BY PRIOR SCODE = SPCODE ) , T5 AS ( SELECT ROOT_SCODE, SCODE FROM T4 WHERE ROOT_SCODE IN ( SELECT SCODE FROM DW_DIMCOMPANY WHERE CISDEL='N' START WITH SCODE=:company CONNECT BY PRIOR SCODE = SPCODE ) ) , T2 AS ( SELECT A.SCODE COMCODE, A.SNAME COMNAME, B.SCODE INSCODE, B.SNAME INNAME FROM DW_DIMCOMPANY A RIGHT JOIN DW_DIMINDUSTRY B ON A.SINDCODE=B.SCODE ) , T3 AS ( SELECT C.DIM_COMPANY, T2.INNAME, T2.INSCODE, SUM(( CASE WHEN DIM_ITEMPERIOD='1416001' AND DIM_PERIOD=:period THEN FACT_B ELSE 0 END)) AS YYSR, SUM(( CASE WHEN DIM_ITEMPERIOD='1416001' AND DIM_PERIOD=:comparePeriod THEN FACT_B ELSE 0 END)) AS YYSRTQ, SUM(( CASE WHEN DIM_ITEMPERIOD='1426400' AND DIM_PERIOD=:period THEN FACT_B ELSE 0 END)) AS YYCB, SUM(( CASE WHEN DIM_ITEMPERIOD='1426400' AND DIM_PERIOD=:comparePeriod THEN FACT_B ELSE 0 END)) AS YYCBTQ, SUM(( CASE WHEN DIM_ITEMPERIOD='1436601' AND DIM_PERIOD=:period THEN FACT_B ELSE 0 END)) AS XSFY, SUM(( CASE WHEN DIM_ITEMPERIOD='1436601' AND DIM_PERIOD=:comparePeriod THEN FACT_B ELSE 0 END)) AS XSFYTQ, SUM(( CASE WHEN DIM_ITEMPERIOD='1436602' AND DIM_PERIOD=:period THEN FACT_B ELSE 0 END)) AS GLFY, SUM(( CASE WHEN DIM_ITEMPERIOD='1436602' AND DIM_PERIOD=:comparePeriod THEN FACT_B ELSE 0 END)) AS GLFYTQ, SUM(( CASE WHEN DIM_ITEMPERIOD='1436603' AND DIM_PERIOD=:period THEN FACT_B ELSE 0 END)) AS CWFY, SUM(( CASE WHEN DIM_ITEMPERIOD='1436603' AND DIM_PERIOD=:comparePeriod THEN FACT_B ELSE 0 END)) AS CWFYTQ, SUM(( CASE WHEN DIM_ITEMPERIOD='1403100' AND DIM_PERIOD=:period THEN FACT_B ELSE 0 END)) AS LRZE, SUM(( CASE WHEN DIM_ITEMPERIOD='1403100' AND DIM_PERIOD=:comparePeriod THEN FACT_B ELSE 0 END)) AS LRZETQ, ZCZE, ZCZETQ, SYZQY, SYZQYTQ FROM DW_FACTFINANCEPERIOD C LEFT JOIN T1 ON C.DIM_COMPANY=T1.DIM_COMPANY RIGHT JOIN T2 ON C.DIM_COMPANY=T2.COMCODE WHERE DIM_ITEMPERIOD IN ('1416001', '1426400', '1436601', '1436602', '1436603', '1403100') AND DIM_PERIOD IN( :period, :comparePeriod) AND c.DIM_COMPANY IN ( SELECT ROOT_SCODE FROM t5) GROUP BY C.DIM_COMPANY, ZCZE, ZCZETQ, SYZQY, SYZQYTQ, T2.INNAME, T2.INSCODE ) , t6 AS ( SELECT DISTINCT tt55.scode, tt55.sname FROM t5 LEFT JOIN DW_DIMCOMPANY tt5 ON t5.scode=tt5.SCODE LEFT JOIN DW_DIMINDUSTRY tt55 ON tt5.SINDCODE=tt55.scode ), t7 as ( SELECT tt77.sname, NVL(yysr,0) yysr, NVL(yysrtq,0) yysrtq, NVL(yycb,0) yycb, NVL(yycbtq,0) yycbtq, NVL(xsfy,0) xsfy, NVL(xsfytq,0) xsfytq, NVL(glfy,0) glfy, NVL(glfytq,0) glfytq, NVL(cwfy,0) cwfy, NVL(cwfytq,0) cwfytq, NVL(lrze,0) lrze, NVL(lrzetq,0) lrzetq, NVL(zcze,0) zcze, NVL(zczetq,0) zczetq, NVL(syzqy,0) syzqy, NVL(syzqytq,0) syzqytq FROM t6 LEFT JOIN ( SELECT INSCODE, SUM(YYSR) yysr, SUM(YYSRTQ) yysrtq, SUM(YYCB) yycb, SUM(YYCBTQ) yycbtq, SUM(XSFY) xsfy, SUM(XSFYTQ) xsfytq, SUM(GLFY) glfy, SUM(GLFYTQ) glfytq, SUM(CWFY) cwfy, SUM(CWFYTQ) cwfytq, SUM(LRZE) lrze, SUM(LRZETQ) lrzetq, SUM(ZCZE) zcze, SUM(ZCZETQ) zczetq, SUM(SYZQY) syzqy, SUM(SYZQYTQ) syzqytq FROM T3 GROUP BY INSCODE ) t66 ON t66.INSCODE=t6.scode RIGHT JOIN ( SELECT scode, sname FROM DW_DIMINDUSTRY WHERE spcode='0' AND SRANGEID IS NULL) tt77 ON tt77.scode=t6.scode ORDER BY to_number(tt77.scode) ) select SNAME, YYSR, yysrtq, yycb,yycbtq, xsfy, xsfytq, glfy, glfytq, cwfy, cwfytq, lrze, lrzetq, zcze, zczetq, syzqy, syzqytq from t7 union all select '合 计' as SNAME, SUM(YYSR) yysr, SUM(YYSRTQ) yysrtq, SUM(YYCB) yycb,SUM(YYCBTQ) yycbtq, SUM(XSFY) xsfy, SUM(XSFYTQ) xsfytq, SUM(GLFY) glfy, SUM(GLFYTQ) glfytq, SUM(CWFY) cwfy, SUM(CWFYTQ) cwfytq, SUM(LRZE) lrze,SUM(LRZETQ) lizetq,SUM(ZCZE) zcze, SUM(ZCZETQ) zczetq, SUM(SYZQY) syzqy, SUM(SYZQYTQ) syzqytq from t7",
        // "sql": "WITH T1 AS( SELECT DIM_COMPANY, SUM(( CASE WHEN DIM_ITEMPOINT='1100100' AND DIM_PERIOD=:period THEN FACT_B ELSE 0 END)) AS ZCZE, SUM(( CASE WHEN DIM_ITEMPOINT='1100100' AND DIM_PERIOD=:comparePeriod THEN FACT_B ELSE 0 END)) AS ZCZETQ, SUM(( CASE WHEN DIM_ITEMPOINT='1300100' AND DIM_PERIOD=:period THEN FACT_B ELSE 0 END)) AS SYZQY, SUM(( CASE WHEN DIM_ITEMPOINT='1300100' AND DIM_PERIOD=:comparePeriod THEN FACT_B ELSE 0 END)) AS SYZQYTQ, SUM(( CASE WHEN DIM_ITEMPOINT='1200100' AND DIM_PERIOD=:period THEN FACT_B ELSE 0 END)) AS fzze FROM DW_FACTFINANCEPOINT WHERE DIM_ITEMPOINT IN ('1100100', '1300100', '1200100') AND DIM_PERIOD IN( :period, :comparePeriod) GROUP BY DIM_COMPANY) , T4 AS ( SELECT CONNECT_BY_ROOT SCODE AS ROOT_SCODE, SCODE FROM DW_DIMCOMPANY WHERE CISDEL='N' AND STYPE='1' CONNECT BY PRIOR SCODE = SPCODE ) , T5 AS ( SELECT ROOT_SCODE, SCODE FROM T4 WHERE ROOT_SCODE IN ( SELECT SCODE FROM DW_DIMCOMPANY WHERE CISDEL='N' START WITH SCODE=:company CONNECT BY PRIOR SCODE = SPCODE ) ) , T2 AS ( SELECT A.SCODE COMCODE, A.SNAME COMNAME, B.SCODE INSCODE, B.SNAME INNAME FROM DW_DIMCOMPANY A RIGHT JOIN DW_DIMINDUSTRY B ON A.SINDCODE=B.SCODE ) , T3 AS ( SELECT C.DIM_COMPANY, T2.INNAME, T2.INSCODE, SUM(( CASE WHEN DIM_ITEMPERIOD='1416001' AND DIM_PERIOD=:period THEN FACT_B ELSE 0 END)) AS YYSR, SUM(( CASE WHEN DIM_ITEMPERIOD='1416001' AND DIM_PERIOD=:comparePeriod THEN FACT_B ELSE 0 END)) AS YYSRTQ, SUM(( CASE WHEN DIM_ITEMPERIOD='1426400' AND DIM_PERIOD=:period THEN FACT_B ELSE 0 END)) AS YYCB, SUM(( CASE WHEN DIM_ITEMPERIOD='1426400' AND DIM_PERIOD=:comparePeriod THEN FACT_B ELSE 0 END)) AS YYCBTQ, SUM(( CASE WHEN DIM_ITEMPERIOD='1436601' AND DIM_PERIOD=:period THEN FACT_B ELSE 0 END)) AS XSFY, SUM(( CASE WHEN DIM_ITEMPERIOD='1436601' AND DIM_PERIOD=:comparePeriod THEN FACT_B ELSE 0 END)) AS XSFYTQ, SUM(( CASE WHEN DIM_ITEMPERIOD='1436602' AND DIM_PERIOD=:period THEN FACT_B ELSE 0 END)) AS GLFY, SUM(( CASE WHEN DIM_ITEMPERIOD='1436602' AND DIM_PERIOD=:comparePeriod THEN FACT_B ELSE 0 END)) AS GLFYTQ, SUM(( CASE WHEN DIM_ITEMPERIOD='1436603' AND DIM_PERIOD=:period THEN FACT_B ELSE 0 END)) AS CWFY, SUM(( CASE WHEN DIM_ITEMPERIOD='1436603' AND DIM_PERIOD=:comparePeriod THEN FACT_B ELSE 0 END)) AS CWFYTQ, SUM(( CASE WHEN DIM_ITEMPERIOD='1403100' AND DIM_PERIOD=:period THEN FACT_B ELSE 0 END)) AS LRZE, SUM(( CASE WHEN DIM_ITEMPERIOD='1403100' AND DIM_PERIOD=:comparePeriod THEN FACT_B ELSE 0 END)) AS LRZETQ, ZCZE, ZCZETQ, SYZQY, SYZQYTQ, fzze FROM DW_FACTFINANCEPERIOD C LEFT JOIN T1 ON C.DIM_COMPANY=T1.DIM_COMPANY RIGHT JOIN T2 ON C.DIM_COMPANY=T2.COMCODE WHERE DIM_ITEMPERIOD IN ('1416001', '1426400', '1436601', '1436602', '1436603', '1403100') AND DIM_PERIOD IN( :period, :comparePeriod) AND c.DIM_COMPANY IN ( SELECT ROOT_SCODE FROM t5) GROUP BY C.DIM_COMPANY, ZCZE, ZCZETQ, SYZQY, SYZQYTQ, fzze, T2.INNAME, T2.INSCODE ) , t6 AS ( SELECT DISTINCT tt55.scode, tt55.sname FROM t5 LEFT JOIN DW_DIMCOMPANY tt5 ON t5.scode=tt5.SCODE LEFT JOIN DW_DIMINDUSTRY tt55 ON tt5.SINDCODE=tt55.scode ) , t7 AS ( SELECT tt77.sname, NVL(yysr,0) yysr, NVL(yysrtq,0) yysrtq, NVL(yycb,0) yycb, NVL(yycbtq,0) yycbtq, NVL(xsfy,0) xsfy, NVL(xsfytq,0) xsfytq, NVL(glfy,0) glfy, NVL(glfytq,0) glfytq, NVL(cwfy,0) cwfy, NVL(cwfytq,0) cwfytq, NVL(lrze,0) lrze, NVL(lrzetq,0) lrzetq, NVL(zcze,0) zcze, NVL(zczetq,0) zczetq, NVL(syzqy,0) syzqy, NVL(syzqytq,0) syzqytq, nvl(fzze, 0) fzze FROM t6 LEFT JOIN ( SELECT INSCODE, SUM(YYSR) yysr, SUM(YYSRTQ) yysrtq, SUM(YYCB) yycb, SUM(YYCBTQ) yycbtq, SUM(XSFY) xsfy, SUM(XSFYTQ) xsfytq, SUM(GLFY) glfy, SUM(GLFYTQ) glfytq, SUM(CWFY) cwfy, SUM(CWFYTQ) cwfytq, SUM(LRZE) lrze, SUM(LRZETQ) lrzetq, SUM(ZCZE) zcze, SUM(ZCZETQ) zczetq, SUM(SYZQY) syzqy, SUM(SYZQYTQ) syzqytq, sum(fzze) fzze FROM T3 GROUP BY INSCODE ) t66 ON t66.INSCODE=t6.scode RIGHT JOIN ( SELECT scode, sname FROM DW_DIMINDUSTRY WHERE spcode='0' AND SRANGEID IS NULL) tt77 ON tt77.scode=t6.scode ORDER BY to_number(tt77.scode) ) SELECT SNAME, YYSR, yysrtq, yycb, yycbtq, xsfy, xsfytq, glfy, glfytq, cwfy, cwfytq, lrze, lrzetq, zcze, zczetq, syzqy, syzqytq, fzze, (case when zcze=0 then 0 else round(fzze/zcze,4) end ) zcfzl FROM t7 UNION ALL SELECT '合 计' AS SNAME, SUM(YYSR) yysr, SUM(YYSRTQ) yysrtq, SUM(YYCB) yycb, SUM(YYCBTQ) yycbtq, SUM(XSFY) xsfy, SUM(XSFYTQ) xsfytq, SUM(GLFY) glfy, SUM(GLFYTQ) glfytq, SUM(CWFY) cwfy, SUM(CWFYTQ) cwfytq, SUM(LRZE) lrze, SUM(LRZETQ) lizetq, SUM(ZCZE) zcze, SUM(ZCZETQ) zczetq, SUM(SYZQY) syzqy, SUM(SYZQYTQ) syzqytq, sum(fzze) fzze, (case when SUM(ZCZE)=0 then 0 else round(sum(fzze)/SUM(ZCZE),4) end) as zcfzl FROM t7",
        "sql": "WITH T1 AS( SELECT DIM_COMPANY, SUM(( CASE WHEN DIM_ITEMPOINT='1100100' AND DIM_PERIOD=:period THEN FACT_B ELSE 0 END)) AS ZCZE, SUM(( CASE WHEN DIM_ITEMPOINT='1100100' AND DIM_PERIOD=:comparePeriod THEN FACT_B ELSE 0 END)) AS ZCZETQ, SUM(( CASE WHEN DIM_ITEMPOINT='1300100' AND DIM_PERIOD=:period THEN FACT_B ELSE 0 END)) AS SYZQY, SUM(( CASE WHEN DIM_ITEMPOINT='1300100' AND DIM_PERIOD=:comparePeriod THEN FACT_B ELSE 0 END)) AS SYZQYTQ, SUM(( CASE WHEN DIM_ITEMPOINT='1200100' AND DIM_PERIOD=:period THEN FACT_B ELSE 0 END)) AS fzze FROM DW_FACTFINANCEPOINT WHERE DIM_ITEMPOINT IN ('1100100', '1300100', '1200100') AND DIM_PERIOD IN( :period, :comparePeriod) GROUP BY DIM_COMPANY) , T4 AS ( SELECT CONNECT_BY_ROOT SCODE AS ROOT_SCODE, SCODE FROM DW_DIMCOMPANY WHERE CISDEL='N' AND STYPE in ('1', 'R') CONNECT BY PRIOR SCODE = SPCODE ) , T5 AS ( SELECT ROOT_SCODE, SCODE FROM T4 WHERE ROOT_SCODE IN ( SELECT SCODE FROM DW_DIMCOMPANY WHERE CISDEL='N' START WITH SCODE=:company CONNECT BY PRIOR SCODE = SPCODE ) ) , T2 AS ( SELECT A.SCODE COMCODE, A.SNAME COMNAME, B.SCODE INSCODE, B.SNAME INNAME FROM DW_DIMCOMPANY A RIGHT JOIN DW_DIMINDUSTRY B ON A.SINDCODE=B.SCODE ) , T3 AS ( SELECT T2.COMCODE as DIM_COMPANY, T2.INNAME, T2.INSCODE, SUM(( CASE WHEN DIM_ITEMPERIOD='1416001' AND DIM_PERIOD=:period THEN FACT_B ELSE 0 END)) AS YYSR, SUM(( CASE WHEN DIM_ITEMPERIOD='1416001' AND DIM_PERIOD=:comparePeriod THEN FACT_B ELSE 0 END)) AS YYSRTQ, SUM(( CASE WHEN DIM_ITEMPERIOD='1426400' AND DIM_PERIOD=:period THEN FACT_B ELSE 0 END)) AS YYCB, SUM(( CASE WHEN DIM_ITEMPERIOD='1426400' AND DIM_PERIOD=:comparePeriod THEN FACT_B ELSE 0 END)) AS YYCBTQ, SUM(( CASE WHEN DIM_ITEMPERIOD='1436601' AND DIM_PERIOD=:period THEN FACT_B ELSE 0 END)) AS XSFY, SUM(( CASE WHEN DIM_ITEMPERIOD='1436601' AND DIM_PERIOD=:comparePeriod THEN FACT_B ELSE 0 END)) AS XSFYTQ, SUM(( CASE WHEN DIM_ITEMPERIOD='1436602' AND DIM_PERIOD=:period THEN FACT_B ELSE 0 END)) AS GLFY, SUM(( CASE WHEN DIM_ITEMPERIOD='1436602' AND DIM_PERIOD=:comparePeriod THEN FACT_B ELSE 0 END)) AS GLFYTQ, SUM(( CASE WHEN DIM_ITEMPERIOD='1436603' AND DIM_PERIOD=:period THEN FACT_B ELSE 0 END)) AS CWFY, SUM(( CASE WHEN DIM_ITEMPERIOD='1436603' AND DIM_PERIOD=:comparePeriod THEN FACT_B ELSE 0 END)) AS CWFYTQ, SUM(( CASE WHEN DIM_ITEMPERIOD='1403100' AND DIM_PERIOD=:period THEN FACT_B ELSE 0 END)) AS LRZE, SUM(( CASE WHEN DIM_ITEMPERIOD='1403100' AND DIM_PERIOD=:comparePeriod THEN FACT_B ELSE 0 END)) AS LRZETQ, ZCZE, ZCZETQ, SYZQY, SYZQYTQ, fzze FROM ( SELECT distinct ROOT_SCODE FROM t5) aa LEFT JOIN T1 ON aa.ROOT_SCODE=T1.DIM_COMPANY left join ( select * from DW_FACTFINANCEPERIOD WHERE DIM_ITEMPERIOD IN ('1416001', '1426400', '1436601', '1436602', '1436603', '1403100') AND DIM_PERIOD IN( :period, :comparePeriod) ) C on aa.ROOT_SCODE= c.DIM_COMPANY right JOIN T2 ON aa.ROOT_SCODE=T2.COMCODE GROUP BY T2.COMCODE, ZCZE, ZCZETQ, SYZQY, SYZQYTQ, fzze, T2.INNAME, T2.INSCODE ) , t6 AS ( SELECT DISTINCT tt55.scode, tt55.sname FROM t5 LEFT JOIN DW_DIMCOMPANY tt5 ON t5.scode=tt5.SCODE LEFT JOIN DW_DIMINDUSTRY tt55 ON tt5.SINDCODE=tt55.scode ) , t7 AS ( SELECT tt77.sname, NVL(yysr,0) yysr, NVL(yysrtq,0) yysrtq, NVL(yycb,0) yycb, NVL(yycbtq,0) yycbtq, NVL(xsfy,0) xsfy, NVL(xsfytq,0) xsfytq, NVL(glfy,0) glfy, NVL(glfytq,0) glfytq, NVL(cwfy,0) cwfy, NVL(cwfytq,0) cwfytq, NVL(lrze,0) lrze, NVL(lrzetq,0) lrzetq, NVL(zcze,0) zcze, NVL(zczetq,0) zczetq, NVL(syzqy,0) syzqy, NVL(syzqytq,0) syzqytq, NVL(fzze, 0) fzze FROM t6 LEFT JOIN ( SELECT INSCODE, SUM(YYSR) yysr, SUM(YYSRTQ) yysrtq, SUM(YYCB) yycb, SUM(YYCBTQ) yycbtq, SUM(XSFY) xsfy, SUM(XSFYTQ) xsfytq, SUM(GLFY) glfy, SUM(GLFYTQ) glfytq, SUM(CWFY) cwfy, SUM(CWFYTQ) cwfytq, SUM(LRZE) lrze, SUM(LRZETQ) lrzetq, SUM(ZCZE) zcze, SUM(ZCZETQ) zczetq, SUM(SYZQY) syzqy, SUM(SYZQYTQ) syzqytq, SUM(fzze) fzze FROM T3 GROUP BY INSCODE ) t66 ON t66.INSCODE=t6.scode RIGHT JOIN ( SELECT scode, sname FROM DW_DIMINDUSTRY WHERE spcode='0' AND SRANGEID IS NULL) tt77 ON tt77.scode=t6.scode ORDER BY to_number(tt77.scode) ) SELECT SNAME, YYSR, yysrtq, yycb, yycbtq, xsfy, xsfytq, glfy, glfytq, cwfy, cwfytq, lrze, lrzetq, zcze, zczetq, syzqy, syzqytq, fzze, ( CASE WHEN zcze=0 THEN 0 ELSE ROUND(fzze*100/zcze,4) END ) zcfzl FROM t7 UNION ALL SELECT '合 计' AS SNAME, SUM(YYSR) yysr, SUM(YYSRTQ) yysrtq, SUM(YYCB) yycb, SUM(YYCBTQ) yycbtq, SUM(XSFY) xsfy, SUM(XSFYTQ) xsfytq, SUM(GLFY) glfy, SUM(GLFYTQ) glfytq, SUM(CWFY) cwfy, SUM(CWFYTQ) cwfytq, SUM(LRZE) lrze, SUM(LRZETQ) lizetq, SUM(ZCZE) zcze, SUM(ZCZETQ) zczetq, SUM(SYZQY) syzqy, SUM(SYZQYTQ) syzqytq, SUM(fzze) fzze, ( CASE WHEN SUM(ZCZE)=0 THEN 0 ELSE ROUND(SUM(fzze)/SUM(ZCZE),4) END) AS zcfzl FROM t7" ,
        "_cube": {
            "cubeId": 4 ,
            "subject": "0002"
        },
        "mainDim":"itempoint",
        "needDims":["year","month","company","conversion"],
        "random":{"min":100,"max":100000},
        "tableHeads":true,
        "type":1,
        "generateVar":{//生成变量rows
            "periodCount":2,
            "compareType":"-1&0",
            "reverse":true
        }   
    },
    "columns": [
        {
            "id" : "",
            "type" : "string",
            "text" : "所有者权益累计数",
            "children" : [
                {
                    "id" : "syzqy",
                    "type" : "decimal",
                    "text" : "本期",
                    "width": "170px"
                },
                {
                    "id" : "syzqytq",
                    "type" : "decimal",
                    "text" : "同期",
                    "width": "170px"
                }
            ]
        },
        {
            "id": "sname",
            "type": "string",
            "width": "230px",
            "fixed":true,
            "text": "行业名称"
        },
        {
            "id": "fzze",
            "type": "decimal",
            "width": "180px",
            "text": "负债总额"
        },
        {
            "id": "zcfzl",
            "type": "decimal",
            "width": "160px",
            "text": "资产负债率"
        },
        {
            "id": "",
            "type" : "string",
            "text" : "营业收入累计数",
            "children": [
                {
                    "id" : "yysr",
                    "type" : "decimal",
                    "text" : "本期",
                    "width": "170px"
                },
                {
                    "id" : "yysrtq",
                    "type" : "decimal",
                    "text" : "同期",
                    "width": "170px"
                }
            ]
        },
        {
            "id" : "",
            "type" : "string",
            "text" : "营业成本累计数",
            "children": [
                {
                    "id" : "yycb",
                    "type" : "decimal",
                    "text" : "本期",
                    "width": "170px"
                },
                {
                    "id" : "yycbtq",
                    "type" : "decimal",
                    "text" : "同期",
                    "width": "170px"
                }
            ]
        },
        {
            "id" : "",
            "type" : "string",
            "text" : "销售费用累计数",
            "children" : [
                {
                    "id" : "xsfy",
                    "type" : "decimal",
                    "text" : "本期",
                    "width": "170px"
                },
                {
                    "id" : "xsfytq",
                    "type" : "decimal",
                    "text" : "同期",
                    "width": "170px"
                }
            ]
        },
        {
            "id" : "",
            "type" : "string",
            "text" : "管理费用累计数",
            "children" : [
                {
                    "id" : "glfy",
                    "type" : "decimal",
                    "text" : "本期",
                    "width": "170px"
                },
                {
                    "id" : "glfytq",
                    "type" : "decimal",
                    "text" : "同期",
                    "width": "170px"
                }
            ]
        },
        {
            "id" : "",
            "type" : "string",
            "text" : "财务费用累计数",
            "children" : [
                {
                    "id" : "cwfy",
                    "type" : "decimal",
                    "text" : "本期",
                    "width": "170px"
                },
                {
                    "id" : "cwfytq",
                    "type" : "decimal",
                    "text" : "同期",
                    "width": "170px"
                }
            ]
        },
        {
            "id" : "",
            "type" : "string",
            "text" : "利润总额累计数",
            "children": [
                {
                    "id" : "lrze",
                    "type" : "decimal",
                    "text" : "本期",
                    "width": "170px"
                },
                {
                    "id" : "lrzetq",
                    "type" : "decimal",
                    "text" : "同期",
                    "width": "170px"
                }
            ]
        },
        {
            "id" : "",
            "type" : "string",
            "text" : "资产总额累计数",
            "children": [
                {
                    "id" : "zcze",
                    "type" : "decimal",
                    "text" : "本期",
                    "width": "170px"
                },
                {
                    "id" : "zczetq",
                    "type" : "decimal",
                    "text" : "同期",
                    "width": "170px"
                }
            ]
        }
    ],
    "rows": [
        
    ],
    "items":[
        {
            "xtype" : "bi-table",
            "id" : "fhyzb",
            "text" : "分行业指标",
            "show": true,
            "toolbar":[{    
                "id":"1",
                "text":"刷新",
                "xtype":"button",
                "cellStyle":{
                    // "color":"black",
                    // "background-color":"#189271"
                    // "background-color":"#fff"
                },
                "handler":function(vue,btn){
                    debugger
                    console.log(vue);
                    let $vue = vue.item.$vue;
                    $vue.closeTabTaget({}, $vue);
                    vue.item.updateView("company");
                }
            },{
                "id":"2",
                "text":"导出",
                "xtype":"button",
                "cellStyle":{
                    // "color":"black",
                    // "background-color":"#189271"
                    // "background-color":"#fff"
                },
                "handler":function(vue,btn){
                    debugger
                    console.log(vue);
                    vue.handleDownload(vue);
                }
            }]
            // "showFun":function($store){
            //     debugger
            //     if($store.getters.treeInfo.leaf){
            //         return false ;
            //     }else{
            //         return true ;
            //     }                       
            // }
        }
    ]
}