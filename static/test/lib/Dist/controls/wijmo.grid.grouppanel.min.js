/*!
    *
    * Wijmo Library 5.20191.603
    * http://wijmo.com/
    *
    * Copyright(c) GrapeCity, Inc.  All rights reserved.
    *
    * Licensed under the GrapeCity Commercial License.
    * sales@wijmo.com
    * wijmo.com/products/wijmo-5/license/
    *
    */

var wijmo,__extends=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();!function(e){!function(t){!function(t){"use strict";var i=function(t){function i(e,i){var r=t.call(this,e)||this;r._hideGroupedCols=!0,r._showDragGlyphs=!0,r._maxGroups=6,r._hiddenCols=[];var n=r.getTemplate();r.applyTemplate("wj-grouppanel wj-control",n,{_divMarkers:"div-markers",_divPH:"div-ph"});var o=r.hostElement;return r.addEventListener(o,"dragstart",r._dragStart.bind(r)),r.addEventListener(o,"dragover",r._dragOver.bind(r)),r.addEventListener(o,"drop",r._drop.bind(r)),r.addEventListener(o,"dragend",r._dragEnd.bind(r)),r.addEventListener(o,"click",r._click.bind(r)),r.initialize(i),r}return __extends(i,t),Object.defineProperty(i.prototype,"hideGroupedColumns",{get:function(){return this._hideGroupedCols},set:function(t){t!=this._hideGroupedCols&&(this._hideGroupedCols=e.asBoolean(t))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"showDragGlyphs",{get:function(){return this._showDragGlyphs},set:function(t){t!=this._showDragGlyphs&&(this._showDragGlyphs=e.asBoolean(t),this.refresh())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"maxGroups",{get:function(){return this._maxGroups},set:function(t){if(t!=this._maxGroups){this._maxGroups=e.asNumber(t);var i=this._gds,r=this._maxGroups;i&&r>-1&&r<i.length&&i.splice(r,i.length-r)}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"placeholder",{get:function(){return this._divPH.textContent},set:function(e){this._divPH.textContent=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"grid",{get:function(){return this._g},set:function(t){if((t=e.asType(t,e.grid.FlexGrid,!0))!=this._g){var i=this._g;i&&(i.draggingColumn.removeHandler(this._draggingColumn),i.itemsSourceChanging.removeHandler(this._itemsSourceChanging),i.itemsSourceChanged.removeHandler(this._itemsSourceChanged),i.columns.collectionChanged.removeHandler(this._itemsSourceChanged)),i=this._g=t,this._hiddenCols=[],i&&(i.draggingColumn.addHandler(this._draggingColumn,this),i.itemsSourceChanging.addHandler(this._itemsSourceChanging,this),i.itemsSourceChanged.addHandler(this._itemsSourceChanged,this),i.columns.collectionChanged.addHandler(this._itemsSourceChanged,this)),this._itemsSourceChanged(i,null)}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"filter",{get:function(){return this._filter},set:function(t){if((t=e.asType(t,e.grid.filter.FlexGridFilter,!0))!=this._filter){var i=this._filter;i&&i.filterApplied.removeHandler(this.refresh,this),(i=this._filter=t)&&i.filterApplied.addHandler(this.refresh,this),this.refresh()}},enumerable:!0,configurable:!0}),i.prototype.refresh=function(){if(t.prototype.refresh.call(this),this._divMarkers.innerHTML="",this._dragMarker=this._dragCol=null,this._gds){for(var i=this._g,r=i.columnHeaders,n=0;n<this._gds.length;n++){for(var o=this._gds[n],s=-1,l=-1,a=r.rows.length-1;a>=0&&l<0;a--)for(var d=0;d<r.columns.length&&l<0;d++){var h=i._getBindingColumn(r,a,r.columns[d]);if(h&&h.binding==o.propertyName){l=d,s=a;break}}if(l>-1&&s>-1){var g=document.createElement("div");if(i.cellFactory.updateCell(this._g.columnHeaders,s,l,g),g.setAttribute("class","wj-cell wj-header wj-groupmarker"),e.setCss(g,{position:"static",display:"inline-block",verticalAlign:"top",left:"",top:"",right:"",height:"auto",width:"auto"}),this.showDragGlyphs){var p=e.createElement('<span class="wj-glyph-drag"></span>');g.insertBefore(p,g.firstChild)}var u=g.querySelector(".wj-elem-filter");u&&e.removeChild(u);var c=this._getColumnFilter(r.columns[l]);c&&(u=e.createElement('<span class="wj-filter wj-glyph-filter"></span>',g),e.toggleClass(u,"wj-filter-on",c.isActive),e.toggleClass(u,"wj-filter-off",!c.isActive)),e.createElement('<span class="wj-remove">&times;</span>',g),this._divMarkers.appendChild(g)}}var _=this._divMarkers.children.length>0;this._divPH.style.display=_?"none":"",this._divMarkers.style.display=_?"":"none"}},i.prototype._getColumnFilter=function(e){var t=this._filter,i=null;return t&&(i=t.filterColumns&&t.filterColumns.indexOf(e.binding)<0?null:t.getColumnFilter(e)),i},i.prototype._editFilter=function(e){var t=this._gds,i=this._getElementIndex(e),r=t&&i>-1?t[i]:null,n=r?r.propertyName:null,o=n?this._g.columns.getColumn(n):null;o&&this._filter.editColumnFilter(o,null,e)},i.prototype._addGroup=function(t,i){for(var r=this._getIndex(i),n=this._gds,o=this._maxGroups,s=0;s<n.length;s++)if(n[s].propertyName==t.binding){n.removeAt(s),s<r&&r--;break}if(o>-1)for(s=o-1;s<n.length;s++)this._removeGroup(s,n),s<r&&r--;(o<0||n.length<o)&&(n.deferUpdate(function(){var i=new e.collections.PropertyGroupDescription(t.binding);n.insert(r,i)}),t&&this.hideGroupedColumns&&(t.visible=!1,this._hiddenCols.push(t)))},i.prototype._moveGroup=function(e,t){var i=this._gds,r=this._getElementIndex(this._dragMarker),n=this._getIndex(t);n>r&&n--,n>=this._gds.length&&(n=this._gds.length),r!=n&&i.deferUpdate(function(){var e=i[r];i.removeAt(r),i.insert(n,e)})},i.prototype._removeGroup=function(e,t){void 0===t&&(t=this._gds);var i=null;t&&e>-1&&(i=t[e],t.removeAt(e));var r=i?i.propertyName:null,n=r?this._g.columns.getColumn(r):null;if(n){n.visible=!0;var o=this._hiddenCols.indexOf(n);o>-1&&this._hiddenCols.splice(o,1)}},i.prototype._getIndex=function(e){for(var t=e.clientX,i=this._divMarkers.children,r=0;r<i.length;r++){var n=i[r].getBoundingClientRect();if((t-n.left)*(t-n.right)<0)return r}return i.length},i.prototype._getElementIndex=function(e){if(e&&e.parentElement)for(var t=e.parentElement.children,i=0;i<t.length;i++)if(t[i]==e)return i;return-1},i.prototype._draggingColumn=function(e,t){var i=this._g,r=i._getBindingColumn(t.panel,t.row,i.columns[t.col]);this._dragCol=r.binding?r:null},i.prototype._itemsSourceChanging=function(e,t){this._hiddenCols.forEach(function(e){e.visible=!0}),this._hiddenCols=[]},i.prototype._itemsSourceChanged=function(e,t){this._view&&this._view.collectionChanged.removeHandler(this._collectionChanged),this._view=this._g?this._g.collectionView:null,this._gds=this._view?this._view.groupDescriptions:null,this._view&&this._view.collectionChanged.addHandler(this._collectionChanged,this),this.invalidate()},i.prototype._collectionChanged=function(t,i){i.action==e.collections.NotifyCollectionChangedAction.Reset&&this.invalidate()},i.prototype._dragStart=function(t){e._startDrag(t.dataTransfer,"move"),this._dragMarker=t.target,this._dragCol=null},i.prototype._dragOver=function(e){(this._dragCol||this._dragMarker)&&(e.dataTransfer.dropEffect="move",e.preventDefault(),e.stopPropagation())},i.prototype._drop=function(e){this._dragMarker?this._moveGroup(this._dragMarker,e):this._dragCol&&this._addGroup(this._dragCol,e)},i.prototype._dragEnd=function(e){this._dragMarker=this._dragCol=null},i.prototype._click=function(t){var i=t.target,r=e.hasClass(i,"wj-remove"),n=e.hasClass(i,"wj-filter"),o=e.closest(i,".wj-cell");if(e.hasClass(o,"wj-cell")){var s=this._getElementIndex(o),l=this._g.collectionView.sortDescriptions;if(n)this._editFilter(o);else if(r)this._removeGroup(s);else if(t.ctrlKey)l.clear();else{for(var a=this._gds[s],d=!0,h=0;h<l.length;h++)if(l[h].property==a.propertyName){d=!l[h].ascending;break}var g=new e.collections.SortDescription(a.propertyName,d);l.splice(0,l.length,g)}}},i.controlTemplate='<div style="cursor:default;overflow:hidden;height:100%;width:100%;min-height:1em"><div wj-part="div-ph"></div><div wj-part="div-markers"></div></div>',i}(e.Control);t.GroupPanel=i}(t.grouppanel||(t.grouppanel={}))}(e.grid||(e.grid={}))}(wijmo||(wijmo={})),function(e){!function(t){t.grouppanel||(t.grouppanel={}),e._registerModule("wijmo.grid.grouppanel",e.grid.grouppanel)}(e.grid||(e.grid={}))}(wijmo||(wijmo={}));