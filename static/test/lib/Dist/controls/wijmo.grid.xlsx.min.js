/*!
    *
    * Wijmo Library 5.20191.603
    * http://wijmo.com/
    *
    * Copyright(c) GrapeCity, Inc.  All rights reserved.
    *
    * Licensed under the GrapeCity Commercial License.
    * sales@wijmo.com
    * wijmo.com/products/wijmo-5/license/
    *
    */

var wijmo,__extends=this&&this.__extends||function(){var e=function(l,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,l){e.__proto__=l}||function(e,l){for(var o in l)l.hasOwnProperty(o)&&(e[o]=l[o])})(l,o)};return function(l,o){function t(){this.constructor=l}e(l,o),l.prototype=null===o?Object.create(o):(t.prototype=o.prototype,new t)}}();!function(e){!function(l){!function(l){l.softDetail=function(){return e._getModule("wijmo.grid.detail")},l.softMultiRow=function(){return e._getModule("wijmo.grid.multirow")}}(l.xlsx||(l.xlsx={}))}(e.grid||(e.grid={}))}(wijmo||(wijmo={})),function(e){var l;(function(l){"use strict";var o=function(){function o(){}return o.save=function(e,l,o){var t=this._saveFlexGridToWorkbook(e,l);return o&&t.save(o),t},o.saveAsync=function(e,l,o,t,r){var n=this._saveFlexGridToWorkbook(e,l);return o&&n.saveAsync(o,t,r),n},o.load=function(l,o,t){var r=this;if(o instanceof Blob){var n=new FileReader;n.onload=function(){var o=e.xlsx.Workbook._base64EncArr(new Uint8Array(n.result)),s=new e.xlsx.Workbook;s.load(o),o=null,l.deferUpdate(function(){r._loadToFlexGrid(l,s,t),s=null})},n.readAsArrayBuffer(o)}else if(o instanceof e.xlsx.Workbook)l.deferUpdate(function(){r._loadToFlexGrid(l,o,t),o=null});else{if(o instanceof ArrayBuffer)o=e.xlsx.Workbook._base64EncArr(new Uint8Array(o));else if(!e.isString(o))throw"Invalid workbook.";var s=new e.xlsx.Workbook;s.load(o),o=null,l.deferUpdate(function(){r._loadToFlexGrid(l,s,t),s=null})}},o.loadAsync=function(l,o,t,r,n){var s=this;if(o instanceof Blob){var i=new FileReader;i.onload=function(){var o=e.xlsx.Workbook._base64EncArr(new Uint8Array(i.result)),a=new e.xlsx.Workbook;a.loadAsync(o,function(e){o=null,a=null,l.deferUpdate(function(){s._loadToFlexGrid(l,e,t),r&&r(e),e=null})},n)},i.readAsArrayBuffer(o)}else if(o instanceof e.xlsx.Workbook)l.deferUpdate(function(){s._loadToFlexGrid(l,o,t),r&&r(o),o=null});else{if(o instanceof ArrayBuffer)o=e.xlsx.Workbook._base64EncArr(new Uint8Array(o));else if(!e.isString(o))throw"Invalid workbook.";(new e.xlsx.Workbook).loadAsync(o,function(e){o=null,l.deferUpdate(function(){s._loadToFlexGrid(l,e,t),r&&r(e),e=null})},n)}},o._saveFlexGridToWorkbook=function(l,o){var t,r,n,s,i,a,d,u,c,f,h,x,g,p,m=new e.xlsx.Workbook,w=new e.xlsx.WorkSheet,y=(new e.xlsx.WorkbookStyle,new e.xlsx.WorkbookFrozenPane),b=!o||null==o.includeColumnHeaders||o.includeColumnHeaders,_=!(!o||null==o.includeRowHeaders)&&o.includeRowHeaders,C=!o||null==o.includeCellStyles||o.includeCellStyles,k=o?o.activeWorksheet:null,v=o?o.includeColumns:null,S=o?o.formatItem:null,T=0,R=0,W=0,A=[];if(null==this.hasCssText&&(this.hasCssText="cssText"in document.body.style),f=l.wj_sheetInfo,w.name=o?o.sheetName:"",w.visible=!o||!1!==o.sheetVisible,f&&f.tables&&f.tables.length>0)for(var F=0;F<f.tables.length;F++)w.tables.push(f.tables[F]);if(a=[],f||!C&&!S||((h=document.createElement("div")).style.visibility="hidden",h.setAttribute(e.grid.FlexGrid._WJS_MEASURE,"true"),l.hostElement.appendChild(h)),_){for(u=0,d=0;d<l.rowHeaders.rows.length;d++)if(!(l.rowHeaders.rows[d].renderSize<=0)){for(a[u]=[],c=0;c<l.rowHeaders.columns.length;c++)n=l._getBindingColumn(l.rowHeaders,d,l.rowHeaders.columns[c]),(s=this._getColumnSetting(n,c,l.columnHeaders.columns))&&(a[u][c]=s,0===u&&((i=new e.xlsx.WorkbookColumn)._deserialize(s),w._addWorkbookColumn(i,c)));u++}W=c}if(l.columnHeaders.rows.length>0){for(u=0,d=0;d<l.columnHeaders.rows.length;d++)if(!(l.columnHeaders.rows[d].renderSize<=0)){for(a[u]||(a[u]=[]),c=0;c<l.columnHeaders.columns.length;c++)n=l._getBindingColumn(l.columnHeaders,d,l.columnHeaders.columns[c]),(s=this._getColumnSetting(n,c,l.columnHeaders.columns))&&(a[u][W+c]=s,0===u&&(v&&!v(n)||((i=new e.xlsx.WorkbookColumn)._deserialize(s),w._addWorkbookColumn(i,W+c))));b&&(W=0,t={},r=new e.xlsx.WorkbookRow,_&&(W=this._parseFlexGridRowToSheetRow(l.topLeftCells,t,d,0,a,C,h,A,!1,0,v,S)),this._parseFlexGridRowToSheetRow(l.columnHeaders,t,d,W,a,C,h,A,!1,0,v,S),t.cells.length>0&&(r._deserialize(t),w._addWorkbookRow(r,u))),u++}R=b?u:0}for(d=0;d<l.cells.rows.length;d++)W=0,t={},r=new e.xlsx.WorkbookRow,(x=l.rows[d])instanceof e.grid._NewRowTemplate||((g=x instanceof e.grid.GroupRow)?T=e.tryCast(x,e.grid.GroupRow).level:l.rows.maxGroupLevel>-1&&(T=l.rows.maxGroupLevel+1),_&&(W=this._parseFlexGridRowToSheetRow(l.rowHeaders,t,d,0,a,C,h,A,g,T,v,S)),this._parseFlexGridRowToSheetRow(l.cells,t,d,W,a,C,h,A,g,T,v,S),t.cells.length>0&&(r._deserialize(t),w._addWorkbookRow(r,R+d)));for(p=l.cells.rows.length,d=0;d<l.columnFooters.rows.length;d++)W=0,t={},r=new e.xlsx.WorkbookRow,g=(x=l.columnFooters.rows[d])instanceof e.grid.GroupRow,_&&(W=this._parseFlexGridRowToSheetRow(l.rowHeaders,t,d,0,a,C,h,A,g,0,v,S)),this._parseFlexGridRowToSheetRow(l.columnFooters,t,d,W,a,C,h,A,g,0,v,S),t.cells.length>0&&(r._deserialize(t),w._addWorkbookRow(r,R+p+d));return y.rows=b?l.frozenRows+R:l.frozenRows,y.columns=_?l.frozenColumns+W:l.frozenColumns,w.frozenPane=y,m._addWorkSheet(w),f||!C&&!S||(l.hostElement.removeChild(h),A.forEach(function(e){return e.forEach(function(e){e&&e.parentElement&&e.parentElement.removeChild(e)})})),m.activeWorksheet=k,m},o._loadToFlexGrid=function(l,o,t){var r,n,s,i,a,d,u,c,f,h,x,g,p,m,w,y,b,_,C,k,v,S,T,R,W,A,F,D,B,H,N,E,I=!t||null==t.includeColumnHeaders||t.includeColumnHeaders,z=!t||null==t.includeColumnHeaders||t.includeColumnHeaders,G=t&&null!=t.sheetIndex&&!isNaN(t.sheetIndex)?t.sheetIndex:0,M=t?t.sheetName:null,j=!t||t.sheetVisible,L=null!=l.wj_sheetInfo,O=0,P=0,V=!1,U={};if(l.itemsSource=null,l.columns.clear(),l.rows.clear(),l.frozenColumns=0,l.frozenRows=0,A={},F=[],P=0,s=[],D=[],G<0||G>=o.sheets.length)throw"The sheet index option is out of the sheet range of current workbook.";if(null!=M)for(r=0;r<o.sheets.length;r++)if(M===o.sheets[r].name){x=o.sheets[r];break}if(null!=(x=x||o.sheets[G]).rows){for(I&&(P=1,x.rows.length<=1&&(z=!1,P=0),u=x.rows[0]),p=this._getColumnCount(x.rows),g=this._getRowCount(x.rows,p),_=x.summaryBelow,n=x.columns,O=0;O<p;O++)l.columns.push(new e.grid.Column),n[O]&&(isNaN(+n[O].width)||(l.columns[O].width=+n[O].width),n[O].visible||null==n[O].visible||(l.columns[O].visible=!!n[O].visible),n[O].style&&n[O].style.wordWrap&&(l.columns[O].wordWrap=n[O].style.wordWrap));for(;P<g;P++){if(m=!1,E=null,h=x.rows[P])for(y=P+1;y<x.rows.length;){if(b=x.rows[y]){(isNaN(h.groupLevel)&&!isNaN(b.groupLevel)||!isNaN(h.groupLevel)&&h.groupLevel<b.groupLevel)&&(m=!0);break}y++}for(m&&!_?(k&&(k.isCollapsed=V),(k=new e.grid.GroupRow).isReadOnly=!1,V=null!=h.collapsed&&h.collapsed,k.level=isNaN(h.groupLevel)?0:h.groupLevel,U[k.level]=V,this._checkParentCollapsed(U,k.level)&&k._setFlag(e.grid.RowColFlags.ParentCollapsed,!0),l.rows.push(k)):(C=new e.grid.Row,h&&this._checkParentCollapsed(U,h.groupLevel)&&C._setFlag(e.grid.RowColFlags.ParentCollapsed,!0),l.rows.push(C)),h&&h.height&&!isNaN(h.height)&&(l.rows[z?P-1:P].height=h.height),O=0;O<p;O++)if(h){if((T=(w=h.cells[O])?w.formula:null)&&"="!==T[0]&&(T="="+T),w&&w.textRuns&&w.textRuns.length>0?(l.rows[z?P-1:P].isContentHtml=!0,l.setCellData(z?P-1:P,O,this._parseTextRunsToHTML(w.textRuns))):l.setCellData(z?P-1:P,O,T&&L?T:this._getItemValue(w)),m||this._setColumn(s,O,w),R=P*p+O,W=w?w.style:null,B=e.xlsx.Workbook._parseExcelFormat(w),W){if(E=null==E?!!W.wordWrap:E&&!!W.wordWrap,H=this._getItemType(w),W.hAlign)N=e.xlsx.Workbook._parseHAlignToString(e.asEnum(W.hAlign,e.xlsx.HAlign));else switch(H){case e.DataType.Number:N="right";break;case e.DataType.Boolean:N="center";break;default:N=B&&0===B.search(/[n,c,p]/i)?"right":"left"}A[R]={fontWeight:W.font&&W.font.bold?"bold":"none",fontStyle:W.font&&W.font.italic?"italic":"none",textDecoration:W.font&&W.font.underline?"underline":"none",textAlign:N,fontFamily:W.font&&W.font.family?W.font.family:"",fontSize:W.font&&W.font.size?W.font.size+"px":"",color:W.font&&W.font.color?W.font.color:"",backgroundColor:W.fill&&W.fill.color?W.fill.color:"",whiteSpace:W.wordWrap?"pre-wrap":"normal",format:B},W.borders&&(W.borders.left&&(this._parseBorderStyle(W.borders.left.style,"Left",A[R]),A[R].borderLeftColor=W.borders.left.color),W.borders.right&&(this._parseBorderStyle(W.borders.right.style,"Right",A[R]),A[R].borderRightColor=W.borders.right.color),W.borders.top&&(this._parseBorderStyle(W.borders.top.style,"Top",A[R]),A[R].borderTopColor=W.borders.top.color),W.borders.bottom&&(this._parseBorderStyle(W.borders.bottom.style,"Bottom",A[R]),A[R].borderBottomColor=W.borders.bottom.color)),W.font&&-1===D.indexOf(W.font.family)&&D.push(W.font.family)}w&&e.isNumber(w.rowSpan)&&w.rowSpan>0&&e.isNumber(w.colSpan)&&w.colSpan>0&&(w.rowSpan>1||w.colSpan>1)&&F.push(new e.grid.CellRange(P,O,P+w.rowSpan-1,O+w.colSpan-1))}h&&(this._checkParentCollapsed(U,h.groupLevel)||h.visible||null==h.visible||(l.rows[z?P-1:P].visible=h.visible),l.rows[z?P-1:P].wordWrap=!!h.style&&!!h.style.wordWrap||!!E)}for(k&&(k.isCollapsed=V),x.frozenPane&&(v=x.frozenPane.columns,e.isNumber(v)&&!isNaN(v)&&(l.frozenColumns=v),S=x.frozenPane.rows,e.isNumber(S)&&!isNaN(S)&&(l.frozenRows=z&&S>0?S-1:S)),O=0;O<l.columnHeaders.columns.length;O++)i=s[O],(a=l.columns[O]).isRequired=!1,z&&((c=u?u.cells[O]:null)&&c.value?(f=e.xlsx.Workbook._parseExcelFormat(c),d=e.Globalize.format(c.value,f)):d=""),a.header=d,i&&(i.dataType===e.DataType.Boolean&&(a.dataType=i.dataType),a.format=i.format,a.align=i.hAlign,a.wordWrap=a.wordWrap||!!i.wordWrap);L&&(l.wj_sheetInfo.name=x.name,l.wj_sheetInfo.visible=!0===j||!1!==x.visible,l.wj_sheetInfo.styledCells=A,l.wj_sheetInfo.mergedRanges=F,l.wj_sheetInfo.fonts=D,l.wj_sheetInfo.tables=x.tables)}},o._parseFlexGridRowToSheetRow=function(o,r,n,s,i,a,d,u,c,f,h,x){var g,p,m,w,y,b,_,C,k,v,S,T,R,W,A,F,D,B,H,N,E,I,z,G,M,j,L,O,P,V,U=!1,X=!1;for((H=(g=o.grid).wj_sheetInfo)&&(N=H.evaluateFormula),null==(p=o.rows[n]).recordIndex?(G=0,o.cellType===e.grid.CellType.ColumnHeader&&o.rows.length>1&&(G=n===i.length?n-1:n)):G=p.recordIndex,r.cells||(r.cells=[]),r.visible=p.isVisible,r.height=p.renderHeight||o.rows.defaultSize,r.groupLevel=f,c&&(r.collapsed=p.isCollapsed),p.wordWrap&&(r.style={wordWrap:p.wordWrap}),(p.constructor===e.grid.Row||p.constructor===e.grid._NewRowTemplate||l.softDetail()&&p.constructor===l.softDetail().DetailRow||l.softMultiRow()&&p.constructor===l.softMultiRow()._MultiRow)&&(U=!0),l.softDetail()&&p.constructor===l.softDetail().DetailRow&&(X=!0),w=0;w<o.columns.length;w++)if(y=null,B=1,D=1,P=0,z=!1,A=null,L=null,j=null,C=null,I=g._getBindingColumn(o,n,o.columns[w]),F=null,H&&o===g.cells?(W=n*o.columns.length+w,H.mergedRanges&&(F=this._getMergedRange(n,w,H.mergedRanges)),H.styledCells&&(A=H.styledCells[W])):a&&(j=this._getMeasureCell(o,w,d,u),A=(F=g.getMergedRange(o,n,w,!1))?this._getCellStyle(o,j,F.bottomRow,F.rightCol)||{}:this._getCellStyle(o,j,n,w)||{}),F||(F=g.getMergedRange(o,n,w,!1)),F?n===F.topRow&&w===F.leftCol&&(D=F.bottomRow-F.topRow+1,B=this._getColSpan(o,F,h),z=!0):z=!0,!h||h(I)){if(m=i[G]?i[G][w+s]:null,U||c?(_=z?o.getCellData(n,w,!0):null,k=z?o.getCellData(n,w,!1):null,S=!1,R=null,_&&e.isString(_)&&_.length>1&&"="===_[0]&&(S=!0),E=e.isDate(k),A&&A.format&&null!=k?(y=A.format,/[hsmyt\:]/i.test(y)&&(E=!0),b=e.xlsx.Workbook._parseCellFormat(A.format,E)):m&&m.style&&m.style.format?(y=I.format,b=m.style.format):b=null,S&&null!=N&&e.isFunction(N)&&(R=N(_)),b||(E?b="m/d/yyyy":e.isNumber(k)&&!I.dataMap?b=e.isInt(k)?"#,##0":"#,##0.00":S?(T=_.toLowerCase()).indexOf("now()")>-1?(b="m/d/yyyy h:mm",E=!0):T.indexOf("today()")>-1||T.indexOf("date(")>-1?(b="m/d/yyyy",E=!0):T.indexOf("time(")>-1&&(b="h:mm AM/PM",E=!0):b="General")):(_=z?g.columnHeaders.getCellData(0,w,!0):null,b="General"),e.isString(_)&&-1!==_.indexOf("<span")&&(C=this._parseToTextRuns(_),_=null),L=this._parseCellStyle(A)||{},o===g.cells&&c&&p.hasChildren&&w===g.columns.firstVisibleIndex){if(S&&null!=R?v=R:_?v=_:z&&(v=p.getGroupHeader().replace(/<\/?\w+>/g,"").replace(/&#39;/g,"'")),null==v&&!A)continue;!(E=e.isDate(v))&&y&&"d"===y.toLowerCase()&&e.isInt(v)&&(b="0"),v=e.isString(v)?e.xlsx.Workbook._unescapeXML(v):v,w===g.columns.firstVisibleIndex&&g.treeIndent&&(P=f),M={value:v,isDate:E,formula:S?this._parseToExcelFormula(_,E):null,colSpan:B,rowSpan:D,style:this._extend(L,{format:b,font:{bold:!0},hAlign:e.xlsx.HAlign.Left,indent:P}),textRuns:C}}else _=e.isString(_)?e.xlsx.Workbook._unescapeXML(_):_,k=e.isString(k)?e.xlsx.Workbook._unescapeXML(k):k,!E&&y&&"d"===y.toLowerCase()&&e.isInt(k)&&(b="0"),O=L&&L.hAlign?L.hAlign:m&&m.style&&null!=m.style.hAlign?e.asEnum(m.style.hAlign,e.xlsx.HAlign,!0):e.isDate(k)?e.xlsx.HAlign.Left:e.xlsx.HAlign.General,w!==g.columns.firstVisibleIndex||!g.treeIndent||O!==e.xlsx.HAlign.Left&&O!==e.xlsx.HAlign.General||(P=f),M={value:S?R:"General"===b?_:k,isDate:E,formula:S?this._parseToExcelFormula(_,E):null,colSpan:w<g.columns.firstVisibleIndex?1:B,rowSpan:D,style:this._extend(L,{format:b,hAlign:O,vAlign:D>1?o===g.cells||!1===g.centerHeadersVertically?e.xlsx.VAlign.Top:e.xlsx.VAlign.Center:null,indent:P}),textRuns:C},X&&(V=o.getCellElement(n,w))&&V.appendChild(p.detail);x&&x(new t(o,new e.grid.CellRange(n,w),j,d,u,M)),r.cells.push(M)}return s+w},o._parseCellStyle=function(l,o){if(void 0===o&&(o=!1),null==l)return null;var t=l.fontSize;t=t?+t.substring(0,t.indexOf("px")):null,isNaN(t)&&(t=null);var r=l.fontWeight;r="bold"===r||+r>=700;var n="italic"===l.fontStyle,s=l.textDecorationStyle;null==s&&(s=l.textDecoration),s="underline"===s;var i=l.whiteSpace;return i=!!i&&i.indexOf("pre")>-1,{font:{bold:r,italic:n,underline:s,family:this._parseToExcelFontFamily(l.fontFamily),size:t,color:l.color},fill:{color:l.backgroundColor},borders:this._parseBorder(l,o),hAlign:e.xlsx.Workbook._parseStringToHAlign(l.textAlign),wordWrap:i}},o._parseBorder=function(e,l){var o={};return o.left=this._parseEgdeBorder(e,"Left"),o.right=this._parseEgdeBorder(e,"Right"),o.top=this._parseEgdeBorder(e,"Top"),o.bottom=this._parseEgdeBorder(e,"Bottom"),l&&(o.vertical=this._parseEgdeBorder(e,"Vertical"),o.horizontal=this._parseEgdeBorder(e,"Horizontal")),o},o._parseEgdeBorder=function(l,o){var t,r=l["border"+o+"Style"],n=l["border"+o+"Width"];if(n&&n.length>2&&(n=+n.substring(0,n.length-2)),r&&"none"!==r&&"hidden"!==r){switch(t={},r=r.toLowerCase()){case"dotted":t.style=n>1?e.xlsx.BorderStyle.MediumDashDotted:e.xlsx.BorderStyle.Dotted;break;case"dashed":t.style=n>1?e.xlsx.BorderStyle.MediumDashed:e.xlsx.BorderStyle.Dashed;break;case"double":t.style=e.xlsx.BorderStyle.Double;break;default:t.style=n>2?e.xlsx.BorderStyle.Thick:n>1?e.xlsx.BorderStyle.Medium:e.xlsx.BorderStyle.Thin}t.color=l["border"+o+"Color"]}return t},o._parseBorderStyle=function(l,o,t){var r="border"+o+"Style",n="border"+o+"Width";switch(l){case e.xlsx.BorderStyle.Dotted:case e.xlsx.BorderStyle.Hair:t[r]="dotted",t[n]="1px";break;case e.xlsx.BorderStyle.Dashed:case e.xlsx.BorderStyle.ThinDashDotDotted:case e.xlsx.BorderStyle.ThinDashDotted:t[r]="dashed",t[n]="1px";break;case e.xlsx.BorderStyle.MediumDashed:case e.xlsx.BorderStyle.MediumDashDotDotted:case e.xlsx.BorderStyle.MediumDashDotted:case e.xlsx.BorderStyle.SlantedMediumDashDotted:t[r]="dashed",t[n]="2px";break;case e.xlsx.BorderStyle.Double:t[r]="double",t[n]="3px";break;case e.xlsx.BorderStyle.Medium:t[r]="solid",t[n]="2px";break;default:t[r]="solid",t[n]="1px"}},o._parseToExcelFontFamily=function(e){var l;return e&&(l=e.split(","))&&l.length>0&&(e=l[0].replace(/\"|\'/g,"")),e},o._parseToExcelFormula=function(l,o){var t,r,n,s,i,a,d,u=/\"?\w+\"?\s*\,\s*\"(\w+)\"/i;if(t=l.match(/(floor|ceiling)\([+-]?\d+\.?\d*\)/gi))for(i=0;i<t.length;i++)d=(a=t[i]).substring(0,a.lastIndexOf(")"))+", 1)",l=l.replace(a,d);if(t=null,t=l.match(/text\(\"?\w+\"?\s*\,\s*\"\w+\"\)/gi))for(i=0;i<t.length;i++)(r=(a=t[i]).match(u))&&2===r.length&&(n=r[1],/^d{1,4}?$/.test(n)||(s=e.xlsx.Workbook._parseCellFormat(n,o),d=a.replace(n,s),l=l.replace(a,d)));return l},o._parseToTextRuns=function(e){var l,o,t,r=e.split("<span "),n=[];for(l=0;l<r.length;l++)t=-1!==(o=r[l]).indexOf("</span>")?{text:o.substring(o.indexOf(">")+1,o.indexOf("</span>")),font:this._parseToTextRunFont(o.substring(o.indexOf('style="')+7,o.indexOf(';"')))}:{text:o},n.push(t);return n},o._parseToTextRunFont=function(e){var l,o,t,r,n,s,i,a,d,u=e.split(";");if(u.length>0){for(l=0;l<u.length;l++)if(2===(o=u[l].split(":")).length)switch(o[1]=o[1].trim(),o[0]){case"font-size":s=+o[1].substring(0,o[1].indexOf("px")),isNaN(s)&&(s=null);break;case"font-weight":t="bold"===o[1]||+o[1]>=700;break;case"font-style":r="italic"===o[1];break;case"text-decoration-style":case"text-decoration":n="underline"===o[1];break;case"font-family":i=this._parseToExcelFontFamily(o[1]);break;case"color":a=o[1]}d={bold:t,italic:r,underline:n,family:i,size:s,color:a}}return d},o._getMeasureCell=function(e,l,o,t){var r=t[e.cellType],n=r&&r[l],s=null==n;return n?this.hasCssText&&(n.style,n.style.cssText="",n.style.visibility="hidden"):(r||(t[e.cellType]=r=[]),r[l]=n=o.cloneNode()),!s&&n.parentElement||(e.hostElement.children.length>0?e.hostElement.children[0].appendChild(n):e.hostElement.appendChild(n)),n},o._getColumnSetting=function(l,o,t){return null!=l.colspan&&(l=this._getRenderColumn(o,t)),l?{autoWidth:!0,width:l.renderWidth||t.defaultSize,visible:l.visible,style:{format:l.format?e.xlsx.Workbook._parseCellFormat(l.format,l.dataType===e.DataType.Date):"",hAlign:e.xlsx.Workbook._parseStringToHAlign(this._toExcelHAlign(l.getAlignment())),wordWrap:l.wordWrap}}:null},o._toExcelHAlign=function(e){return(e=e?e.trim().toLowerCase():e)?e.indexOf("center")>-1?"center":e.indexOf("right")>-1||e.indexOf("end")>-1?"right":e.indexOf("justify")>-1?"justify":"left":e},o._getColumnCount=function(l){for(var o,t=0,r=0,n=0;n<l.length;n++)(o=l[n]&&l[n].cells?l[n].cells:[])&&o.length>0&&(r=o.length,e.isInt(o[r-1].colSpan)&&o[r-1].colSpan>1&&(r=r+o[r-1].colSpan-1),r>t&&(t=r));return t},o._getRowCount=function(l,o){for(var t,r,n=l.length,s=n-1,i=0;i<o;i++)e:for(;s>=0;s--)if((r=((t=l[s])&&t.cells?t.cells:[])[i])&&(null!=r.value&&""!==r.value||e.isInt(r.rowSpan)&&r.rowSpan>1)){e.isInt(r.rowSpan)&&r.rowSpan>1&&s+r.rowSpan>n&&(n=s+r.rowSpan);break e}return n},o._numAlpha=function(e){var l=Math.floor(e/26)-1;return(l>-1?this._numAlpha(l):"")+String.fromCharCode(65+e%26)},o._getItemType=function(l){return null==l||null==l.value||isNaN(l.value)?null:e.getType(l.value)},o._setColumn=function(l,o,t){var r,n,s,i=l[o];i?(r=this._getItemType(t),i.dataType!==r&&i.dataType===e.DataType.Boolean&&r!==e.DataType.Boolean&&(i.dataType=r),!t||null==t.value||e.isString(t.value)&&e.isNullOrWhiteSpace(t.value)||(n=e.xlsx.Workbook._parseExcelFormat(t))&&i.format!==n&&"General"!==n&&(i.format=n),t&&t.style&&(t.style.hAlign&&(s=e.xlsx.Workbook._parseHAlignToString(e.asEnum(t.style.hAlign,e.xlsx.HAlign))),null==i.wordWrap?i.wordWrap=!!t.style.wordWrap:i.wordWrap=i.wordWrap&&!!t.style.wordWrap),s||r!==e.DataType.Number||(s="right"),i.hAlign=s):l[o]={dataType:this._getItemType(t),format:e.xlsx.Workbook._parseExcelFormat(t),hAlign:"",wordWrap:null}},o._getItemValue=function(l){if(null==l||null==l.value)return null;var o=l.value;return e.isNumber(o)&&isNaN(o)?"":o instanceof Date&&isNaN(o.getTime())?"":o},o._getCellStyle=function(e,l,o,t){try{e.grid.cellFactory.updateCell(e,o,t,l),l.className=l.className.replace("wj-state-selected",""),l.className=l.className.replace("wj-state-multi-selected","")}catch(e){return null}return window.getComputedStyle(l)},o._parseTextRunsToHTML=function(e){var l,o,t,r;for(t="",r=0;r<e.length;r++)t+=(o=(l=e[r]).font)?'<span style="'+(o.bold?"font-weight: bold;":"")+(o.italic?"font-style: italic;":"")+(o.underline?"text-decoration: underline;":"")+(o.family?"font-family: "+o.family+";":"")+(null!=o.size?"font-size: "+o.size+"px;":"")+(o.color?"color: "+o.color+";":"")+'">'+l.text+"</span>":l.text;return t},o._extend=function(l,o){for(var t in o){var r=o[t];e.isObject(r)&&l[t]?e.copy(l[t],r):l[t]=r}return l},o._checkParentCollapsed=function(e,l){var o=!1;return Object.keys(e).forEach(function(t){!0===e[t]&&!1===o&&!isNaN(l)&&+t<l&&(o=!0)}),o},o._getColSpan=function(e,l,o){for(var t=0,r=l.leftCol;r<=l.rightCol;r++)o&&!o(e.columns[r])||t++;return t},o._getRenderColumn=function(e,l){return e>=l.length?null:l[e]},o._getMergedRange=function(e,l,o){var t,r;for(t=0;t<o.length;t++)if(e>=(r=o[t]).topRow&&e<=r.bottomRow&&l>=r.leftCol&&l<=r.rightCol)return r;return null},o}();l.FlexGridXlsxConverter=o;var t=function(e){function l(l,o,t,r,n,s){var i=e.call(this,l,o)||this;return i._cell=t,i._patternCell=r,i._xlsxCell=s,i._cellsCache=n,i}return __extends(l,e),Object.defineProperty(l.prototype,"cell",{get:function(){return this._cell},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"xlsxCell",{get:function(){return this._xlsxCell},set:function(e){this._xlsxCell=e},enumerable:!0,configurable:!0}),l.prototype.getFormattedCell=function(){return this._cell||(this._cell=o._getMeasureCell(this.panel,this.col,this._patternCell,this._cellsCache),o._getCellStyle(this.panel,this._cell,this.row,this.col)),this._cell},l}(e.grid.CellRangeEventArgs);l.XlsxFormatItemEventArgs=t})((l=e.grid||(e.grid={})).xlsx||(l.xlsx={}))}(wijmo||(wijmo={})),function(e){!function(l){l.xlsx||(l.xlsx={}),e._registerModule("wijmo.grid.xlsx",e.grid.xlsx)}(e.grid||(e.grid={}))}(wijmo||(wijmo={}));