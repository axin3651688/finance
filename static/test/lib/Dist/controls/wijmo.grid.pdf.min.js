/*!
    *
    * Wijmo Library 5.20191.603
    * http://wijmo.com/
    *
    * Copyright(c) GrapeCity, Inc.  All rights reserved.
    *
    * Licensed under the GrapeCity Commercial License.
    * sales@wijmo.com
    * wijmo.com/products/wijmo-5/license/
    *
    */

var wijmo,__extends=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function o(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}();!function(e){!function(t){!function(t){"use strict";t.softGrid=function(){return e._getModule("wijmo.grid")},t.softDetail=function(){return e._getModule("wijmo.grid.detail")},t.softMultiRow=function(){return e._getModule("wijmo.grid.multirow")},t.softSheet=function(){return e._getModule("wijmo.grid.sheet")},t.softOlap=function(){return e._getModule("wijmo.olap")}}(t.pdf||(t.pdf={}))}(e.grid||(e.grid={}))}(wijmo||(wijmo={})),function(e){!function(t){!function(t){"use strict";t._merge=function t(r,o,n){if(void 0===n&&(n=!1),!r&&o&&(r={}),o&&r)for(var i in o){var l=o[i],s=r[i];if(e.isObject(l)){if(void 0===s||!e.isObject(s)&&n){if(e.isFunction(l.clone)){r[i]=s=l.clone();continue}r[i]=s={}}e.isObject(s)&&t(r[i],l,n)}else(void 0===s||n&&void 0!==l)&&(r[i]=l)}return r}}(t.pdf||(t.pdf={}))}(e.grid||(e.grid={}))}(wijmo||(wijmo={})),function(e){!function(e){!function(e){"use strict";!function(e){e[e.ActualSize=0]="ActualSize",e[e.PageWidth=1]="PageWidth",e[e.SinglePage=2]="SinglePage"}(e.ScaleMode||(e.ScaleMode={})),function(e){e[e.All=0]="All",e[e.Selection=1]="Selection"}(e.ExportMode||(e.ExportMode={}))}(e.pdf||(e.pdf={}))}(e.grid||(e.grid={}))}(wijmo||(wijmo={})),function(e){!function(t){!function(t){"use strict";var r=function(t){function r(r,o,n,i,l,s,a,u,c){var f=t.call(this)||this;return f.cancelBorders=!1,f._p=r,f._rng=o,f._cell=e.asType(n,HTMLElement,!0),f._canvas=i,f._clientRect=l,f._contentRect=s,f._textTop=a,f._style=u,f._getFormattedCell=c,f}return __extends(r,t),Object.defineProperty(r.prototype,"panel",{get:function(){return this._p},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"range",{get:function(){return this._rng.clone()},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"row",{get:function(){return this._rng.row},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"col",{get:function(){return this._rng.col},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"data",{get:function(){return this._data},set:function(e){this._data=e},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"canvas",{get:function(){return this._canvas},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"cell",{get:function(){return this._cell},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"clientRect",{get:function(){return this._clientRect},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"contentRect",{get:function(){return this._contentRect},enumerable:!0,configurable:!0}),r.prototype.getFormattedCell=function(){return e.asFunction(this._getFormattedCell)()},Object.defineProperty(r.prototype,"style",{get:function(){return this._style},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"textTop",{get:function(){return this._textTop},enumerable:!0,configurable:!0}),r}(e.CancelEventArgs);t.PdfFormatItemEventArgs=r}(t.pdf||(t.pdf={}))}(e.grid||(e.grid={}))}(wijmo||(wijmo={})),function(e){!function(e){!function(e){"use strict";!function(e){e[e.None=0]="None",e[e.Cell=1]="Cell",e[e.ColumnHeader=2]="ColumnHeader",e[e.RowHeader=3]="RowHeader",e[e.TopLeft=4]="TopLeft",e[e.ColumnFooter=5]="ColumnFooter",e[e.BottomLeft=6]="BottomLeft"}(e._CellType||(e._CellType={}))}(e.pdf||(e.pdf={}))}(e.grid||(e.grid={}))}(wijmo||(wijmo={})),function(e){var t;(function(t){"use strict";var r=function(){function r(){}return r.draw=function(r,o,n,i,l,s){e.assert(!!r,"The flex argument cannot be null."),e.assert(!!o,"The doc argument cannot be null."),null==(s=this._applyDefaultDrawSettings(s)).scaleMode&&(s.scaleMode=null==i?t.ScaleMode.ActualSize:null==l?t.ScaleMode.PageWidth:t.ScaleMode.SinglePage),this._drawInternal(r,o,n,i,l,s)},r._applyDefaultDrawSettings=function(e){return t._merge(t._merge({},e),r.DefaultDrawSettings)},r._drawInternal=function(t,r,n,i,l,s){var a=null!=n,u=new e.Size(r.width,r.height);n||(n=new e.Point(0,r.y)),e.isArray(s.embeddedFonts)&&s.embeddedFonts.forEach(function(e){r.registerFont(e)});var c=this._getRowsToRender(t,s),f=new o(t,s,c,this.BorderWidth,!0),p=new e.Rect(n.x||0,n.y||0,i||u.width,l||u.height),d=this._getScaleFactor(f,s.scaleMode,p),h=this._getPages(f,c,p,s,a,d),g=(s.progress?this._getCellsCount(t,s,h):0)/s._progressMax,b=0,_=0,w=s.progress?function(){++b-_>=50&&(_=b,s.progress(b/g))}:null;s.progress&&s.progress(0);for(var m=0;m<h.length;m++){m>0&&r.addPage();var y=h[m],C=0===y.pageCol?p.left:0,v=0===y.pageRow?p.top:0;r.saveState(),r.paths.rect(0,0,u.width,u.height).clip(),r.scale(d,d,new e.Point(C,v)),r.translate(C,v);var x=new o(t,s,y.range,this.BorderWidth,m===h.length-1);x.render(r,w),r.restoreState(),r.x=C,r.y=v+x.renderSize.height*d}s.progress&&0<s._progressMax&&s.progress(s._progressMax)},r._getCellsCount=function(e,t,r){for(var n=0,i=0;i<r.length;i++)n+=new o(e,t,r[i].range,0,!1).getCellsCount();return n},r._getRowsToRender=function(e,r){var o=[];r.exportMode===t.ExportMode.All?o.push(new s(null,0,0,e.rows.length-1,e.columns.length-1)):o=e.getSelection();var n=new a(o);if(!r.drawDetailRows){var i=[];n.forEach(e.cells,function(t,r,o){if(!e.isDetailRow(t)){var n=i.length;n&&i[n-1].bottomRow+1===o?i[n-1].row2++:i.push(new s(null,o,r.col,o,r.col2))}}),n=new a(i)}return n},r._getScaleFactor=function(e,r,o){var n=1;if(r===t.ScaleMode.ActualSize)return n;var i,l=e.renderSize;return r===t.ScaleMode.SinglePage?(i=Math.min(o.width/l.width,o.height/l.height))<1&&(n=i):(i=o.width/l.width)<1&&(n=i),n},r._getPages=function(r,o,n,i,l,s){var a=this,c=[],f=[],p=e.pdf.pxToPt,d=r.flex,h=r.showColumnHeader,g=r.showColumnFooter,b=r.showRowHeader,_=h?p(d.columnHeaders.height):0,w=g?p(d.columnFooters.height):0,m=b?p(d.rowHeaders.width):0,y=i.scaleMode===t.ScaleMode.ActualSize||i.scaleMode===t.ScaleMode.PageWidth,C=i.scaleMode===t.ScaleMode.ActualSize,v=(n.width-n.left)*(1/s),x=(n.height-n.top)*(1/s),R=n.width*(1/s),P=n.height*(1/s),S=_+w,T=m,j=l&&i.scaleMode===t.ScaleMode.ActualSize;if(y){var O=0;o.forEach(d.cells,function(e,t,o,n){var i=c.length?P:x;if(r.isRenderableRow(e)){var l=p(e.renderHeight);S+=l,(h||++O>1)&&(S-=a.BorderWidth),S>i&&(_+l>i||j?(c.push(n),S=_):(c.push(n-1),S=_+l),h&&(S-=a.BorderWidth))}})}var M=o.length()-1;if(M<0&&(M=0),c.length&&c[c.length-1]===M||c.push(M),C)for(var H=0,z=o.leftCol;z<=o.rightCol;z++){var G=d.columns[z];if(G.isVisible){var F=p(G.renderWidth),L=f.length?R:v;T+=F,(b||++H>1)&&(T-=this.BorderWidth),T>L&&(m+F>L||j?(f.push(z),T=m):(f.push(z-1),T=m+F),b&&(T-=this.BorderWidth))}}f.length&&f[f.length-1]===o.rightCol||f.push(o.rightCol);var W=[],A=!1,D=1,V=l&&i.maxPages>0?1:i.maxPages;for(z=0;z<c.length&&!A;z++)for(var E=0;E<f.length&&!A;E++,D++)if(!(A=D>V)){var B=0===z?0:c[z-1]+1,N=0===E?o.leftCol:f[E-1]+1;W.push(new u(o.subrange(B,c[z]-B+1,N,f[E]),E,z))}return W},r.BorderWidth=1,r.DefFont=new e.pdf.PdfFont,r.DefaultDrawSettings={customCellContent:!1,drawDetailRows:!1,exportMode:t.ExportMode.All,maxPages:Number.MAX_VALUE,repeatMergedValuesAcrossPages:!0,recalculateStarWidths:!0,styles:{cellStyle:{font:{family:r.DefFont.family,size:r.DefFont.size,style:r.DefFont.style,weight:r.DefFont.weight},padding:1.5,verticalAlign:"middle"},headerCellStyle:{font:{weight:"bold"}}},_progressMax:1},r}();t._FlexGridPdfCoreConverter=r;var o=function(){function t(e,t,r,o,i){this._flex=e,this._borderWidth=o,this._lastPage=i,this._settings=t||{},this._topLeft=new n(this,e.topLeftCells,this.showRowHeader&&this.showColumnHeader?new a([new s(null,0,0,e.topLeftCells.rows.length-1,e.topLeftCells.columns.length-1)]):new a([]),o),this._rowHeader=new n(this,e.rowHeaders,this.showRowHeader?r.clone(0,e.rowHeaders.columns.length-1):new a([]),o),this._columnHeader=new n(this,e.columnHeaders,this.showColumnHeader?new a([new s(null,0,r.leftCol,e.columnHeaders.rows.length-1,r.rightCol)]):new a([]),o),this._cells=new n(this,e.cells,r,o),this._bottomLeft=new n(this,e.bottomLeftCells,this.showRowHeader&&this.showColumnFooter?new a([new s(null,0,0,e.bottomLeftCells.rows.length-1,e.bottomLeftCells.columns.length-1)]):new a([]),o),this._columnFooter=new n(this,e.columnFooters,this.showColumnFooter?new a([new s(null,0,r.leftCol,e.columnFooters.rows.length-1,r.rightCol)]):new a([]),o)}return Object.defineProperty(t.prototype,"settings",{get:function(){return this._settings},enumerable:!0,configurable:!0}),t.prototype.isRenderableRow=function(e){return e.isVisible&&!this._flex.isNewRow(e)},t.prototype.getCellsCount=function(){return this._topLeft.getCellsCount()+this._rowHeader.getCellsCount()+this._columnHeader.getCellsCount()+this._cells.getCellsCount()+this._bottomLeft.getCellsCount()+this._columnFooter.getCellsCount()},t.prototype.render=function(e,t){var r=Math.max(0,Math.max(this._topLeft.renderSize.width,this._rowHeader.renderSize.width)-this._borderWidth),o=Math.max(0,Math.max(this._topLeft.renderSize.height,this._columnHeader.renderSize.height)-this._borderWidth);this._topLeft.render(e,0,0,t),this._rowHeader.render(e,0,o,t),this._columnHeader.render(e,r,0,t),this._cells.render(e,r,o,t),o=Math.max(0,o+this._cells.renderSize.height-this._borderWidth),this._bottomLeft.render(e,0,o,t),this._columnFooter.render(e,r,o,t)},Object.defineProperty(t.prototype,"flex",{get:function(){return this._flex},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"renderSize",{get:function(){var t=Math.max(this._topLeft.renderSize.height,this._columnHeader.renderSize.height)+Math.max(this._rowHeader.renderSize.height,this._cells.renderSize.height)+Math.max(this._bottomLeft.renderSize.height,this._columnFooter.renderSize.height),r=Math.max(this._topLeft.renderSize.width,this._rowHeader.renderSize.width)+Math.max(this._columnHeader.renderSize.width,this._cells.renderSize.width);return this._columnHeader.visibleRows>0&&(t-=this._borderWidth),this._columnFooter.visibleRows>0&&(t-=this._borderWidth),this._rowHeader.visibleColumns>0&&(r-=this._borderWidth),new e.Size(r,t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"showColumnHeader",{get:function(){return this._flex.showColumnHeader},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"showRowHeader",{get:function(){return this._flex.showRowHeader},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"showColumnFooter",{get:function(){return this._lastPage&&this._flex.showColumnFooter},enumerable:!0,configurable:!0}),t.prototype.alignMergedTextToTheTopRow=function(e){return this._flex.alignMergedTextToTheTopRow(e)},t.prototype.getColumn=function(e,t,r){return this._flex.getColumn(e,t,r)},t.prototype.isAlternatingRow=function(e){return this._flex.isAlternatingRow(e)},t.prototype.isGroupRow=function(e){return this._flex.isGroupRow(e)},t.prototype.isNewRow=function(e){return this._flex.isNewRow(e)},t.prototype.isExpandableGroupRow=function(e){return this._flex.isExpandableGroupRow(e)},t.prototype.isBooleanCell=function(e,t,r){return this._flex.isBooleanCell(e,t,r)},t.prototype.getCellStyle=function(e,t,r){return this._flex.getCellStyle(e,t,r)},t}(),n=function(t){function r(e,r,o,n){var i=t.call(this,r,o)||this;return i._gr=e,i._borderWidth=n,i}return __extends(r,t),Object.defineProperty(r.prototype,"gr",{get:function(){return this._gr},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"renderSize",{get:function(){return null==this._renderSize&&(this._renderSize=this.size.clone(),this.visibleColumns>1&&(this._renderSize.width-=this._borderWidth*(this.visibleColumns-1)),this.visibleRows>1&&(this._renderSize.height-=this._borderWidth*(this.visibleRows-1))),this._renderSize},enumerable:!0,configurable:!0}),r.prototype.getRangeWidth=function(t,r){for(var o=0,n=0,i=this.panel,l=t;l<=r;l++){var s=i.columns[l];s.isVisible&&(n++,o+=s.renderWidth)}return o=e.pdf.pxToPt(o),n>1&&(o-=this._borderWidth*(n-1)),o},r.prototype.getRangeHeight=function(t,r){for(var o=0,n=0,i=this.panel,l=t;l<=r;l++){var s=i.rows[l];this.isRenderableRow(s)&&(n++,o+=s.renderHeight)}return o=e.pdf.pxToPt(o),n>1&&(o-=this._borderWidth*(n-1)),o},r.prototype.getCellsCount=function(){var e=this,t=0,r=this.range,o=this.panel,n=new l(this._gr.flex);return r.isValid?(r.forEach(o,function(i,l,s){if(e.isRenderableRow(i))for(var a=r.leftCol;a<=r.rightCol;a++){var u,c=!1,f=void 0;if(o.columns[a].isVisible)(u=n.getMergedRange(o,s,a))?u.topRow!==u.bottomRow?u.firstVisibleRow!==s&&s!==l.topRow||(c=!0):(c=!0,f=Math.min(r.rightCol,u.rightCol)):c=!0,c&&t++,f&&(a=f)}}),t):t},r.prototype.render=function(t,r,o,n){var a=this,u=this.range,c=this.panel,f=new l(this._gr.flex),p=new s(c,0,0,0,0),d=new i(this,t,this._borderWidth);if(u.isValid){for(var h={},g=u.leftCol;g<=u.rightCol;g++)h[g]=o;u.forEach(c,function(t,o,i){if(a.isRenderableRow(t))for(var l=r,s=u.leftCol;s<=u.rightCol;s++){var g,b=a.gr.getColumn(c,i,s),_=void 0,w=void 0,m=!1,y=void 0;if(c.columns[s].isVisible){var C,v=a._gr.flex.getCellContent(a.panel,t,b,s);if(C=f.getMergedRange(c,i,s))if(p.copyFrom(C),C.topRow!==C.bottomRow)C.firstVisibleRow===i||i===o.topRow?(m=!0,g=a.gr.settings.repeatMergedValuesAcrossPages?v:C.firstVisibleRow===i?v:"",_=a.getRangeHeight(i,Math.min(C.bottomRow,o.bottomRow)),w=a.getRangeWidth(s,s)):w=a.getRangeWidth(s,s);else{m=!0,g=a.gr.settings.repeatMergedValuesAcrossPages?v:s===C.leftCol?v:"",_=a.getRangeHeight(i,i),w=a.getRangeWidth(Math.max(u.leftCol,C.leftCol),Math.min(u.rightCol,C.rightCol)),y=Math.min(u.rightCol,C.rightCol);for(var x=s+1;x<=y;x++)h[x]+=_-a._borderWidth}else p.setRange(i,s,i,s),m=!0,g=v,_=a.getRangeHeight(i,i),w=a.getRangeWidth(s,s);m&&(d.renderCell(g,t,b,p,new e.Rect(l,h[s],w,_)),n&&n()),_&&(h[s]+=_-a._borderWidth),w&&(l+=w-a._borderWidth),y&&(s=y)}}})}},r.prototype.isRenderableRow=function(e){return this._gr.isRenderableRow(e)},r}(function(){function t(e,t){this._panel=e,this._range=t.clone()}return Object.defineProperty(t.prototype,"visibleRows",{get:function(){var e=this;return null==this._visibleRows&&(this._visibleRows=0,this._range.forEach(this._panel,function(t){e.isRenderableRow(t)&&e._visibleRows++})),this._visibleRows},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"visibleColumns",{get:function(){if(null==this._visibleColumns&&(this._visibleColumns=0,this._range.isValid))for(var e=this._range.leftCol;e<=this._range.rightCol;e++)this._panel.columns[e].isVisible&&this._visibleColumns++;return this._visibleColumns},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){if(null==this._size){var t=this._range.getRenderSize(this._panel);this._size=new e.Size(e.pdf.pxToPt(t.width),e.pdf.pxToPt(t.height))}return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"range",{get:function(){return this._range},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"panel",{get:function(){return this._panel},enumerable:!0,configurable:!0}),t.prototype.isRenderableRow=function(e){return e.isVisible},t}()),i=function(){function r(e,t,r){this._pr=e,this._area=t,this._borderWidth=r}return r.prototype.renderCell=function(r,o,n,i,l){var s,a=this._pr.gr.flex,u=this._pr.panel,c=function(){return a.getCell(u,i.topRow,i.leftCol)},f=null,p=this._pr.gr.getCellStyle(u,o,n),d=this._pr.gr.settings.customCellContent;if(d){var h=a.getComputedStyle(f=c());p.color=h.color,p.backgroundColor=h.backgroundColor,p.borderColor=h.borderColor||h.borderRightColor||h.borderBottomColor||h.borderLeftColor||h.borderTopColor,p.font=new e.pdf.PdfFont(h.fontFamily,e.pdf._asPt(h.fontSize,!0,void 0),h.fontStyle,h.fontWeight),p.textAlign=h.textAlign}if(p.font&&!(p.font instanceof e.pdf.PdfFont)){var g=p.font;p.font=new e.pdf.PdfFont(g.family,g.size,g.style,g.weight)}if(p.boxSizing="border-box",p.borderWidth=this._borderWidth,p.borderStyle="solid",d||this._pr.gr.isExpandableGroupRow(o)&&u.columns.firstVisibleIndex===n.visibleIndex||(p.textAlign=n.getAlignment()),u.cellType===t._CellType.Cell&&a.rows.maxGroupLevel>=0&&i.leftCol===a.columns.firstVisibleIndex){var b=a.isGroupRow(o)?Math.max(o.level,0):a.rows.maxGroupLevel+1,_=e.pdf._asPt(p.paddingLeft||p.padding),w=e.pdf.pxToPt(b*a.treeIndent);p.paddingLeft=_+w}var m,y=this._measureCell(r,u,o,n,p,l),C=i.rowSpan>1&&i.visibleRowsCount>1&&this._pr.gr.alignMergedTextToTheTopRow(u);C&&(m=new e.Rect(y.contentRect.left,y.contentRect.top,y.contentRect.width,y.contentRect.height/(i.visibleRowsCount||1)),y.textRect=this._calculateTextRect(r,u,o,n,m,p)),e.isFunction(this._pr.gr.settings.formatItem)&&((s=new t.PdfFormatItemEventArgs(u,i,f,this._area,y.rect,y.contentRect,y.textRect.top,p,function(){return f||c()})).data=r,this._pr.gr.settings.formatItem(s),s.data!==r&&(r=e.asString(s.data),y.textRect=this._calculateTextRect(r,u,o,n,C?m:y.contentRect,p))),this._renderCell(r,o,n,i,y,p,!s||!s.cancel,!s||!s.cancelBorders)},r.prototype._renderCell=function(e,t,r,o,n,i,l,s){(l||s)&&(this._isBooleanCellAndValue(e,this._pr.panel,t,r)?this._renderBooleanCell(e,n,i,l,s):this._renderTextCell(e,n,i,l,s))},r.prototype._isBooleanCellAndValue=function(e,t,r,o){return this._pr.gr.isBooleanCell(t,r,o)&&this._isBoolean(e)},r.prototype._isBoolean=function(t){var r=e.isString(t)&&t.toLowerCase();return"true"===r||"false"===r||!0===t||!1===t},r.prototype._measureCell=function(t,r,o,n,i,l){this._decompositeStyle(i);var s=l.left,a=l.top,u=l.height,c=l.width,f=this._parseBorder(i),p=f.left.width,d=f.top.width,h=f.bottom.width,g=f.right.width,b=this._parsePadding(i),_=0,w=0,m=0,y=0;if("content-box"===i.boxSizing||void 0===i.boxSizing)_=b.top+u+b.bottom,w=b.left+c+b.right,m=u,y=c;else{if("border-box"!==i.boxSizing)throw"Invalid value: "+i.boxSizing;e.pdf._IE&&i instanceof CSSStyleDeclaration?(_=b.top+b.bottom+u,w=b.left+b.right+c):(_=u-d-h,w=c-p-g),m=_-b.top-b.bottom,y=w-b.left-b.right}l=new e.Rect(s,a,c,u);var C=new e.Rect(s+p,a+d,w,_),v=new e.Rect(s+p+b.left,a+d+b.top,y,m);return{rect:l,clientRect:C,contentRect:v,textRect:this._calculateTextRect(t,r,o,n,v,i)}},r.prototype._decompositeStyle=function(e){var t;e&&((t=e.borderColor)&&(e.borderLeftColor||(e.borderLeftColor=t),e.borderRightColor||(e.borderRightColor=t),e.borderTopColor||(e.borderTopColor=t),e.borderBottomColor||(e.borderBottomColor=t)),(t=e.borderWidth)&&(e.borderLeftWidth||(e.borderLeftWidth=t),e.borderRightWidth||(e.borderRightWidth=t),e.borderTopWidth||(e.borderTopWidth=t),e.borderBottomWidth||(e.borderBottomWidth=t)),(t=e.borderStyle)&&(e.borderLeftStyle||(e.borderLeftStyle=t),e.borderRightStyle||(e.borderRightStyle=t),e.borderTopStyle||(e.borderTopStyle=t),e.borderBottomStyle||(e.borderBottomStyle=t)),(t=e.padding)&&(e.paddingLeft||(e.paddingLeft=t),e.paddingRight||(e.paddingRight=t),e.paddingTop||(e.paddingTop=t),e.paddingBottom||(e.paddingBottom=t)))},r.prototype._parseBorder=function(t){var r={left:{width:0},top:{width:0},bottom:{width:0},right:{width:0}};return"none"!==t.borderLeftStyle&&(r.left={width:e.pdf._asPt(t.borderLeftWidth),style:t.borderLeftStyle,color:t.borderLeftColor}),"none"!==t.borderTopStyle&&(r.top={width:e.pdf._asPt(t.borderTopWidth),style:t.borderTopStyle,color:t.borderTopColor}),"none"!==t.borderBottomStyle&&(r.bottom={width:e.pdf._asPt(t.borderBottomWidth),style:t.borderBottomStyle,color:t.borderBottomColor}),"none"!==t.borderRightStyle&&(r.right={width:e.pdf._asPt(t.borderRightWidth),style:t.borderRightStyle,color:t.borderRightColor}),r},r.prototype._parsePadding=function(t){return{left:e.pdf._asPt(t.paddingLeft),top:e.pdf._asPt(t.paddingTop),bottom:e.pdf._asPt(t.paddingBottom),right:e.pdf._asPt(t.paddingRight)}},r.prototype._renderEmptyCell=function(t,r,o,n){var i=t.rect.left,l=t.rect.top,s=t.clientRect.width,a=t.clientRect.height,u=t.clientRect.left-t.rect.left,c=t.clientRect.top-t.rect.top,f=t.rect.top+t.rect.height-(t.clientRect.top+t.clientRect.height),p=t.rect.left+t.rect.width-(t.clientRect.left+t.clientRect.width);if(n&&(u||p||f||c)){var d=r.borderLeftColor||r.borderColor,h=r.borderRightColor||r.borderColor,g=r.borderTopColor||r.borderColor,b=r.borderBottomColor||r.borderColor;if(u&&c&&f&&p&&u===p&&u===f&&u===c&&d===h&&d===b&&d===g){var _=u,w=_/2;this._area.paths.rect(i+w,l+w,s+_,a+_).stroke(new e.pdf.PdfPen(d,_))}else u&&this._area.paths.polygon([[i,l],[i+u,l+c],[i+u,l+c+a],[i,l+c+a+f]]).fill(d),c&&this._area.paths.polygon([[i,l],[i+u,l+c],[i+u+s,l+c],[i+u+s+p,l]]).fill(g),p&&this._area.paths.polygon([[i+u+s+p,l],[i+u+s,l+c],[i+u+s,l+c+a],[i+u+s+p,l+c+a+f]]).fill(h),f&&this._area.paths.polygon([[i,l+c+a+f],[i+u,l+c+a],[i+u+s,l+c+a],[i+u+s+p,l+c+a+f]]).fill(b)}o&&r.backgroundColor&&s>0&&a>0&&this._area.paths.rect(i+u,l+c,s,a).fill(r.backgroundColor)},r.prototype._renderBooleanCell=function(t,r,o,n,i){if(this._renderEmptyCell(r,o,n,i),n){var l=r.textRect.left,s=r.textRect.top,a=r.textRect.height;if(this._area.paths.rect(l,s,a,a).fillAndStroke(e.Color.fromRgba(255,255,255),new e.pdf.PdfPen(void 0,.5)),!0===e.changeType(t,e.DataType.Boolean,"")){var u=a/20,c=a-.5-2*u,f=a/8;this._area.document.saveState(),this._area.translate(l+.25+u,s+.25+u).paths.moveTo(f/2,.6*c).lineTo(c-.6*c,c-f).lineTo(c-f/2,f/2).stroke(new e.pdf.PdfPen(void 0,f)),this._area.document.restoreState()}}},r.prototype._renderTextCell=function(t,r,o,n,i){this._renderEmptyCell(r,o,n,i),n&&t&&this._area.drawText(t,r.textRect.left,r.textRect.top,{brush:o.color,font:o.font,height:r.textRect.height,width:r.textRect.width,align:"center"===o.textAlign?e.pdf.PdfTextHorizontalAlign.Center:"right"===o.textAlign?e.pdf.PdfTextHorizontalAlign.Right:"justify"===o.textAlign?e.pdf.PdfTextHorizontalAlign.Justify:e.pdf.PdfTextHorizontalAlign.Left})},r.prototype._calculateTextRect=function(e,t,r,o,n,i){var l=n.clone();if(this._isBooleanCellAndValue(e,t,r,o)){var s=this._getTextLineHeight(i.font);switch(i.verticalAlign){case"middle":l.top=n.top+n.height/2-s/2;break;case"bottom":l.top=n.top+n.height-s}switch(i.textAlign){case"justify":case"center":l.left=n.left+n.width/2-s/2;break;case"right":l.left=n.left+n.width-s}l.height=l.width=s}else if(l.height>0&&l.width>0){switch(i.verticalAlign){case"bottom":(a=this._area.measureText(e,i.font,{height:l.height,width:l.width})).size.height<l.height&&(l.top+=l.height-a.size.height,l.height=a.size.height);break;case"middle":var a;(a=this._area.measureText(e,i.font,{height:l.height,width:l.width})).size.height<l.height&&(l.top+=l.height/2-a.size.height/2,l.height=a.size.height)}o.wordWrap||(l.height=this._getTextLineHeight(i.font))}return l},r.prototype._getTextLineHeight=function(e){return this._area.lineHeight(e)},r}(),l=function(){function e(e){this._columns={},this._flex=e}return e.prototype.getMergedRange=function(e,t,r){var o=this._columns[r];if(o&&t>=o.topRow&&t<=o.bottomRow)return o;var n=this._flex.getMergedRange(e,t,r);return this._columns[r]=n?new s(e,n):null},e}(),s=function(){function t(e,t,r,o,n){if("number"==typeof t?(this._row=t,this._col=r,this._row2=o,this._col2=n):(this._row=t.row,this._col=t.col,this._row2=t.row2,this._col2=t.col2),this.firstVisibleRow=-1,this.visibleRowsCount=0,e){var i=this.topRow,l=this.bottomRow,s=e.rows.length;if(s>0)for(var a=i;a<=l&&a<s;a++)e.rows[a].isVisible&&(this.firstVisibleRow<0&&(this.firstVisibleRow=a),this.visibleRowsCount++)}}return Object.defineProperty(t.prototype,"row",{get:function(){return this._row},set:function(e){this._row=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"col",{get:function(){return this._col},set:function(e){this._col=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"row2",{get:function(){return this._row2},set:function(e){this._row2=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"col2",{get:function(){return this._col2},set:function(e){this._col2=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"topRow",{get:function(){return Math.min(this._row,this._row2)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottomRow",{get:function(){return Math.max(this._row,this._row2)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"leftCol",{get:function(){return Math.min(this._col,this._col2)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rightCol",{get:function(){return Math.max(this._col,this._col2)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rowSpan",{get:function(){return Math.abs(this._row2-this._row)+1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isValid",{get:function(){return this._row>-1&&this._col>-1&&this._row2>-1&&this._col2>-1},enumerable:!0,configurable:!0}),t.prototype.copyFrom=function(e){this.setRange(e.row,e.col,e.row2,e.col2),this.firstVisibleRow=e.firstVisibleRow,this.visibleRowsCount=e.visibleRowsCount},t.prototype.clone=function(){return new t(null,this._row,this._col,this._row2,this._col2)},t.prototype.getRenderSize=function(t){var r=new e.Size(0,0);if(this.isValid){for(var o=this.topRow;o<=this.bottomRow;o++)r.height+=t.rows[o].renderHeight;for(var n=this.leftCol;n<=this.rightCol;n++)r.width+=t.columns[n].renderWidth}return r},t.prototype.setRange=function(t,r,o,n){void 0===t&&(t=-1),void 0===r&&(r=-1),void 0===o&&(o=t),void 0===n&&(n=r),this._row=e.asInt(t),this._col=e.asInt(r),this._row2=e.asInt(o),this._col2=e.asInt(n)},t}();t._CellRange=s;var a=function(){function t(e){this._ranges=e||[]}return t.prototype.length=function(){for(var e=0,t=0;t<this._ranges.length;t++){var r=this._ranges[t];r.isValid&&(e+=r.bottomRow-r.topRow+1)}return e},Object.defineProperty(t.prototype,"isValid",{get:function(){return this._ranges.length&&this._ranges[0].isValid},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"leftCol",{get:function(){return this._ranges.length?this._ranges[0].leftCol:-1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rightCol",{get:function(){return this._ranges.length?this._ranges[0].rightCol:-1},enumerable:!0,configurable:!0}),t.prototype.clone=function(e,r){for(var o=[],n=0;n<this._ranges.length;n++){var i=this._ranges[n].clone();arguments.length>0&&(i.col=e),arguments.length>1&&(i.col2=r),o.push(i)}return new t(o)},t.prototype.getRenderSize=function(t){for(var r=new e.Size(0,0),o=0;o<this._ranges.length;o++){var n=this._ranges[o].getRenderSize(t);r.width=Math.max(r.width,n.width),r.height+=n.height}return r},t.prototype.forEach=function(e,t){for(var r=0,o=0;o<this._ranges.length;o++){var n=this._ranges[o];if(n.isValid)for(var i=n.topRow;i<=n.bottomRow;i++)t(e.rows[i],n,i,r++)}},t.prototype.subrange=function(e,r,o,n){var i=[];if(e>=0&&r>0)for(var l=0,a=0,u=0;u<this._ranges.length&&r>0;u++,l=a+1){var c=this._ranges[u];if(!(e>(a=l+(c.bottomRow-c.topRow)))){var f=e>l?c.topRow+(e-l):c.topRow,p=Math.min(c.bottomRow,f+r-1),d=arguments.length>2?o:c.leftCol,h=arguments.length>2?n:c.rightCol;i.push(new s(null,f,d,p,h)),r-=p-f+1}}return new t(i)},t}(),u=function(){function e(e,t,r){this._col=t,this._row=r,this._range=e}return Object.defineProperty(e.prototype,"range",{get:function(){return this._range},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageCol",{get:function(){return this._col},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageRow",{get:function(){return this._row},enumerable:!0,configurable:!0}),e}()})((t=e.grid||(e.grid={})).pdf||(t.pdf={}))}(wijmo||(wijmo={})),function(e){var t;(function(t){"use strict";var r;function o(){return r||(r=document.createElement("div"),t.softGrid()&&r.setAttribute(t.softGrid().FlexGrid._WJS_MEASURE,"true"),document&&document.body&&document.body.appendChild(r)),r.className="",r.innerHTML="",r.style.cssText="",r.style.visibility="hidden",r}function n(){r&&(e.removeChild(r),r=null)}t._removeFakeCell=n;var i=function(){function r(){}return r.draw=function(e,t,r,o,n){this.drawToPosition(e,t,null,r,o,n)},r.drawToPosition=function(r,o,i,l,s,a){e.assert(!!r,"The flex argument cannot be null."),e.assert(!!o,"The doc argument cannot be null.");var u=t.softGrid()&&r instanceof t.softGrid().FlexGrid;try{a=t._FlexGridPdfCoreConverter._applyDefaultDrawSettings(a);var c=r;u&&(a&&a.recalculateStarWidths&&r.columns._updateStarSizes(e.pdf.ptToPx(o.width)),c=this._getFlexGridAdapter(r,a)),t._FlexGridPdfCoreConverter.draw(c,o,i,l,s,a)}finally{n(),u&&a&&a.recalculateStarWidths&&r.invalidate(!0)}},r.export=function(t,r,o){e.assert(!!t,"The flex argument cannot be null."),e.assert(!!r,"The fileName argument cannot be empty.");var n=(o=this._applyDefaultExportSettings(o)).documentOptions.ended;o.documentOptions.ended=function(t,l){o.progress&&o.progress(1),n&&!1===n.apply(i,[t,l])||e.pdf.saveBlob(l.blob,r),t.dispose()};var i=new e.pdf.PdfDocument(o.documentOptions);this.drawToPosition(t,i,null,null,null,o),i.end()},r._getFlexGridAdapter=function(e,r){return new(t.softMultiRow()&&e instanceof t.softMultiRow().MultiRow&&a||t.softSheet()&&e instanceof t.softSheet().FlexSheet&&s||t.softOlap()&&e instanceof t.softOlap().PivotGrid&&u||l)(e,r)},r._applyDefaultExportSettings=function(e){return t._merge(t._merge({},e),this._DefaultExportSettings)},r._DefaultExportSettings=t._merge({scaleMode:t.ScaleMode.PageWidth,documentOptions:{compress:!1,pageSettings:{margins:{left:36,right:36,top:18,bottom:18}}},_progressMax:.9},t._FlexGridPdfCoreConverter.DefaultDrawSettings),r}();t.FlexGridPdfConverter=i;var l=function(){function r(e,t){this._flex=e,this._settings=t}return Object.defineProperty(r.prototype,"flex",{get:function(){return this._flex},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"settings",{get:function(){return this._settings},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"columns",{get:function(){return this._flex.columns},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"rows",{get:function(){return this._flex.rows},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"bottomLeftCells",{get:function(){return this._flex.bottomLeftCells},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"cells",{get:function(){return this._flex.cells},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"columnFooters",{get:function(){return this._flex.columnFooters},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"columnHeaders",{get:function(){return this._flex.columnHeaders},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"rowHeaders",{get:function(){return this._flex.rowHeaders},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"topLeftCells",{get:function(){return this._flex.topLeftCells},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"treeIndent",{get:function(){return this._flex.treeIndent},enumerable:!0,configurable:!0}),r.prototype.getSelection=function(){var e=[],r=this._flex.selection,o=t.softGrid();switch(this._flex.selectionMode){case o.SelectionMode.None:break;case o.SelectionMode.Cell:case o.SelectionMode.CellRange:e.push(r);break;case o.SelectionMode.Row:e.push(new o.CellRange(r.topRow,0,r.topRow,this._flex.cells.columns.length-1));break;case o.SelectionMode.RowRange:e.push(new o.CellRange(r.topRow,0,r.bottomRow,this._flex.cells.columns.length-1));break;case o.SelectionMode.ListBox:for(var n=-1,i=0;i<this._flex.rows.length;i++)this._flex.rows[i].isSelected?(n<0&&(n=i),i===this._flex.rows.length-1&&e.push(new o.CellRange(n,0,i,this._flex.cells.columns.length-1))):(n>=0&&e.push(new o.CellRange(n,0,i-1,this._flex.cells.columns.length-1)),n=-1)}return e},r.prototype.getCell=function(e,t,r){var n=e.getCellElement(t,r);return n||(n=o(),this._flex.cellFactory.updateCell(e,t,r,n)),n},r.prototype.getComputedStyle=function(e){return e.className=e.className.replace("wj-state-selected",""),e.className=e.className.replace("wj-state-multi-selected",""),window.getComputedStyle(e)},r.prototype.getMergedRange=function(e,t,r){return this._flex.getMergedRange(e,t,r,!1)},Object.defineProperty(r.prototype,"showColumnHeader",{get:function(){return!!(this._flex.headersVisibility&t.softGrid().HeadersVisibility.Column)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"showRowHeader",{get:function(){return!!(this._flex.headersVisibility&t.softGrid().HeadersVisibility.Row)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"showColumnFooter",{get:function(){return this._flex.columnFooters.rows.length>0},enumerable:!0,configurable:!0}),r.prototype.alignMergedTextToTheTopRow=function(e){return!1},r.prototype.getCellData=function(e,t,r){return e.getCellData(r,t,!0)},r.prototype.getCellContent=function(e,r,n,i){var l,s=this.getCellData(e,i,r.index),a=n.isContentHtml,u=t.softGrid();if(!s&&e.cellType===u.CellType.Cell){var c=r;c instanceof u.GroupRow&&c.dataItem&&c.dataItem.groupDescription&&n.index===e.columns.firstVisibleIndex&&(a=!0,s=c.getGroupHeader())}return this.settings.customCellContent?!(s=(l=this.getCell(e,r.index,i)).textContent.trim())&&this.isBooleanCell(e,r,n)&&(s=null==(s=this._extractCheckboxValue(l))?"":s+""):a&&((l=o()).innerHTML=s,s=l.textContent.trim()),s},r.prototype.isBooleanCell=function(r,o,n){return n.dataType===e.DataType.Boolean&&r.cellType===t.softGrid().CellType.Cell&&(!this.isExpandableGroupRow(o)||n.visibleIndex!==r.columns.firstVisibleIndex)},r.prototype.getColumn=function(e,t,r){return e.columns[r]},r.prototype.isAlternatingRow=function(e){return e.index%2!=0},r.prototype.isGroupRow=function(e){return e instanceof t.softGrid().GroupRow},r.prototype.isNewRow=function(e){return e instanceof t.softGrid()._NewRowTemplate},r.prototype.isDetailRow=function(e){return t.softDetail()&&e instanceof t.softDetail().DetailRow},r.prototype.isExpandableGroupRow=function(e){return e instanceof t.softGrid().GroupRow&&e.hasChildren},r.prototype.getCellStyle=function(e,r,o){var n=this.settings.styles,i=t._merge({},n.cellStyle),l=this._flex,s=t.softGrid();switch(e.cellType){case s.CellType.Cell:this.isExpandableGroupRow(r)?t._merge(i,n.groupCellStyle,!0):this.isAlternatingRow(r)&&t._merge(i,n.altCellStyle,!0);break;case s.CellType.ColumnHeader:case s.CellType.RowHeader:case s.CellType.TopLeft:case s.CellType.BottomLeft:t._merge(i,n.headerCellStyle,!0);break;case s.CellType.ColumnFooter:t._merge(i,n.headerCellStyle,!0),t._merge(i,n.footerCellStyle,!0)}return!this.settings.customCellContent&&l._getShowErrors()&&l._getError(e,r.index,o.index)&&t._merge(i,n.errorCellStyle,!0),i},r.prototype._extractCheckboxValue=function(e){var t=e.querySelector("input[type=checkbox]");if(t&&"none"!==window.getComputedStyle(t).display&&"hidden"!==t.style.visibility)return t.checked},r}(),s=function(r){function o(){return null!==r&&r.apply(this,arguments)||this}return __extends(o,r),o.prototype.getCellData=function(e,o,n){return e.cellType===t.softGrid().CellType.Cell?e.rows[n]instanceof t.softSheet().HeaderRow?this.flex.columnHeaders.getCellData(n,o,!0):this.flex.getCellValue(n,o,!0):r.prototype.getCellData.call(this,e,o,n)},o.prototype.getCellStyle=function(o,n,i){var l=r.prototype.getCellStyle.call(this,o,n,i),s=this.flex.selectedSheet.findTable(n.index,i.index);if(s){var a=s.getRange(),u=n.index-a.topRow,c=i.index-a.leftCol,f=s._getTableCellAppliedStyles(u,c);f&&(f.font=new e.pdf.PdfFont(f.fontFamily,e.pdf._asPt(f.fontSize,!0,void 0),f.fontStyle,f.fontWeight)),t._merge(l,f,!0)}return l},Object.defineProperty(o.prototype,"showColumnHeader",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"showRowHeader",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"showColumnFooter",{get:function(){return!1},enumerable:!0,configurable:!0}),o}(l),a=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return __extends(r,e),r.prototype.getColumn=function(e,t,r){return this.flex.getBindingColumn(e,t,r)},r.prototype.isAlternatingRow=function(r){return r instanceof t.softMultiRow()._MultiRow?r.dataIndex%2!=0:e.prototype.isAlternatingRow.call(this,r)},r}(l),u=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return __extends(r,e),r.prototype.alignMergedTextToTheTopRow=function(e){var r=t.softGrid();return!this.flex.centerHeadersVertically&&(e.cellType===r.CellType.ColumnHeader||e.cellType===r.CellType.RowHeader)},r}(l)})((t=e.grid||(e.grid={})).pdf||(t.pdf={}))}(wijmo||(wijmo={})),function(e){var t;(function(t){"use strict";var r;!function(e){e[e.Done=1]="Done",e[e.Progress=2]="Progress"}(r||(r={}));var o=function(e){function t(t){var r=e.call(this)||this;return r._buf=t,r}return __extends(t,e),Object.defineProperty(t.prototype,"blob",{get:function(){return this._blob||(this._blob=new Blob([new Uint8Array(this._buf)],{type:"application/pdf"})),this._blob},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"buffer",{get:function(){return this._buf},enumerable:!0,configurable:!0}),t}(e.EventArgs);t.PdfWebWorkerExportDoneEventArgs=o;var n=function(){function n(){}return n.exportGrid=function(r,o,n,i,l,s){(i=t._merge({},i)).progress=i.progress||s,this.addGrid(r,o,"",i),this.export(r,i.documentOptions,function(t){e.isFunction(l)&&!1===l(t)||e.pdf.saveBlob(t.blob,n)},s)},n.export=function(t,n,i,l){t.addEventListener("message",function n(s){var a=s.data;switch(a.status){case r.Done:t.removeEventListener("message",n),e.isFunction(i)&&i(new o(a.data));break;case r.Progress:l&&l(a.data);break;default:throw"Unknown status: "+a.status}});var s=this._clientDataToArrayBuffer(t);t.postMessage({content:s,settings:n},[s]),this._clearClientData(t)},n.addGrid=function(e,t,r,o){var n=this._gridToJson(t,o);this._addClientData(e,JSON.stringify(n),r,o,!0)},n.addImage=function(t,r,o,n){var i=e.isString(r)&&r.indexOf("data:image/svg")>=0?r:e.pdf._PdfImageHelper.getDataUri(r);this._addClientData(t,i,o,n)},n.addString=function(e,t,r){this._addClientData(e,t,r,null)},n.serializeGrid=function(e,t){var r=this._gridToJson(e,t);return u(JSON.stringify(r))},n._addClientData=function(t,r,o,n,i){void 0===i&&(i=!1),e.asType(t,Worker),e.asString(o),e.asString(r,!0);var l=t;l.clientData=l.clientData||{},l.clientData[o]={content:r,settings:n?JSON.stringify(n):null};var s=l.clientData[o];i&&(s.isGrid=!0,s.progressMessaging=e.isFunction(n.progress))},n._clearClientData=function(e){delete e.clientData},n._clientDataToArrayBuffer=function(e){var t=e;return u(JSON.stringify(t.clientData||{}))},n._gridToJson=function(r,o){var n;o=t.FlexGridPdfConverter._applyDefaultExportSettings(o);try{n=new e.pdf.PdfDocument(o.documentOptions),o&&o.recalculateStarWidths&&r.columns._updateStarSizes(e.pdf.ptToPx(n.width));var i=this._getJsonConverter(r,o).convert();return u(JSON.stringify(i)),i}finally{t._removeFakeCell(),o&&o.recalculateStarWidths&&r.invalidate(!0),null!=n&&(n.dispose(),n=null)}},n._getJsonConverter=function(e,r){return new(t.softMultiRow()&&e instanceof t.softMultiRow().MultiRow&&f||t.softOlap()&&e instanceof t.softOlap().PivotGrid&&p||c)(e,t.FlexGridPdfConverter._getFlexGridAdapter(e,r))},n}();t.PdfWebWorkerClient=n;var i,l,s=function(){function o(){}return o.initExportGrid=function(){var e=this;this.initExport(function(r,o){var n=o[""];n.progressMessaging&&(n.settings._progressMax=t.FlexGridPdfConverter._DefaultExportSettings._progressMax,n.settings.progress=function(t){e.sendExportProgress(t)},r.ended.addHandler(function(){e.sendExportProgress(1)})),t.FlexGridPdfConverter.draw(n.content,r,null,null,n.settings),r.end()})},o.initExport=function(t){self.addEventListener("message",function n(i){self.removeEventListener("message",n);var l=i.data,s=JSON.parse(a(l.content)),u=l.settings||{};u.ended=function(t,o){!function(t,r){e.asFunction(r);var o=new FileReader;o.onload=function(e){r(e.target.result)},o.readAsArrayBuffer(t)}(o.blob,function(e){self.postMessage({data:e,status:r.Done},[e])})};var c=new e.pdf.PdfDocument(u);Object.keys(s).forEach(function(e){var t=s[e];t.settings&&(t.settings=JSON.parse(t.settings)),t.isGrid&&(t.settings&&o._disableUnsupportedFeatures(t.settings),t.content=o._deserializeGridFromString(t.content,t.settings))}),t(c,s)})},o.sendExportProgress=function(t){t=e.clamp(t,0,1),self.postMessage({data:t,status:r.Progress})},o.deserializeGrid=function(e,t){return this._deserializeGridFromString(a(e),t)},o._deserializeGridFromString=function(e,r){return this._getJsonAdapter(JSON.parse(e),t.FlexGridPdfConverter._applyDefaultExportSettings(r))},o._disableUnsupportedFeatures=function(e){e.customCellContent=!1},o._getJsonAdapter=function(e,t){switch(e.typeName){case"MultiRow":return new C(e,t);case"PivotGrid":return new m(e,t);default:return new w(e,t)}},o}();function a(e){for(var t=new Uint16Array(e),r="",o=0,n=t.length;o<n;o++)r+=String.fromCharCode(t[o]);return r}function u(e){for(var t=new ArrayBuffer(2*e.length),r=new Uint16Array(t),o=0,n=e.length;o<n;o++)r[o]=e.charCodeAt(o);return t}t.PdfWebWorker=s,function(e){e[e.None=0]="None",e[e.Alternate=1]="Alternate",e[e.Group=2]="Group",e[e.ExpandableGroup=4]="ExpandableGroup",e[e.New=8]="New",e[e.Visible=16]="Visible",e[e.Detail=32]="Detail"}(i||(i={})),function(e){e[e.None=0]="None",e[e.Visible=1]="Visible"}(l||(l={}));var c=function(){function e(e,t){this._flex=e,this._adapter=t}return e.prototype.convert=function(){var e={};return e.typeName=this._getTypeName(this._flex),e.selection=this._serializeSelection(),e.showColumnFooter=this.adapter.showColumnFooter,e.showColumnHeader=this.adapter.showColumnHeader,e.showRowHeader=this.adapter.showRowHeader,e.treeIndent=this._flex.treeIndent,e.bottomLeftCells=this._serializePanel(this._flex.bottomLeftCells),e.cells=this._serializePanel(this._flex.cells),e.columnFooters=this._serializePanel(this._flex.columnFooters),e.columnHeaders=this._serializePanel(this._flex.columnHeaders),e.rowHeaders=this._serializePanel(this._flex.rowHeaders),e.topLeftCells=this._serializePanel(this._flex.topLeftCells),e},Object.defineProperty(e.prototype,"adapter",{get:function(){return this._adapter},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"flex",{get:function(){return this._flex},enumerable:!0,configurable:!0}),e.prototype._getTypeName=function(e){return e.constructor.toString().match(/function\s*(\w+)/)[1]},e.prototype._getRowState=function(e){var r=i.None;return this.adapter.isAlternatingRow(e)&&(r|=i.Alternate),e instanceof t.softGrid().GroupRow&&(r|=i.Group),this.adapter.isDetailRow(e)&&(r|=i.Detail),this.adapter.isExpandableGroupRow(e)&&(r|=i.ExpandableGroup),e instanceof t.softGrid()._NewRowTemplate&&(r|=i.New),e.isVisible&&(r|=i.Visible),r},e.prototype._getColumnState=function(e){var t=l.None;return e.isVisible&&(t|=l.Visible),t},e.prototype._serializeSelection=function(){for(var e=this.adapter.getSelection(),t=[],r=0;r<e.length;r++){var o=e[r];t.push([o.row,o.col,o.row2,o.col2])}return t},e.prototype._serializeColumns=function(e){for(var t=[],r=0,o=(e||[]).length;r<o;r++){var n=e[r],i={aggregate:n.aggregate,alignment:n.getAlignment(),dataType:n.dataType,renderWidth:n.renderWidth,wordWrap:n.wordWrap,visibleIndex:n.visibleIndex},s=this._getColumnState(n);s!==l.None&&(i.state=s),t.push(i)}return t},e.prototype._serializePanel=function(e){var r={cellType:e.cellType,height:e.height,width:e.width};r.mergedRanges=this._serializeMergedRanges(e),r.columns=this._serializeColumns(e.columns),r.columnsFirstVisibleIndex=e.columns.firstVisibleIndex,r.rows=[],r.rowsMaxGroupLevel=e.rows.maxGroupLevel;for(var o=0,n=e.rows.length,l=e.columns.length;o<n;o++){var s=e.rows[o],a={renderHeight:s.renderHeight};r.rows.push(a),s instanceof t.softGrid().GroupRow&&(a.level=s.level);var u=this._getRowState(s);u!==i.None&&(a.state=u),a.cells=[];for(var c=0;c<l;c++)a.cells[c]=this._adapter.getCellContent(e,e.rows[o],e.columns[c],c)}return r},e.prototype._serializeMergedRanges=function(e){for(var t=[],r=[],o=0;o<e.columns.length;o++)r[o]=0;for(var n=0;n<e.rows.length;n++)for(var i=0;i<e.columns.length;i++)if(!(n<r[i])){var l=e.grid.getMergedRange(e,n,i);if(null!=l&&!l.isSingleCell){t.push([l.row,l.col,l.row2,l.col2]);for(var s=l.col;s<=l.col2;s++)r[s]=l.row2+1;l.col===l.col2||(i=l.col2)}}return t},e}(),f=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return __extends(r,e),r.prototype.convert=function(){var t=e.prototype.convert.call(this);return t.rowsPerItem=this.flex.rowsPerItem,t},r.prototype._serializePanel=function(t){var r=e.prototype._serializePanel.call(this,t);return r.cellGroups=this._serializeCellGroup(t),r},r.prototype._serializeCellGroup=function(e){var r=[],o=[],n=t.softGrid(),i=this.flex.rowsPerItem;e.cellType!==n.CellType.TopLeft&&e.cellType!==n.CellType.ColumnHeader||(i=e.rows.length);for(var l=0;l<i;l++){o[l]=[];for(var s=0;s<e.columns.length;s++){var a=this.flex.getBindingColumn(e,l,s),u=r.indexOf(a);o[l][s]=u<0?r.push(a)-1:u}}return{bindingColumns:this._serializeColumns(r),mappings:o}},r}(c),p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.convert=function(){var t=e.prototype.convert.call(this);return t.centerHeadersVertically=this.flex.centerHeadersVertically,t},t}(c),d=function(){function e(e,t){this._index=t,this._level=e.level,this._renderHeight=e.renderHeight,this._state=e.state,this._cells=e.cells}return Object.defineProperty(e.prototype,"cells",{get:function(){return this._cells},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"index",{get:function(){return this._index},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isAlternatingRow",{get:function(){return(this._state&i.Alternate)!==i.None},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isGroupRow",{get:function(){return(this._state&i.Group)!==i.None},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isDetailRow",{get:function(){return(this._state&i.Detail)!==i.None},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isExpandableGroupRow",{get:function(){return(this._state&i.ExpandableGroup)!==i.None},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isNewRow",{get:function(){return(this._state&i.New)!==i.None},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isVisible",{get:function(){return(this._state&i.Visible)!==i.None},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"level",{get:function(){return this._level},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"renderHeight",{get:function(){return this._renderHeight},enumerable:!0,configurable:!0}),e}(),h=function(){function e(e,t){this._aggregate=e.aggregate,this._alignment=e.alignment,this._dataType=e.dataType,this._index=t,this._renderWidth=e.renderWidth,this._state=e.state,this._visibleIndex=e.visibleIndex,this._wordWrap=e.wordWrap}return Object.defineProperty(e.prototype,"aggregate",{get:function(){return this._aggregate},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dataType",{get:function(){return this._dataType},enumerable:!0,configurable:!0}),e.prototype.getAlignment=function(){return this._alignment},Object.defineProperty(e.prototype,"index",{get:function(){return this._index},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isVisible",{get:function(){return(this._state&l.Visible)!==l.None},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"renderWidth",{get:function(){return this._renderWidth},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"visibleIndex",{get:function(){return this._visibleIndex},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"wordWrap",{get:function(){return this._wordWrap},enumerable:!0,configurable:!0}),e}(),g=function(){function e(e,t){void 0===t&&(t=-1),this._maxGroupLevel=t,this._length=e.length;for(var r=0;r<e.length;r++)this[r]=new d(e[r],r)}return Object.defineProperty(e.prototype,"length",{get:function(){return this._length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxGroupLevel",{get:function(){return this._maxGroupLevel},enumerable:!0,configurable:!0}),e}(),b=function(){function e(e,t){void 0===t&&(t=-1),this._firstVisibleIndex=t,this._length=e.length;for(var r=0;r<e.length;r++)this[r]=new h(e[r],r)}return Object.defineProperty(e.prototype,"length",{get:function(){return this._length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"firstVisibleIndex",{get:function(){return this._firstVisibleIndex},enumerable:!0,configurable:!0}),e}(),_=function(){function e(e){this._height=e.height,this._width=e.width,this._cellType=e.cellType,this._columns=new b(e.columns,e.columnsFirstVisibleIndex),this._rows=new g(e.rows,e.rowsMaxGroupLevel),this._mergedRanges=this._deserializeMergedRanges(e.mergedRanges)}return Object.defineProperty(e.prototype,"cellType",{get:function(){return this._cellType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"columns",{get:function(){return this._columns},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rows",{get:function(){return this._rows},enumerable:!0,configurable:!0}),e.prototype.getMergedRange=function(e,t){var r=this._mergedRanges[e];if(r)for(var o=0,n=r.length;o<n;o++){var i=r[o];if(t>=i.col&&t<=i.col2)return i}return null},e.prototype._deserializeMergedRanges=function(e){var r=[];e=e||[];for(var o=0,n=this._rows.length;o<n;o++)r[o]=[];for(o=0,n=e.length;o<n;o++)for(var i=e[o],l=new t._CellRange(null,i[0],i[1],i[2],i[3]),s=l.row;s<=l.row2;s++)r[s].push(l);return r},e}(),w=function(){function r(e,r){this._settings=r,this._bottomLeftCells=this.deserializePanel(e.bottomLeftCells),this._cells=this.deserializePanel(e.cells),this._columnFooters=this.deserializePanel(e.columnFooters),this._columnHeaders=this.deserializePanel(e.columnHeaders),this._rowHeaders=this.deserializePanel(e.rowHeaders),this._topLeftCells=this.deserializePanel(e.topLeftCells),this._treeIndent=e.treeIndent,this._showColumnFooter=e.showColumnFooter,this._showColumnHeader=e.showColumnHeader,this._showRowHeader=e.showRowHeader,this._selection=[];for(var o=0;o<e.selection.length;o++){var n=e.selection[o];this._selection.push(new t._CellRange(null,n[0],n[1],n[2],n[3]))}}return Object.defineProperty(r.prototype,"settings",{get:function(){return this._settings},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"columns",{get:function(){return this._cells.columns},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"rows",{get:function(){return this._cells.rows},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"bottomLeftCells",{get:function(){return this._bottomLeftCells},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"cells",{get:function(){return this._cells},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"columnFooters",{get:function(){return this._columnFooters},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"columnHeaders",{get:function(){return this._columnHeaders},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"rowHeaders",{get:function(){return this._rowHeaders},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"topLeftCells",{get:function(){return this._topLeftCells},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"treeIndent",{get:function(){return this._treeIndent},enumerable:!0,configurable:!0}),r.prototype.getSelection=function(){return this._selection},r.prototype.getCell=function(e,t,r){throw"Not implemented"},r.prototype.getComputedStyle=function(e){throw"Not implemented"},r.prototype.getMergedRange=function(e,t,r){return e.getMergedRange(t,r)},Object.defineProperty(r.prototype,"showColumnFooter",{get:function(){return this._showColumnFooter},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"showColumnHeader",{get:function(){return this._showColumnHeader},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"showRowHeader",{get:function(){return this._showRowHeader},enumerable:!0,configurable:!0}),r.prototype.alignMergedTextToTheTopRow=function(e){return!1},r.prototype.getCellData=function(e,t,r){return e.rows[r].cells[t]},r.prototype.getCellContent=function(e,t,r,o){return this.getCellData(e,o,t.index)},r.prototype.isBooleanCell=function(r,o,n){return n.dataType===e.DataType.Boolean&&r.cellType===t._CellType.Cell&&!this.isExpandableGroupRow(o)},r.prototype.getColumn=function(e,t,r){return e.columns[r]},r.prototype.isAlternatingRow=function(e){return e.isAlternatingRow},r.prototype.isGroupRow=function(e){return e.isGroupRow},r.prototype.isNewRow=function(e){return e.isNewRow},r.prototype.isDetailRow=function(e){return e.isDetailRow},r.prototype.isExpandableGroupRow=function(e){return e.isExpandableGroupRow},r.prototype.getCellStyle=function(e,r,o){var n=this.settings.styles,i=t._merge({},n.cellStyle);switch(e.cellType){case t._CellType.Cell:this.isExpandableGroupRow(r)?t._merge(i,n.groupCellStyle,!0):this.isAlternatingRow(r)&&t._merge(i,n.altCellStyle,!0);break;case t._CellType.ColumnHeader:case t._CellType.RowHeader:case t._CellType.TopLeft:case t._CellType.BottomLeft:t._merge(i,n.headerCellStyle,!0);break;case t._CellType.ColumnFooter:t._merge(i,n.headerCellStyle,!0),t._merge(i,n.footerCellStyle,!0)}return i},r.prototype.deserializePanel=function(e){return new _(e)},r}(),m=function(e){function r(t,r){var o=e.call(this,t,r)||this;return o._centerHeadersVertically=t.centerHeadersVertically,o}return __extends(r,e),r.prototype.alignMergedTextToTheTopRow=function(e){return!this._centerHeadersVertically&&(e.cellType===t._CellType.ColumnHeader||e.cellType===t._CellType.RowHeader)},r}(w),y=function(e){function r(t){var r=e.call(this,t)||this;return t.cellGroups&&(r._cellGroups={bindingColumns:new b(t.cellGroups.bindingColumns),mappings:t.cellGroups.mappings}),r}return __extends(r,e),r.prototype.getColumn=function(e,r,o){return this._cellGroups?(this.cellType!==t._CellType.ColumnHeader&&this.cellType!==t._CellType.BottomLeft&&(e%=o),this._cellGroups.bindingColumns[this._cellGroups.mappings[e][r]]):this.columns[r]},r}(_),C=function(e){function t(t,r){var o=e.call(this,t,r)||this;return o._rowsPerItem=t.rowsPerItem,o}return __extends(t,e),t.prototype.deserializePanel=function(e){return new y(e)},t.prototype.getColumn=function(e,t,r){return e.getColumn(t,r,this._rowsPerItem)},t}(w)})((t=e.grid||(e.grid={})).pdf||(t.pdf={}))}(wijmo||(wijmo={})),function(e){!function(t){t.pdf||(t.pdf={}),e._registerModule("wijmo.grid.pdf",e.grid.pdf)}(e.grid||(e.grid={}))}(wijmo||(wijmo={}));