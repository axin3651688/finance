/*!
    *
    * Wijmo Library 5.20191.603
    * http://wijmo.com/
    *
    * Copyright(c) GrapeCity, Inc.  All rights reserved.
    *
    * Licensed under the GrapeCity Commercial License.
    * sales@wijmo.com
    * wijmo.com/products/wijmo-5/license/
    *
    */

var __extends=this&&this.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function o(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}();import{WjBinding,WjContext,MetaFactory}from"wijmo/wijmo.knockout.base";import*as mKo from"knockout";import*as wjcGrid from"wijmo/wijmo.grid";var wjKo=mKo,wjFlexGrid=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype._getControlConstructor=function(){return wjcGrid.FlexGrid},e.prototype._createWijmoContext=function(){return new WjFlexGridContext(this)},e.prototype._initialize=function(){t.prototype._initialize.call(this),MetaFactory.findProp("itemFormatter",this._metaData.props).updateControl=this._formatterPropHandler},e.prototype._formatterPropHandler=function(t,e,r,o,n){return o!==t._userFormatter&&(t._userFormatter=o,r.invalidate()),!0},e._columnTemplateProp="_wjkoColumnTemplate",e._cellClonedTemplateProp="__wjkoClonedTempl",e._cellVMProp="__wjkoCellVM",e._templColIdx="_wjkoTemplColIdx",e._columnStyleBinding="wjStyle",e._columnStyleProp="__wjkoStyle",e}(WjBinding);export{wjFlexGrid};var WjFlexGridContext=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._wrapperFormatter=e._itemFormatter.bind(e),e}return __extends(e,t),e.prototype._initControl=function(){t.prototype._initControl.call(this),this.control.itemFormatter=this._wrapperFormatter},e.prototype._itemFormatter=function(t,e,r,o){var n=t.columns[r],i=n[wjFlexGrid._columnTemplateProp],l=n[wjFlexGrid._columnStyleProp];if((i||l)&&t.cellType==wjcGrid.CellType.Cell){var a=t.grid.editRange;if(a&&a.row===e&&a.col===r)return;if(t.rows[e]instanceof wjcGrid.GroupRow)return;var u=o[wjFlexGrid._cellVMProp],p=o[wjFlexGrid._cellClonedTemplateProp],c=t.rows[e].dataItem;if(u&&o[wjFlexGrid._templColIdx]!=r&&(o[wjFlexGrid._cellVMProp]=o[wjFlexGrid._cellClonedTemplateProp]=o[wjFlexGrid._templColIdx]=u=p=null,wjKo.cleanNode(o)),u)p&&(o.innerHTML="",o.appendChild(p)),u.$row(e),u.$col(r),u.$item()!=c?u.$item(c):u.$item.valueHasMutated();else{u={$row:wjKo.observable(e),$col:wjKo.observable(r),$item:wjKo.observable(c)};var d=this.bindingContext.extend(u);if(i){o.innerHTML="<div>"+i+"</div>";var s=o.childNodes[0];o[wjFlexGrid._cellClonedTemplateProp]=s}else o.setAttribute("data-bind","style:"+l);o[wjFlexGrid._cellVMProp]=u,o[wjFlexGrid._templColIdx]=r,wjKo.applyBindings(d,o)}var m=o.scrollHeight;t.rows[e].renderHeight<m&&(t.rows.defaultSize=m)}else this._userFormatter&&this._userFormatter(t,e,r,o)},e}(WjContext);export{WjFlexGridContext};var wjFlexGridColumn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype._getControlConstructor=function(){return wjcGrid.Column},e.prototype._createControl=function(t){return new wjcGrid.Column},e.prototype._createWijmoContext=function(){return new WjFlexGridColumnContext(this)},e}(WjBinding);export{wjFlexGridColumn};var WjFlexGridColumnContext=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype._initControl=function(){var e=this.parentWjContext;if(e){var r=e.control;r.autoGenerateColumns&&(r.autoGenerateColumns=!1,r.columns.clear())}t.prototype._initControl.call(this);var o=this.element.innerHTML.trim();this.control[wjFlexGrid._columnTemplateProp]=o;var n=this.allBindings.get(wjFlexGrid._columnStyleBinding);n&&(this.control[wjFlexGrid._columnStyleProp]=n.trim()),(o||n)&&this.control._setFlag(wjcGrid.RowColFlags.HasTemplate,!0),this.element.innerHTML=""},e}(WjContext);export{WjFlexGridColumnContext};var wjStyle=function(){function t(){this.preprocess=function(e,r,o){return t.quoteString(e)},this.init=function(){}}return t.quoteString=function(t){return null==t?t:"'"+t.replace(/'/g,"\\'")+"'"},t.unquoteString=function(t){return!t||t.length<2?t:("'"===t.charAt(0)&&(t=t.substr(1,t.length-1)),t.replace(/\\\'/g,"'"))},t}();export{wjStyle};wjKo.bindingHandlers[wjFlexGrid._columnStyleBinding]=new wjStyle,wjKo.bindingHandlers.wjFlexGrid=new wjFlexGrid,wjKo.bindingHandlers.wjFlexGridColumn=new wjFlexGridColumn;