/*!
    *
    * Wijmo Library 5.20191.603
    * http://wijmo.com/
    *
    * Copyright(c) GrapeCity, Inc.  All rights reserved.
    *
    * Licensed under the GrapeCity Commercial License.
    * sales@wijmo.com
    * wijmo.com/products/wijmo-5/license/
    *
    */

var __extends=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function s(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(s.prototype=i.prototype,new s)}}();import{Rect,asInt,Size,asNumber,Point,asArray,assert,asString,asEnum,isNumber,isDate,asDate,Globalize,asType,addClass,asBoolean,isObject,_registerModule}from"wijmo/wijmo";import{SeriesBase,ChartType,_DataPoint,_DataInfo,_LinesArea,_CircleArea,_BasePlotter,LabelPosition,DataPoint,FlexChartCore}from"wijmo/wijmo.chart";import{_minimum,_maximum,_avgTrueRng,_range,_stdDeviation,_sma,_average,_ema,_sum}from"wijmo/wijmo.chart.finance";import*as selfModule from"wijmo/wijmo.chart.finance.analytics";function isValid(t){return isFinite(t)&&!isNaN(t)&&isNumber(t)}var Fibonacci=function(t){function e(e){var i=t.call(this)||this;return i._levels=[0,23.6,38.2,50,61.8,100],i._uptrend=!0,i._labelPosition=LabelPosition.Left,i.rendering.addHandler(i._render),i.initialize(e),i}return __extends(e,t),Object.defineProperty(e.prototype,"low",{get:function(){return this._low},set:function(t){t!=this._low&&(this._low=asNumber(t,!0),this._invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"high",{get:function(){return this._high},set:function(t){t!=this._high&&(this._high=asNumber(t,!0),this._invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"labelPosition",{get:function(){return this._labelPosition},set:function(t){(t=asEnum(t,LabelPosition,!0))!=this._labelPosition&&(this._labelPosition=t,this._invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"uptrend",{get:function(){return this._uptrend},set:function(t){t!=this._uptrend&&(this._uptrend=asBoolean(t,!0),this._invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"levels",{get:function(){return this._levels},set:function(t){t!=this._levels&&(this._levels=asArray(t,!0),this._invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"minX",{get:function(){return this._minX},set:function(t){t!=this._minX&&(this._minX=t,this._invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxX",{get:function(){return this._maxX},set:function(t){t!=this._maxX&&(this._maxX=t,this._invalidate())},enumerable:!0,configurable:!0}),e.prototype._getMinX=function(){return isNumber(this._minX)?this._minX:isDate(this._minX)?asDate(this._minX).valueOf():this._getAxisX().actualMin},e.prototype._getMaxX=function(){return isNumber(this._maxX)?this._maxX:isDate(this._maxX)?asDate(this._maxX).valueOf():this._getAxisX().actualMax},e.prototype._updateLevels=function(){var e=void 0,i=void 0;if(void 0===this._low||void 0===this._high){var s=t.prototype.getValues.call(this,0),a=t.prototype.getValues.call(this,1);if(s)for(var n=s.length,l=this._getMinX(),r=this._getMaxX(),o=0;o<n;o++){var h=s[o],_=a?a[o]:o;_<l||_>r||(isNaN(h)||((void 0===e||e>h)&&(e=h),(void 0===i||i<h)&&(i=h)))}}void 0===this._low&&void 0!==e?this._actualLow=e:this._actualLow=this._low,void 0===this._high&&void 0!==i?this._actualHigh=i:this._actualHigh=this._high},e.prototype._render=function(t,e){e.cancel=!0;var i=t;i._updateLevels();var s=i._getAxisX(),a=i._getAxisY(),n=e.engine,l=i._getSymbolStroke(i._chart.series.indexOf(i)),r=_BasePlotter.cloneStyle(i.style,["fill"]),o=_BasePlotter.cloneStyle(i.style,["stroke"]),h=i.chart._plotrectId;n.stroke=l,n.strokeWidth=2,n.textFill=l;var _=i._getMinX(),u=i._getMaxX();_<s.actualMin&&(_=s.actualMin),u>s.actualMax&&(u=s.actualMax),n.startGroup(null,h);for(var c=i._levels?i._levels.length:0,p=0;p<c;p++){var d=i._levels[p],g=s.convert(_),f=s.convert(u),y=i.uptrend?a.convert(i._actualLow+.01*d*(i._actualHigh-i._actualLow)):a.convert(i._actualHigh-.01*d*(i._actualHigh-i._actualLow));if(_DataInfo.isValid(g)&&_DataInfo.isValid(f)&&_DataInfo.isValid(y)&&(n.drawLine(g,y,f,y,null,r),i.labelPosition!=LabelPosition.None)){var m=d.toFixed(1)+"%",v=0;switch((i.uptrend&&0==p||!i.uptrend&&p==c-1)&&(v=2),i.labelPosition){case LabelPosition.Left:FlexChartCore._renderText(n,m,new Point(g,y),0,v,null,null,o);break;case LabelPosition.Center:FlexChartCore._renderText(n,m,new Point(.5*(g+f),y),1,v,null,null,o);break;case LabelPosition.Right:FlexChartCore._renderText(n,m,new Point(f,y),2,v,null,null,o)}}}n.stroke=null,n.strokeWidth=null,n.textFill=null,n.endGroup()},e.prototype._getChartType=function(){return ChartType.Line},e}(SeriesBase);export{Fibonacci};var FibonacciArcs=function(t){function e(e){var i=t.call(this)||this;return i._levels=[38.2,50,61.8],i._labelPosition=LabelPosition.Top,i.rendering.addHandler(i._render,i),i.initialize(e),i}return __extends(e,t),Object.defineProperty(e.prototype,"start",{get:function(){return this._start},set:function(t){t!==this.start&&(this._start=asType(t,DataPoint),this._invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"end",{get:function(){return this._end},set:function(t){t!==this.end&&(this._end=asType(t,DataPoint),this._invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"levels",{get:function(){return this._levels},set:function(t){t!==this._levels&&(this._levels=asArray(t,!1),this._invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"labelPosition",{get:function(){return this._labelPosition},set:function(t){(t=asEnum(t,LabelPosition))!==this.labelPosition&&(this._labelPosition=t,this._invalidate())},enumerable:!0,configurable:!0}),e.prototype._render=function(e,i){i.cancel=!0;var s=this._getX(0),a=this._getY(0),n=this._getX(1),l=this._getY(1);if(!(t.prototype._getLength.call(this)<=1)&&isValid(s)&&isValid(a)&&isValid(n)&&isValid(l)){var r,o=this._getAxisX(),h=this._getAxisY(),_=i.engine,u=this.chart.series.indexOf(this),c=this._getSymbolStroke(u),p=_BasePlotter.cloneStyle(this.style,["fill"]),d=_BasePlotter.cloneStyle(this.style,["stroke"]);_.stroke=c,_.strokeWidth=2,_.textFill=c;var g,f,y,m,v,V,b,x,P,w=this.chart._plotrectId,k=l-a;r=_.startGroup(null,w),addClass(r,"fibonacci-arcs"),isValid(s)&&isValid(a)&&isValid(n)&&isValid(l)&&_.drawLines([o.convert(s),o.convert(n)],[h.convert(a),h.convert(l)],null,p),m=Math.sqrt(Math.pow(o.convert(n)-o.convert(s),2)+Math.pow(h.convert(l)-h.convert(a),2)),V=new Point(n,l);for(var L=0;L<this.levels.length;L++)if(b=.01*this.levels[L],v=Math.abs(m*b),isValid(V.x)&&isValid(V.y)&&isValid(v)&&(g=o.convert(V.x),f=h.convert(V.y),_.drawDonutSegment(g,f,v,v,k>0?0:Math.PI,Math.PI,null,p),this.labelPosition!==LabelPosition.None&&0!==b)){switch(P=Globalize.format(b,"p1"),x=_.measureString(P,null,null,d),y=k<=0?f-v:f+v,this.labelPosition){case LabelPosition.Center:y+=.5*x.height;break;case LabelPosition.Bottom:y+=k<=0?x.height:0;break;default:y+=k<=0?0:x.height}_.drawString(P,new Point(g-.5*x.width,y),null,d)}_.stroke=null,_.strokeWidth=null,_.textFill=null,_.endGroup()}},e.prototype._getX=function(t){var e=null;return 0===t&&this.start?e=this.start.x:1===t&&this.end&&(e=this.end.x),isDate(e)&&(e=asDate(e).valueOf()),e},e.prototype._getY=function(t){var e=null;return 0===t&&this.start?e=this.start.y:1===t&&this.end&&(e=this.end.y),e},e.prototype._getChartType=function(){return ChartType.Line},e}(SeriesBase);export{FibonacciArcs};var FibonacciFans=function(t){function e(e){var i=t.call(this)||this;return i._levels=[0,23.6,38.2,50,61.8,100],i._labelPosition=LabelPosition.Top,i.rendering.addHandler(i._render,i),i.initialize(e),i}return __extends(e,t),Object.defineProperty(e.prototype,"start",{get:function(){return this._start},set:function(t){t!==this.start&&(this._start=asType(t,DataPoint),this._invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"end",{get:function(){return this._end},set:function(t){t!==this.end&&(this._end=asType(t,DataPoint),this._invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"levels",{get:function(){return this._levels},set:function(t){t!==this._levels&&(this._levels=asArray(t,!1),this._invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"labelPosition",{get:function(){return this._labelPosition},set:function(t){(t=asEnum(t,LabelPosition))!==this.labelPosition&&(this._labelPosition=t,this._invalidate())},enumerable:!0,configurable:!0}),e.prototype._updateLevels=function(){if(!this.start||!this.end){var e,i,s,a,n=this.chart._getPlotter(this),l=this._getAxisX(),r=t.prototype.getValues.call(this,0),o=t.prototype.getValues.call(this,1)||n.dataInfo.getXVals();r&&r.length>0&&(s=_minimum(r),a=_maximum(r)),o&&o.length>0?(e=_minimum(o),i=_maximum(o)):(e=l.actualMin,i=l.actualMax),isValid(e)&&isValid(s)&&isValid(i)&&isValid(a)&&(this.start=new DataPoint(e,s),this.end=new DataPoint(i,a))}},e.prototype._render=function(e,i){i.cancel=!0,this._updateLevels();var s=this._getX(0),a=this._getY(0),n=this._getX(1),l=this._getY(1);if(!(t.prototype._getLength.call(this)<=1)&&isValid(s)&&isValid(a)&&isValid(n)&&isValid(l)){var r=this._getAxisX(),o=this._getAxisY(),h=this.chart.series.indexOf(this),_=i.engine,u=this._getSymbolStroke(h),c=_BasePlotter.cloneStyle(this.style,["fill"]),p=_BasePlotter.cloneStyle(this.style,["stroke"]);_.stroke=u,_.strokeWidth=2,_.textFill=u;var d,g,f,y,m,v,V,b,x,P,w,k,L,X=l-a,M=n-s,B=this.chart._plotrectId;d=s,f=a,y=l;var I=g=n;_.startGroup(null,B);for(var C=0;C<this.levels.length;C++)if(g=M<0?r.actualMin:r.actualMax,y=(b=((y=f+(P=.01*this.levels[C])*X)-f)/(I-d))*g+(x=y-b*I),X>0&&y>o.actualMax?g=((y=o.actualMax)-x)/b:X<0&&y<o.actualMin&&(g=((y=o.actualMin)-x)/b),isValid(d)&&isValid(f)&&isValid(g)&&isValid(y)&&(m=new Point(r.convert(d),o.convert(f)),v=new Point(r.convert(g),o.convert(y)),_.drawLines([m.x,v.x],[m.y,v.y],null,c),this.labelPosition!=LabelPosition.None)){w=Globalize.format(P,"p1"),k=_.measureString(w,null,null,p),L=180*Math.atan((v.y-m.y)/(v.x-m.x))/Math.PI,V=v.clone(),v.x=M>0?v.x-k.width:v.x;var O,D=L*Math.PI/180,S=new Point,A=new Point,T=new Point,Y=new Point,j=o.convert(o.actualMin),W=o.convert(o.actualMax),N=r.convert(r.actualMin),R=r.convert(r.actualMax),z=V.clone();switch(this.labelPosition){case LabelPosition.Center:v.y+=.5*k.height,z.y+=.5*k.height;break;case LabelPosition.Bottom:v.y+=k.height}M>0?(this.labelPosition===LabelPosition.Top||this.labelPosition===LabelPosition.Center?(Y=z.clone(),T.x=Y.x+k.height*Math.sin(D),T.y=Y.y-k.height*Math.cos(D),S.x=Y.x-k.width*Math.cos(D)+k.height*Math.sin(D),S.y=Y.y-k.width*Math.sin(D)-k.height*Math.cos(D),A.x=Y.x-k.width*Math.cos(D),A.y=Y.y-k.width*Math.sin(D)):this.labelPosition===LabelPosition.Bottom&&(T=z.clone(),S.x=T.x-k.width*Math.cos(D),S.y=T.y-k.width*Math.sin(D),A.x=S.x-k.height*Math.sin(D),A.y=S.y+k.height*Math.cos(D),Y.x=S.x+k.width*Math.cos(D)-k.height*Math.sin(D),Y.y=S.y+k.width*Math.sin(D)+k.height*Math.cos(D)),X>0?(T.y<W&&(b=(o.convertBack(T.y)-o.convertBack(S.y))/(r.convertBack(T.x)-r.convertBack(S.x)),x=o.convertBack(T.y)-b*r.convertBack(T.x),O=r.convert((o.actualMax-x)/b),v.x-=Math.abs(T.x-O)),Y.x>R&&(v.x-=Math.abs(R-Y.x))):X<0&&(Y.y>j&&(b=(o.convertBack(A.y)-o.convertBack(Y.y))/(r.convertBack(A.x)-r.convertBack(Y.x)),x=o.convertBack(Y.y)-b*r.convertBack(Y.x),O=r.convert((o.actualMin-x)/b),v.x-=Math.max(Math.abs(O-Y.x),Math.abs(j-Y.y))),T.x>R&&(v.x-=Math.abs(R-T.x)))):M<0&&(this.labelPosition===LabelPosition.Top||this.labelPosition===LabelPosition.Center?(A=z.clone(),S.x=A.x+k.height*Math.sin(D),S.y=A.y-k.height*Math.cos(D),Y.x=A.x+k.width*Math.cos(D),Y.y=A.y+k.width*Math.sin(D),T.x=S.x+k.width*Math.cos(D),T.y=S.y+k.width*Math.sin(D)):this.labelPosition===LabelPosition.Bottom&&(S=z.clone(),T.x=S.x+k.width*Math.cos(D),T.y=S.y+k.width*Math.sin(D),A.x=S.x-k.height*Math.sin(D),A.y=S.y+k.height*Math.cos(D),Y.x=S.x+k.width*Math.cos(D)-k.height*Math.sin(D),Y.y=S.y+k.width*Math.sin(D)+k.height*Math.cos(D)),X>0?(S.y<W&&(b=(o.convertBack(S.y)-o.convertBack(T.y))/(r.convertBack(S.x)-r.convertBack(T.x)),x=o.convertBack(S.y)-b*r.convertBack(S.x),O=r.convert((o.actualMax-x)/b),v.x+=Math.abs(S.x-O)),A.x<N&&(v.x+=Math.abs(N-A.x))):X<0&&(A.y>j&&(b=(o.convertBack(Y.y)-o.convertBack(A.y))/(r.convertBack(Y.x)-r.convertBack(A.x)),x=o.convertBack(A.y)-b*r.convertBack(A.x),O=r.convert((o.actualMin-x)/b),v.x+=Math.max(Math.abs(O-A.x),Math.abs(j-A.y))),S.x<N&&(v.x+=Math.abs(N-S.x)))),0===L?_.drawString(w,v,null,p):_.drawStringRotated(w,v,V,L,null,p)}_.stroke=null,_.strokeWidth=null,_.textFill=null,_.endGroup()}},e.prototype._getX=function(t){var e=null;return 0===t&&this.start?e=this.start.x:1===t&&this.end&&(e=this.end.x),isDate(e)&&(e=asDate(e).valueOf()),e},e.prototype._getY=function(t){var e=null;return 0===t&&this.start?e=this.start.y:1===t&&this.end&&(e=this.end.y),e},e.prototype._getChartType=function(){return ChartType.Line},e}(SeriesBase);export{FibonacciFans};var FibonacciTimeZones=function(t){function e(e){var i=t.call(this)||this;return i._levels=[0,1,2,3,5,8,13,21,34],i._labelPosition=LabelPosition.Right,i.rendering.addHandler(i._render,i),i.initialize(e),i}return __extends(e,t),Object.defineProperty(e.prototype,"startX",{get:function(){return this._startX},set:function(t){t!==this.startX&&(isDate(t)?this._startX=asDate(t):this._startX=asNumber(t),this._invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"endX",{get:function(){return this._endX},set:function(t){t!==this.endX&&(isDate(t)?this._endX=asDate(t):this._endX=asNumber(t),this._invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"levels",{get:function(){return this._levels},set:function(t){t!==this._levels&&(this._levels=asArray(t,!1),this._invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"labelPosition",{get:function(){return this._labelPosition},set:function(t){(t=asEnum(t,LabelPosition))!==this.labelPosition&&(this._labelPosition=t,this._invalidate())},enumerable:!0,configurable:!0}),e.prototype._render=function(e,i){i.cancel=!0,this._updateLevels();var s=this._getX(0),a=this._getX(1);if(!(t.prototype._getLength.call(this)<=1)&&isValid(s)&&isValid(a)){var n,l,r,o,h=a-s,_=this._getAxisX(),u=this._getAxisY(),c=this._chart.series.indexOf(this),p=i.engine,d=this._getSymbolStroke(c),g=_BasePlotter.cloneStyle(this.style,["fill"]),f=_BasePlotter.cloneStyle(this.style,["stroke"]),y=u.convert(u.actualMin),m=u.convert(u.actualMax),v=this.chart._plotrectId;if(p.stroke=d,p.strokeWidth=2,p.textFill=d,0!==h){p.startGroup(null,v);for(var V=0;V<this.levels.length;V++)if(!((l=h*(n=this.levels[V])+s)<_.actualMin||_.actualMax<l)&&isValid(l)&&(l=_.convert(l),p.drawLine(l,y,l,m,null,g),this.labelPosition!==LabelPosition.None)){switch(o=Globalize.format(n,"n0"),r=p.measureString(o,null,null,f),this.labelPosition){case LabelPosition.Left:l-=r.width+2;break;case LabelPosition.Center:l-=r.width/2;break;case LabelPosition.Right:l+=2;break;default:l=h<0?l-r.width-2:l+2}p.drawString(o,new Point(l,y),null,f)}p.stroke=null,p.strokeWidth=null,p.textFill=null,p.endGroup()}}},e.prototype._updateLevels=function(){var e=this.chart._getPlotter(this),i=t.prototype.getValues.call(this,1)||e.dataInfo.getXVals();if(!(t.prototype._getLength.call(this)<=1)){var s=this._getX(0),a=this._getX(1),n=isNumber(s)&&isNumber(a);n||i?!n&&i&&(this._startX=i[0],this._endX=i[1]):(this._startX=0,this._endX=1)}},e.prototype._getX=function(t){var e=null;return 0===t?e=this.startX:1===t&&(e=this.endX),isDate(e)&&(e=asDate(e).valueOf()),e},e.prototype._getChartType=function(){return ChartType.Line},e}(SeriesBase);export{FibonacciTimeZones};var OverlayIndicatorBase=function(t){function e(e){var i=t.call(this,e)||this;return i._seriesCount=1,i}return __extends(e,t),Object.defineProperty(e.prototype,"_hitTester",{get:function(){return this._plotter&&!this.__hitTester&&(this.__hitTester=this._plotter.hitTester),this.__hitTester},enumerable:!0,configurable:!0}),e.prototype._getChartType=function(){return ChartType.Line},e.prototype._getXValues=function(){return t.prototype.getValues.call(this,1)||this._plotter.dataInfo.getXVals()},e.prototype._getDataPoint=function(t,e,i,s,a,n){var l=new _DataPoint(i,s,t,e);return l.y=e,l.yfmt=n._formatValue(e),l.x=t,l.xfmt=a._formatValue(t),l},e.prototype._shouldCalculate=function(){return!0},e.prototype._init=function(){},e.prototype._calculate=function(){},e.prototype._clearValues=function(){t.prototype._clearValues.call(this),this.__hitTester=null},e.prototype._getName=function(t){var e=void 0;if(this.name)if(this.name.indexOf(",")){var i=this.name.split(",");i&&i.length-1>=t&&(e=i[t].trim())}else e=this.name;return e},e.prototype._getStyles=function(t){var e=null;if(t<0||null===this._styles)return e;var i=0;for(var s in this._styles){if(i===t&&this._styles.hasOwnProperty(s)){e=this._styles[s];break}i++}return e},e.prototype.legendItemLength=function(){return this._seriesCount},e.prototype.measureLegendItem=function(t,e){var i=this._getName(e),s=new Size(0,0);return i&&(s=this._measureLegendItem(t,this._getName(e))),s},e.prototype.drawLegendItem=function(t,e,i){var s=this._getStyles(i)||this.style;this._getName(i)&&this._drawLegendItem(t,e,this._getChartType(),this._getName(i),s,this.symbolStyle)},e}(SeriesBase);export{OverlayIndicatorBase};var SingleOverlayIndicatorBase=function(t){function e(e){var i=t.call(this,e)||this;return i._period=14,i}return __extends(e,t),Object.defineProperty(e.prototype,"period",{get:function(){return this._period},set:function(t){t!==this._period&&(this._period=asInt(t,!1,!0),this._clearValues(),this._invalidate())},enumerable:!0,configurable:!0}),e.prototype.getValues=function(e){var i=null;return t.prototype._getLength.call(this)<=0?i:(this._shouldCalculate()&&(this._init(),this._calculate()),0===e?i=this._yvals:1===e&&(i=this._xvals),i)},e.prototype.getDataRect=function(e,i){if(i)return i;var s=null;if(t.prototype._getLength.call(this)<=0)return s;this._shouldCalculate()&&(this._init(),this._calculate());var a=_minimum(this._xvals),n=_maximum(this._xvals),l=_minimum(this._yvals),r=_maximum(this._yvals);return _DataInfo.isValid(a)&&_DataInfo.isValid(n)&&_DataInfo.isValid(l)&&_DataInfo.isValid(r)&&(s=new Rect(a,l,n-a,r-l)),s},e.prototype._clearValues=function(){t.prototype._clearValues.call(this),this._xvals=null,this._yvals=null},e.prototype._shouldCalculate=function(){return!this._yvals||!this._xvals},e.prototype._init=function(){t.prototype._init.call(this),this._yvals=[],this._xvals=[]},e.prototype._getItem=function(e){return t.prototype._getLength.call(this)<=0?t.prototype._getItem.call(this,e):(this._shouldCalculate()&&(this._init(),this._calculate()),e=t.prototype._getLength.call(this)-_minimum(this._yvals.length,this._xvals.length)+e,t.prototype._getItem.call(this,e))},e}(OverlayIndicatorBase);export{SingleOverlayIndicatorBase};var WilliamsR=function(t){function e(e){var i=t.call(this)||this;return i.period=14,i.initialize(e),i}return __extends(e,t),e.prototype._calculate=function(){var e=t.prototype._getLength.call(this);if(!(e<=0)){var i=t.prototype._getBindingValues.call(this,0),s=t.prototype._getBindingValues.call(this,1),a=t.prototype._getBindingValues.call(this,3),n=this._getXValues();this._yvals=_williamsR(i,s,a,this.period),this._xvals=n?n.slice(this.period-1):_range(this.period-1,e-1)}},e}(SingleOverlayIndicatorBase);export{WilliamsR};export function _williamsR(t,e,i,s){asArray(t,!1),asArray(e,!1),asArray(i,!1),asInt(s,!1,!0);var a,n=_minimum(t.length,e.length,i.length),l=[],r=[],o=[];for(assert(n>s&&s>1,"Williams %R period must be an integer less than the length of the data and greater than one."),a=s;a<=t.length;a++)l.push(_maximum(t.slice(a-s,a))),r.push(_minimum(e.slice(a-s,a)));for(i.splice(0,s-1),a=0;a<l.length;a++)o.push((l[a]-i[a])/(l[a]-r[a])*-100);return o};var Stochastic=function(t){function e(e){var i=t.call(this)||this;return i._kPeriod=14,i._dPeriod=3,i._smoothingPeriod=1,i._seriesCount=2,i.rendering.addHandler(i._rendering,i),i.initialize(e),i}return __extends(e,t),Object.defineProperty(e.prototype,"kPeriod",{get:function(){return this._kPeriod},set:function(t){t!==this._kPeriod&&(this._kPeriod=asInt(t,!1,!0),this._clearValues(),this._invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dPeriod",{get:function(){return this._dPeriod},set:function(t){t!==this._dPeriod&&(this._dPeriod=asInt(t,!1,!0),this._clearValues(),this._invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"smoothingPeriod",{get:function(){return this._smoothingPeriod},set:function(t){t!==this._smoothingPeriod&&(this._smoothingPeriod=asInt(t,!1,!0),this._clearValues(),this._invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"styles",{get:function(){return this._styles},set:function(t){t!==this._styles&&(this._styles=t,this._invalidate())},enumerable:!0,configurable:!0}),e.prototype.getDataRect=function(e,i){if(i)return i;var s=null;if(t.prototype._getLength.call(this)<=0)return s;this._shouldCalculate()&&(this._init(),this._calculate());var a=this._kVals.concat(this._dVals),n=this._kXVals.concat(this._dXVals),l=_minimum(n),r=_maximum(n),o=_minimum(a),h=_maximum(a);return _DataInfo.isValid(l)&&_DataInfo.isValid(r)&&_DataInfo.isValid(o)&&_DataInfo.isValid(h)&&(s=new Rect(l,o,r-l,h-o)),s},e.prototype._clearValues=function(){t.prototype._clearValues.call(this),this._kVals=null,this._kXVals=null,this._dVals=null,this._dXVals=null},e.prototype._shouldCalculate=function(){return!(this._kVals&&this._kXVals&&this._dVals&&this._dXVals)},e.prototype._init=function(){t.prototype._init.call(this),this._kVals=[],this._kXVals=[],this._dVals=[],this._dXVals=[]},e.prototype._calculate=function(){var e=t.prototype._getLength.call(this);if(!(t.prototype._getLength.call(this)<=0)){var i=t.prototype._getBindingValues.call(this,0),s=t.prototype._getBindingValues.call(this,1),a=t.prototype._getBindingValues.call(this,3),n=this._getXValues(),l=_stochastic(i,s,a,this.kPeriod,this.dPeriod,this.smoothingPeriod);this._kVals=l.ks,this._dVals=l.ds,this._kXVals=n?n.slice(this.kPeriod-1):_range(this.kPeriod-1,e-1),this.smoothingPeriod&&this.smoothingPeriod>1&&(this._kXVals=this._kXVals.slice(this._kXVals.length-this._kVals.length,this._kXVals.length)),this._dXVals=this._kXVals.slice(this._kXVals.length-this._dVals.length,this._kXVals.length)}},e.prototype._rendering=function(e,i){if(i.cancel=!0,!(t.prototype._getLength.call(this)<=0)){this._shouldCalculate()&&(this._init(),this._calculate());var s=this.chart.series.indexOf(this),a=i.engine,n=this._getAxisX(),l=this._getAxisY(),r=_BasePlotter.cloneStyle(this.style,["fill"]),o=this._getSymbolStroke(s),h=this.chart._plotrectId,_=null,u=o,c=2,p=null,d=o,g=2;this.styles&&isObject(this.styles)&&(this.styles.kLine&&isObject(this.styles.kLine)&&(u=(_=_BasePlotter.cloneStyle(this.styles.kLine,["fill"])).stroke?_.stroke:o,c=_.strokeWidth?_.strokeWidth:2),this.styles.dLine&&isObject(this.styles.dLine)&&(d=(p=_BasePlotter.cloneStyle(this.styles.dLine,["fill"])).stroke?p.stroke:o,g=p.strokeWidth?p.strokeWidth:2));var f,y,m,v,V=[],b=[],x=[],P=[],w=this._getLength();for(m=0;m<this._kVals.length;m++)v=w-this._kVals.length+m,b.push(n.convert(this._kXVals[m])),V.push(l.convert(this._kVals[m])),(f=this._getDataPoint(this._kXVals[m],this._kVals[m],s,v,n,l)).name=this._getName(0),(y=new _CircleArea(new Point(b[m],V[m]),.5*a.strokeWidth)).tag=f,this._hitTester.add(y,s);for(this._hitTester.add(new _LinesArea(b,V),s),a.stroke=u,a.strokeWidth=c,a.drawLines(b,V,null,r,h),m=0;m<this._dVals.length;m++)v=w-this._dVals.length+m,P.push(n.convert(this._dXVals[m])),x.push(l.convert(this._dVals[m])),(f=this._getDataPoint(this._dXVals[m],this._dVals[m],s,v,n,l)).name=this._getName(1),(y=new _CircleArea(new Point(P[m],x[m]),.5*a.strokeWidth)).tag=f,this._hitTester.add(y,s);this._hitTester.add(new _LinesArea(P,x),s),a.stroke=d,a.strokeWidth=g,a.drawLines(P,x,null,r,h)}},e.prototype.getCalculatedValues=function(e){e=asString(e,!1);var i=[],s=0;if(t.prototype._getLength.call(this)<=0)return i;switch(this._shouldCalculate()&&(this._init(),this._calculate()),e){case"kLine":for(;s<this._kVals.length;s++)i.push({x:this._kXVals[s],y:this._kVals[s]});break;case"dLine":for(;s<this._dVals.length;s++)i.push({x:this._dXVals[s],y:this._dVals[s]})}return i},e}(OverlayIndicatorBase);export{Stochastic};export function _stochastic(t,e,i,s,a,n){asArray(t,!1),asArray(e,!1),asArray(i,!1),asInt(s,!1,!0),asInt(a,!1,!0),asInt(n,!0,!0);var l,r=[],o=[],h=[];for(l=s;l<=t.length;l++)r.push(_maximum(t.slice(l-s,l))),o.push(_minimum(e.slice(l-s,l)));for(i=i.slice(s-1),l=0;l<i.length;l++)h.push((i[l]-o[l])/(r[l]-o[l])*100);return n&&n>1&&(h=_sma(h,n)),{ks:h,ds:_sma(h,a)}};var RSI=function(t){function e(e){var i=t.call(this)||this;return i.period=14,i.initialize(e),i}return __extends(e,t),e.prototype._calculate=function(){var e=t.prototype._getLength.call(this);if(!(e<=0)){var i=t.prototype._getBindingValues.call(this,0),s=this._getXValues();this._yvals=_rsi(i,this.period),this._xvals=s?s.slice(this.period):_range(this.period,e)}},e}(SingleOverlayIndicatorBase);export{RSI};export function _rsi(t,e){asArray(t,!1),asInt(e,!0,!1),assert(t.length>e&&e>1,"RSI period must be an integer less than the length of the data and greater than one.");var i,s,a,n,l=[],r=[],o=[],h=[];for(n=1;n<t.length;n++)l.push(t[n]-t[n-1]);for(i=l.map(function(t){return t>0?t:0}),s=l.map(function(t){return t<0?Math.abs(t):0}),n=e;n<=l.length;n++)n===e?(r.push(_sum(i.slice(n-e,n))/e),o.push(_sum(s.slice(n-e,n))/e)):(r.push((i[n-1]+r[n-e-1]*(e-1))/e),o.push((s[n-1]+o[n-e-1]*(e-1))/e)),a=r[n-e]/o[n-e],a=isFinite(a)?a:0,h.push(100-100/(1+a));return h};var MacdBase=function(t){function e(e){var i=t.call(this,e)||this;return i._fastPeriod=12,i._slowPeriod=26,i._smoothingPeriod=9,i}return __extends(e,t),Object.defineProperty(e.prototype,"fastPeriod",{get:function(){return this._fastPeriod},set:function(t){t!==this._fastPeriod&&(this._fastPeriod=asInt(t,!1,!0),this._clearValues(),this._invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"slowPeriod",{get:function(){return this._slowPeriod},set:function(t){t!==this._slowPeriod&&(this._slowPeriod=asInt(t,!1,!0),this._clearValues(),this._invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"smoothingPeriod",{get:function(){return this._smoothingPeriod},set:function(t){t!==this._smoothingPeriod&&(this._smoothingPeriod=asInt(t,!1,!0),this._clearValues(),this._invalidate())},enumerable:!0,configurable:!0}),e.prototype._clearValues=function(){t.prototype._clearValues.call(this),this._macdVals=null,this._macdXVals=null,this._signalVals=null,this._signalXVals=null,this._histogramVals=null,this._histogramXVals=null},e.prototype._shouldCalculate=function(){return!(this._macdVals&&this._macdXVals&&this._signalVals&&this._signalXVals&&this._histogramVals&&this._histogramXVals)},e.prototype._init=function(){t.prototype._init.call(this),this._macdVals=[],this._macdXVals=[],this._signalVals=[],this._signalXVals=[],this._histogramVals=[],this._histogramXVals=[]},e.prototype._calculate=function(){var e=t.prototype._getLength.call(this);if(!(e<=0)){var i=t.prototype.getValues.call(this,0),s=this._getXValues(),a=_macd(i,this.fastPeriod,this.slowPeriod,this.smoothingPeriod);this._macdVals=a.macds,this._signalVals=a.signals,this._histogramVals=a.histograms,this._macdXVals=s?s.slice(e-this._macdVals.length,e):_range(e-this._macdVals.length,e-1),this._signalXVals=s?s.slice(e-this._signalVals.length,e):_range(e-this._signalVals.length,e-1),this._histogramXVals=s?s.slice(e-this._histogramVals.length,e):_range(e-this._histogramVals.length,e-1)}},e}(OverlayIndicatorBase);export{MacdBase};var Macd=function(t){function e(e){var i=t.call(this)||this;return i._seriesCount=2,i.rendering.addHandler(i._rendering,i),i.initialize(e),i}return __extends(e,t),Object.defineProperty(e.prototype,"styles",{get:function(){return this._styles},set:function(t){t!==this._styles&&(this._styles=t,this._invalidate())},enumerable:!0,configurable:!0}),e.prototype.legendItemLength=function(){return this.name.indexOf(",")>-1?2:1},e.prototype.getDataRect=function(e,i){if(i)return i;var s=null;if(t.prototype._getLength.call(this)<=0)return s;this._shouldCalculate()&&(this._init(),this._calculate());var a=[],n=[];n.push.apply(n,this._macdXVals),n.push.apply(n,this._signalXVals),a.push.apply(a,this._macdVals),a.push.apply(a,this._signalVals);var l=_minimum(n),r=_maximum(n),o=_minimum(a),h=_maximum(a);return _DataInfo.isValid(l)&&_DataInfo.isValid(r)&&_DataInfo.isValid(o)&&_DataInfo.isValid(h)&&(s=new Rect(l,o,r-l,h-o)),s},e.prototype._rendering=function(e,i){if(i.cancel=!0,!(t.prototype._getLength.call(this)<=0)){this._shouldCalculate()&&(this._init(),this._calculate());var s=this.chart.series.indexOf(this),a=i.engine,n=this._getAxisX(),l=this._getAxisY(),r=_BasePlotter.cloneStyle(this.style,["fill"]),o=this._getSymbolStroke(s),h=this.chart._plotrectId,_=null,u=o,c=2,p=null,d=o,g=2;this.styles&&isObject(this.styles)&&(this.styles.macdLine&&isObject(this.styles.macdLine)&&(u=(_=_BasePlotter.cloneStyle(this.styles.macdLine,["fill"])).stroke?_.stroke:o,c=_.strokeWidth?_.strokeWidth:2),this.styles.signalLine&&isObject(this.styles.signalLine)&&(d=(p=_BasePlotter.cloneStyle(this.styles.signalLine,["fill"])).stroke?p.stroke:o,g=p.strokeWidth?p.strokeWidth:2));var f,y,m,v,V=[],b=[],x=[],P=[],w=this._getLength();for(m=0;m<this._macdVals.length;m++)v=w-this._macdVals.length+m,b.push(n.convert(this._macdXVals[m])),V.push(l.convert(this._macdVals[m])),(f=this._getDataPoint(this._macdXVals[m],this._macdVals[m],s,v,n,l)).name=this._getName(0),(y=new _CircleArea(new Point(b[m],V[m]),.5*a.strokeWidth)).tag=f,this._hitTester.add(y,s);for(this._hitTester.add(new _LinesArea(b,V),s),a.stroke=u,a.strokeWidth=c,a.drawLines(b,V,null,r,h),m=0;m<this._signalVals.length;m++)v=w-this._signalVals.length+m,P.push(n.convert(this._signalXVals[m])),x.push(l.convert(this._signalVals[m])),(f=this._getDataPoint(this._signalXVals[m],this._signalVals[m],s,v,n,l)).name=this._getName(1),(y=new _CircleArea(new Point(P[m],x[m]),.5*a.strokeWidth)).tag=f,this._hitTester.add(y,s);this._hitTester.add(new _LinesArea(P,x),s),a.stroke=d,a.strokeWidth=g,a.drawLines(P,x,null,r,h)}},e.prototype.getCalculatedValues=function(e){e=asString(e,!1);var i=[],s=0;if(t.prototype._getLength.call(this)<=0)return i;switch(this._shouldCalculate()&&(this._init(),this._calculate()),e){case"macdLine":for(;s<this._macdVals.length;s++)i.push({x:this._macdXVals[s],y:this._macdVals[s]});break;case"signalLine":for(;s<this._signalVals.length;s++)i.push({x:this._signalXVals[s],y:this._signalVals[s]})}return i},e}(MacdBase);export{Macd};var MacdHistogram=function(t){function e(e){return t.call(this,e)||this}return __extends(e,t),e.prototype.getValues=function(e){var i=null;return t.prototype._getLength.call(this)<=0?i:(this._shouldCalculate()&&(this._init(),this._calculate()),0===e?i=this._histogramVals:1===e&&(i=this._histogramXVals),i)},e.prototype.getDataRect=function(e,i){if(i)return i;var s=null;if(t.prototype._getLength.call(this)<=0)return s;this._shouldCalculate()&&(this._init(),this._calculate());var a=_minimum(this._histogramXVals),n=_maximum(this._histogramXVals),l=_minimum(this._histogramVals),r=_maximum(this._histogramVals);return _DataInfo.isValid(a)&&_DataInfo.isValid(n)&&_DataInfo.isValid(l)&&_DataInfo.isValid(r)&&(s=new Rect(a,l,n-a,r-l)),s},e.prototype._getChartType=function(){return ChartType.Column},e.prototype._getItem=function(e){return e=t.prototype._getLength.call(this)-_minimum(this._histogramVals.length,this._histogramXVals.length)+e,t.prototype._getItem.call(this,e)},e}(MacdBase);export{MacdHistogram};export function _macd(t,e,i,s){asArray(t,!1),asInt(e,!1,!0),asInt(i,!1,!0),asInt(s,!1,!0);var a,n=e>i;n&&(a=i,i=e,e=a);var l,r,o=_ema(t,e),h=_ema(t,i),_=[],u=[];for(o.splice(0,i-e),r=0;r<o.length;r++)a=o[r]-h[r],n&&(a*=-1),_.push(a);l=_ema(_,s);var c=_.slice(_.length-l.length,_.length);for(r=0;r<c.length;r++)u.push(c[r]-l[r]);return{macds:_,signals:l,histograms:u}};export var MovingAverageType;!function(t){t[t.Simple=0]="Simple",t[t.Exponential=1]="Exponential"}(MovingAverageType||(MovingAverageType={}));var Envelopes=function(t){function e(e){var i=t.call(this)||this;return i._period=20,i._type=MovingAverageType.Simple,i._size=.025,i.rendering.addHandler(i._rendering,i),i.initialize(e),i}return __extends(e,t),Object.defineProperty(e.prototype,"period",{get:function(){return this._period},set:function(t){t!==this._period&&(this._period=asInt(t,!1,!0),this._clearValues(),this._invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"type",{get:function(){return this._type},set:function(t){(t=asEnum(t,MovingAverageType,!1))!==this._type&&(this._type=t,this._clearValues(),this._invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this._size},set:function(t){t!==this._size&&(this._size=asNumber(t,!1,!0),this._clearValues(),this._invalidate())},enumerable:!0,configurable:!0}),e.prototype.getDataRect=function(e,i){if(i)return i;var s=null;if(t.prototype._getLength.call(this)<=0)return s;this._shouldCalculate()&&(this._init(),this._calculate());var a=this._upperYVals.concat(this._lowerYVals),n=_minimum(this._xVals),l=_maximum(this._xVals),r=_minimum(a),o=_maximum(a);return _DataInfo.isValid(n)&&_DataInfo.isValid(l)&&_DataInfo.isValid(r)&&_DataInfo.isValid(o)&&(s=new Rect(n,r,l-n,o-r)),s},e.prototype._clearValues=function(){t.prototype._clearValues.call(this),this._upperYVals=null,this._lowerYVals=null,this._xVals=null},e.prototype._init=function(){t.prototype._init.call(this),this._upperYVals=[],this._lowerYVals=[],this._xVals=[]},e.prototype._shouldCalculate=function(){return!this._upperYVals||!this._lowerYVals||!this._xVals},e.prototype._calculate=function(){var e=this;if(!(t.prototype._getLength.call(this)<=0)){var i,s=t.prototype.getValues.call(this,0),a=this._getXValues();switch(this.type){case MovingAverageType.Exponential:i=_ema(s,this.period);break;case MovingAverageType.Simple:default:i=_sma(s,this.period)}this._xVals=a?a.slice(this.period-1):_range(this.period-1,t.prototype._getLength.call(this)-1),this._upperYVals=i.map(function(t){return t+t*e.size}),this._lowerYVals=i.map(function(t){return t-t*e.size})}},e.prototype._rendering=function(e,i){if(i.cancel=!0,!(t.prototype._getLength.call(this)<=0)){this._shouldCalculate()&&(this._init(),this._calculate());var s=this.chart.series.indexOf(this),a=i.engine,n=this._getAxisX(),l=this._getAxisY(),r=_minimum(this._upperYVals.length,this._lowerYVals.length,this._xVals.length),o=_BasePlotter.cloneStyle(this.style,["fill"]),h=this._getSymbolStroke(s),_=this.chart._plotrectId;if(r&&!(r<=0)){a.stroke=h,a.strokeWidth=2;for(var u,c,p,d=[],g=[],f=[],y=this._getLength(),m=0;m<r;m++)p=y-r+m,d.push(n.convert(this._xVals[m])),g.push(l.convert(this._upperYVals[m])),u=this._getDataPoint(this._xVals[m],this._upperYVals[m],s,p,n,l),(c=new _CircleArea(new Point(d[m],g[m]),.5*a.strokeWidth)).tag=u,this._hitTester.add(c,s),f.push(l.convert(this._lowerYVals[m])),u=this._getDataPoint(this._xVals[m],this._lowerYVals[m],s,p,n,l),(c=new _CircleArea(new Point(d[m],f[m]),.5*a.strokeWidth)).tag=u,this._hitTester.add(c,s);this._hitTester.add(new _LinesArea(d,g),s),this._hitTester.add(new _LinesArea(d,f),s),a.drawLines(d,g,null,o,_),a.drawLines(d,f,null,o,_)}}},e.prototype.getCalculatedValues=function(e){e=asString(e,!1);var i=[],s=0;if(t.prototype._getLength.call(this)<=0)return i;switch(this._shouldCalculate()&&(this._init(),this._calculate()),e){case"upperEnvelope":for(;s<this._upperYVals.length;s++)i.push({x:this._xVals[s],y:this._upperYVals[s]});break;case"lowerEnvelope":for(;s<this._lowerYVals.length;s++)i.push({x:this._xVals[s],y:this._lowerYVals[s]})}return i},e}(OverlayIndicatorBase);export{Envelopes};var CCI=function(t){function e(e){var i=t.call(this)||this;return i._constant=.015,i.period=20,i.initialize(e),i}return __extends(e,t),Object.defineProperty(e.prototype,"constant",{get:function(){return this._constant},set:function(t){t!==this._constant&&(this._constant=asNumber(t,!1),this._clearValues(),this._invalidate())},enumerable:!0,configurable:!0}),e.prototype._calculate=function(){var e=t.prototype._getLength.call(this);if(!(e<=0)){var i=t.prototype._getBindingValues.call(this,0),s=t.prototype._getBindingValues.call(this,1),a=t.prototype._getBindingValues.call(this,3),n=this._getXValues();this._yvals=_cci(i,s,a,this.period,this.constant),this._xvals=n?n.slice(this.period-1):_range(this.period-1,e-1)}},e}(SingleOverlayIndicatorBase);export{CCI};export function _cci(t,e,i,s,a){asArray(t,!1),asArray(e,!1),asArray(i,!1),asInt(s,!1,!0),asNumber(a,!1,!0);var n,l,r,o=_minimum(t.length,e.length,i.length),h=[],_=[],u=[];for(assert(o>s&&s>1,"CCI period must be an integer less than the length of the data and greater than one."),l=0;l<o;l++)h.push(_average(t[l],e[l],i[l]));for(n=_sma(h,s),l=0;l<n.length;l++)r=h.slice(l,s+l).reduce(function(t,e){return t+Math.abs(n[l]-e)},0),_.push(r/s);for(h.splice(0,s-1),l=0;l<n.length;l++)u.push((h[l]-n[l])/(a*_[l]));return u};var BollingerBands=function(t){function e(e){var i=t.call(this)||this;return i._period=20,i._multiplier=2,i.rendering.addHandler(i._rendering,i),i.initialize(e),i}return __extends(e,t),Object.defineProperty(e.prototype,"period",{get:function(){return this._period},set:function(t){t!==this._period&&(this._period=asInt(t,!1,!0),this._clearValues(),this._invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"multiplier",{get:function(){return this._multiplier},set:function(t){t!==this._multiplier&&(this._multiplier=asNumber(t,!1,!0),this._clearValues(),this._invalidate())},enumerable:!0,configurable:!0}),e.prototype.getDataRect=function(e,i){if(i)return i;if(t.prototype._getLength.call(this)<=0)return null;this._shouldCalculate()&&(this._init(),this._calculate());var s=this._upperYVals.concat(this._lowerYVals),a=_minimum(this._xVals),n=_maximum(this._xVals),l=_minimum(s),r=_maximum(s);return _DataInfo.isValid(a)&&_DataInfo.isValid(n)&&_DataInfo.isValid(l)&&_DataInfo.isValid(r)?new Rect(a,l,n-a,r-l):null},e.prototype._clearValues=function(){t.prototype._clearValues.call(this),this._upperYVals=null,this._middleYVals=null,this._lowerYVals=null,this._xVals=null},e.prototype._shouldCalculate=function(){return!(this._upperYVals&&this._middleYVals&&this._lowerYVals&&this._xVals)},e.prototype._init=function(){t.prototype._init.call(this),this._upperYVals=[],this._middleYVals=[],this._lowerYVals=[],this._xVals=[]},e.prototype._calculate=function(){var e=t.prototype._getLength.call(this);if(!(e<=0)){var i=t.prototype.getValues.call(this,0),s=this._getXValues(),a=_bollingerBands(i,this.period,this.multiplier);this._upperYVals=a.uppers,this._middleYVals=a.middles,this._lowerYVals=a.lowers,this._xVals=s?s.slice(this.period-1):_range(this.period-1,e-1)}},e.prototype._rendering=function(e,i){if(i.cancel=!0,!(t.prototype._getLength.call(this)<=0)){this._shouldCalculate()&&(this._init(),this._calculate());var s=this.chart.series.indexOf(this),a=i.engine,n=this._getAxisX(),l=this._getAxisY(),r=_minimum(this._upperYVals.length,this._middleYVals.length,this._lowerYVals.length,this._xVals.length),o=_BasePlotter.cloneStyle(this.style,["fill"]),h=this._getSymbolStroke(s),_=this.chart._plotrectId;if(r&&!(r<=0)){a.stroke=h,a.strokeWidth=2;for(var u,c,p,d=[],g=[],f=[],y=[],m=this._getLength(),v=0;v<r;v++)p=m-r+v,d.push(n.convert(this._xVals[v])),g.push(l.convert(this._upperYVals[v])),u=this._getDataPoint(this._xVals[v],this._upperYVals[v],s,p,n,l),(c=new _CircleArea(new Point(d[v],g[v]),.5*a.strokeWidth)).tag=u,this._hitTester.add(c,s),f.push(l.convert(this._middleYVals[v])),u=this._getDataPoint(this._xVals[v],this._middleYVals[v],s,p,n,l),(c=new _CircleArea(new Point(d[v],f[v]),.5*a.strokeWidth)).tag=u,this._hitTester.add(c,s),y.push(l.convert(this._lowerYVals[v])),u=this._getDataPoint(this._xVals[v],this._lowerYVals[v],s,p,n,l),(c=new _CircleArea(new Point(d[v],y[v]),.5*a.strokeWidth)).tag=u,this._hitTester.add(c,s);this._hitTester.add(new _LinesArea(d,g),s),this._hitTester.add(new _LinesArea(d,f),s),this._hitTester.add(new _LinesArea(d,y),s),a.drawLines(d,g,null,o,_),a.drawLines(d,f,null,o,_),a.drawLines(d,y,null,o,_)}}},e.prototype.getCalculatedValues=function(e){e=asString(e,!1);var i=[],s=0;if(t.prototype._getLength.call(this)<=0)return i;switch(this._shouldCalculate()&&(this._init(),this._calculate()),e){case"upperBand":for(;s<this._upperYVals.length;s++)i.push({x:this._xVals[s],y:this._upperYVals[s]});break;case"middleBand":for(;s<this._middleYVals.length;s++)i.push({x:this._xVals[s],y:this._middleYVals[s]});break;case"lowerBand":for(;s<this._lowerYVals.length;s++)i.push({x:this._xVals[s],y:this._lowerYVals[s]})}return i},e}(OverlayIndicatorBase);export{BollingerBands};export function _bollingerBands(t,e,i){asArray(t,!1),asInt(e,!1,!0),asNumber(i,!1,!0),assert(t.length>e&&e>1,"Bollinger Bands period must be an integer less than the length of the data and greater than one.");var s,a=_sma(t,e),n=[];for(s=e;s<=t.length;s++)n.push(_stdDeviation(t.slice(s-e,s)));var l=a,r=a.map(function(t,e){return t+n[e]*i});return{lowers:a.map(function(t,e){return t-n[e]*i}),middles:l,uppers:r}};var ATR=function(t){function e(e){var i=t.call(this)||this;return i.period=14,i.initialize(e),i}return __extends(e,t),e.prototype._calculate=function(){if(!(t.prototype._getLength.call(this)<=0)){var e=t.prototype._getBindingValues.call(this,0),i=t.prototype._getBindingValues.call(this,1),s=t.prototype._getBindingValues.call(this,3),a=this._getXValues();this._yvals=_avgTrueRng(e,i,s,this.period),this._xvals=a?a.slice(this.period-1):_range(this.period-1,e.length)}},e}(SingleOverlayIndicatorBase);export{ATR};_registerModule("wijmo.chart.finance.analytics",selfModule);