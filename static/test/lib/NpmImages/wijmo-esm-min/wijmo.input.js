/*!
    *
    * Wijmo Library 5.20191.603
    * http://wijmo.com/
    *
    * Copyright(c) GrapeCity, Inc.  All rights reserved.
    *
    * Licensed under the GrapeCity Commercial License.
    * sales@wijmo.com
    * wijmo.com/products/wijmo-5/license/
    *
    */

var __extends=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();import{Control,_addCultureInfo,culture,setAriaLabel,disableAutoComplete,removeChild,addClass,isIE,isIE9,asBoolean,toggleClass,CancelEventArgs,hasClass,hidePopup,removeClass,asString,setSelectionRange,Event,EventArgs,contains,getActiveElement,showPopup,Key,setAttribute,Binding,asFunction,asNumber,DateTime,isObject,asArray,tryCast,closest,escapeHtml,asType,asCollectionView,hasItems,createElement,getUniqueId,clamp,toPlainText,enable,isFunction,_ClickRepeater,asDate,asEnum,Globalize,setText,isDate,Color,setCss,_MaskProvider,isNumber,isArray,Point,getElementRect,format,moveFocus,getElement,isUndefined,mouseToPage,_registerModule}from"wijmo/wijmo";import*as selfModule from"wijmo/wijmo.input";_addCultureInfo("InputNumber",{ariaLabels:{incVal:"Increase Value",decVal:"Decrease Value"}});var InputNumber=function(e){function t(t,i){var n=e.call(this,t)||this;n._showBtn=!0,n._readOnly=!1,n.textChanged=new Event,n.valueChanged=new Event;var s=n.hostElement;setAttribute(s,"role","spinbutton",!0);var o=n.getTemplate();n.applyTemplate("wj-control wj-content wj-inputnumber",o,{_tbx:"input",_btnUp:"btn-inc",_btnDn:"btn-dec"},"input");var r=culture.InputNumber.ariaLabels;setAriaLabel(n._btnUp.querySelector("button"),r.incVal),setAriaLabel(n._btnDn.querySelector("button"),r.decVal),n._tbx.type.match(/number/i)&&(n.inputType="");var a=n._tbx;a.autocomplete="off",a.spellcheck=!1,n._updateSymbols();var l=n.addEventListener.bind(n);l(a,"keypress",n._keypress.bind(n)),l(a,"keydown",n._keydown.bind(n)),l(a,"input",n._input.bind(n)),l(a,"blur",function(){n.text!=n._oldText&&n._setText(n.text)}),l(a,"compositionstart",function(){n._composing=!0}),l(a,"compositionend",function(){n._composing=!1,setTimeout(function(){var e=n.text;n._oldText.indexOf(n._chrPct)>-1&&e.indexOf(n._chrPct)<0&&(e+=n._chrPct),n._setText(e)})});var h=n._clickSpinner.bind(n);return l(n._btnUp,"click",h),l(n._btnDn,"click",h),n._rptUp=new _ClickRepeater(n._btnUp.querySelector("button")),n._rptDn=new _ClickRepeater(n._btnDn.querySelector("button")),l(s,"wheel",function(e){if(!e.defaultPrevented&&!n.isReadOnly&&n.containsFocus()){var t=clamp(-e.deltaY,-1,1);n._increment((n.step||1)*t),setTimeout(function(){return n.selectAll()}),e.preventDefault()}}),n.value=0,n.isRequired=!0,n.initialize(i),n}return __extends(t,e),Object.defineProperty(t.prototype,"inputElement",{get:function(){return this._tbx},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inputType",{get:function(){return this._tbx.type},set:function(e){this._tbx.type=asString(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return this._value},set:function(e){if(e!=this._value)if(null==(e=asNumber(e,!this.isRequired||null==e&&null==this._value)))this._setText("");else if(!isNaN(e)){var t=Globalize.format(e,this.format);this._setText(t)}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isRequired",{get:function(){return this._tbx.required},set:function(e){this._tbx.required=asBoolean(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isReadOnly",{get:function(){return this._readOnly},set:function(e){this._readOnly=asBoolean(e),this.inputElement.readOnly=this._readOnly,toggleClass(this.hostElement,"wj-state-readonly",this.isReadOnly)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"min",{get:function(){return this._min},set:function(e){e!=this._min&&(this._min=asNumber(e,!0),this._updateAria())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"max",{get:function(){return this._max},set:function(e){e!=this._max&&(this._max=asNumber(e,!0),this._updateAria())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"step",{get:function(){return this._step},set:function(e){this._step=asNumber(e,!0),this._updateBtn()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"format",{get:function(){return this._format},set:function(e){e!=this.format&&(this._format=asString(e),this.refresh())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"text",{get:function(){return this._tbx.value},set:function(e){e!=this.text&&(this._oldText=null,this._setText(e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"placeholder",{get:function(){return this._tbx.placeholder},set:function(e){this._tbx.placeholder=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"showSpinner",{get:function(){return this._showBtn},set:function(e){this._showBtn=asBoolean(e),this._updateBtn()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"repeatButtons",{get:function(){return!this._rptUp.disabled},set:function(e){this._rptUp.disabled=this._rptDn.disabled=!asBoolean(e)},enumerable:!0,configurable:!0}),t.prototype.selectAll=function(){var e=this._tbx;setSelectionRange(e,0,e.value.length)},t.prototype.clamp=function(e){return clamp(e,this.min,this.max)},t.prototype.onTextChanged=function(e){this.textChanged.raise(this,e),this._updateState()},t.prototype.onValueChanged=function(e){this._updateAria(),this.valueChanged.raise(this,e)},t.prototype.dispose=function(){this._rptUp.element=null,this._rptDn.element=null,e.prototype.dispose.call(this)},t.prototype.onGotFocus=function(t){this._oldValue=this.value,this.isTouching||(this._tbx.focus(),this.selectAll()),e.prototype.onGotFocus.call(this,t)},t.prototype.onLostFocus=function(t){this._composing&&(this._composing=!1,this._setText(this.text));var i=this.clamp(this.value),n=Globalize.format(i,this.format);this._setText(n),e.prototype.onLostFocus.call(this,t)},t.prototype.refresh=function(t){void 0===t&&(t=!0),e.prototype.refresh.call(this,t),this._updateSymbols();var i=Globalize.format(this.value,this.format);this._setText(i)},t.prototype._updateSymbols=function(){var e=culture.Globalize.numberFormat,t=this.format?this.format.match(/([a-z])(\d*)(,*)(.*)/i):null;this._chrDec=e["."]||".",this._chrTho=e[","]||",",this._chrNeg=e["-"]||"-",this._chrPls=e["+"]||"+",this._chrPct=e["%"]||"%",this._chrCur=t&&t[4]?t[4]:e.currency.symbol||"$",this._fmtSpc=t&&t[1]?t[1].toLowerCase():"n",this._fmtPrc=t&&t[2]?parseInt(t[2]):null,this._rxSym=new RegExp("^[%+\\-() \\"+this._chrDec+"\\"+this._chrCur+"\\"+this._chrNeg+"\\"+this._chrPls+"\\"+this._chrPct+"]*$"),this._rxNeg=new RegExp("(\\-|\\(|\\"+this._chrNeg+")")},t.prototype._isNumeric=function(e,t){var i=e==this._chrDec||e>="0"&&e<="9",n="x"==this._fmtSpc;return!i&&n&&(i=e>="a"&&e<="f"||e>="A"&&e<="F"),i||t||n||(i=e==this._chrPls||e==this._chrNeg||"("==e||")"==e),i},t.prototype._getInputRange=function(e){for(var t=[0,0],i=this.text,n=!1,s=0;s<i.length;s++)this._isNumeric(i[s],e)&&(n||(t[0]=s,n=!0),t[1]=s+1);return t},t.prototype._flipSign=function(){var e=this._getSelStartDigits();this.value*=-1,this._setSelStartDigits(e)},t.prototype._getSelStartDigits=function(){for(var e=0,t=this._tbx.selectionStart,i=this._tbx.value,n=0;n<i.length&&n<t;n++)this._isNumeric(i[n],!0)&&e++;return e},t.prototype._setSelStartDigits=function(e){for(var t=this._tbx.value,i=0;i<t.length&&e>=0;i++)if(this._isNumeric(t[i],!0)){if(!e){setSelectionRange(this._tbx,i);break}e--}else if(!e){setSelectionRange(this._tbx,i);break}},t.prototype._increment=function(e){if(e){var t=this.clamp(isNumber(this.value)?this.value+e:0),i=Globalize.format(t,this.format,!1,!1);this._setText(i)}},t.prototype._updateBtn=function(){var e=this.showSpinner&&!!this.step,t=e;setCss([this._btnUp,this._btnDn],{display:e?"":"none"}),toggleClass(this.hostElement,"wj-input-show-spinner",e),enable(this._btnUp,t),enable(this._btnDn,t),this._updateAria()},t.prototype._setText=function(e){if(!this._composing){var t=this._tbx,i=this._rxNeg.test(e),n=this._delKey;if(e&&this._rxSym.test(e)&&this.containsFocus()&&(e=this.isRequired||!n?"0":""),this._delKey=!1,n&&0==this.value&&!this.isRequired&&(e=""),!e){if(!this.isRequired)return t.value="",null!=this._value&&(this._value=null,this.onValueChanged()),this._oldText&&(this._oldText=e,this.onTextChanged()),void this._updateBtn();e="0"}var s=this._format||(e.indexOf(this._chrDec)>-1?"n2":"n0"),o=Globalize.parseFloat(e,s);if(isNaN(o))t.value=this._oldText;else{var r=Globalize.format(o,s,!1);i&&o>=0&&!n&&(r=this._chrNeg+r),null!=this._fmtPrc&&"g"!=this._fmtSpc||!n&&t.value.match(/\.0?$/)&&(r=e+("0"==e?this._chrDec:"")),t.value!=r&&("g"==this._fmtSpc&&t.value.match(r+"0*")&&this.containsFocus()&&t.selectionStart==t.value.length&&(r=t.value),t.value=r,o=Globalize.parseFloat(r,this.format)),o!=this._value&&(this._value=o,this.onValueChanged()),this.text!=this._oldText&&(this._oldText=this.text,this.onTextChanged()),this._updateBtn()}}},t.prototype._keypress=function(e){if(!(e.defaultPrevented||this._composing||this.isReadOnly)&&e.charCode&&!e.ctrlKey&&!e.metaKey){var t=this._tbx,i=String.fromCharCode(e.charCode);if(this._isNumeric(i,!1)){var n=this._getInputRange(!0),s=t.selectionStart,o=t.selectionEnd;if(s<n[0]&&o<t.value.length&&(o=Math.max(o,n[0]),setSelectionRange(t,n[0],o)),s>=n[1]){var r=null!=this._fmtPrc?this._fmtPrc:2,a=t.value.indexOf(this._chrDec);a>-1&&s-a>r&&e.preventDefault()}}else e.preventDefault();switch(i){case"-":case this._chrNeg:this.min>=0?this.value<0&&this._flipSign():this.value&&t.selectionStart==t.selectionEnd?this._flipSign():this.clamp(-1)<0&&(t.value=this._chrNeg,setSelectionRange(t,1)),e.preventDefault();break;case"+":case this._chrPls:this.value<0&&this._flipSign(),e.preventDefault();break;case".":case this._chrDec:if(0==this._fmtPrc)e.preventDefault();else{var l=t.value.indexOf(this._chrDec);l>-1&&(t.selectionStart<=l&&l++,setSelectionRange(t,l),e.preventDefault())}}if(!e.defaultPrevented&&isIE()){var h=t.value;(s=t.selectionStart)==(o=t.selectionEnd)&&(t.value=h.substr(0,s)+i+h.substr(o),setSelectionRange(t,s+1),e.preventDefault(),this._input())}}},t.prototype._keydown=function(e){var t=this;if(this._delKey=!1,!e.defaultPrevented&&!this._composing){var i=this._tbx,n=i.value,s=i.selectionStart,o=i.selectionEnd;switch(e.keyCode){case 65:e.ctrlKey&&(setTimeout(function(){t.selectAll()}),e.preventDefault());break;case Key.Up:case Key.Down:this.step&&!this.isReadOnly&&(this._increment(this.step*(e.keyCode==Key.Up?1:-1)),setTimeout(function(){t.selectAll()}),e.preventDefault());break;case Key.Back:if(this._delKey=!0,o-s<2&&!this.isReadOnly){var r=n[o-1];r!=this._chrDec&&r!=this._chrPct&&r!=this._chrTho&&")"!=r||(setTimeout(function(){o=r==t._chrPct?t._getInputRange(!0)[1]:o-1,setSelectionRange(i,o)}),e.preventDefault())}break;case Key.Delete:if(this._delKey=!0,o-s<2&&!this.isReadOnly)if("0"==n&&1==s)setSelectionRange(i,0);else{var a=n[s];a!=this._chrDec&&a!=this._chrPct||(setTimeout(function(){setSelectionRange(i,s+1)}),e.preventDefault())}break;case Key.Escape:this.value=this._oldValue,this.selectAll()}}},t.prototype._input=function(){var e=this;this._composing||setTimeout(function(){var t=e._tbx,i=t.value,n=i.indexOf(e._chrDec),s=t.selectionStart,o=e._getSelStartDigits();if("p"==e._fmtSpc&&i.length&&i.indexOf(e._chrPct)<0&&(i+=e._chrPct),e._setText(i),e.containsFocus()){var r=t.value,a=r.indexOf(e._chrDec),l=e._getInputRange(!0);if(i==e._chrNeg+e._chrDec&&a>-1)return void setSelectionRange(t,a+1);if(i[0]==e._chrNeg&&r[0]!=e._chrNeg)return void(1==r.length?setSelectionRange(t,1):e._setSelStartDigits(o));i?i==e._chrDec&&a>-1?s=a+1:s<=n&&a>-1||n<0&&a<0?s+=r.length-i.length:n<0&&a>-1&&(s=a):s=a>-1?a:l[1],s=clamp(s,l[0],l[1]),setSelectionRange(t,s)}})},t.prototype._clickSpinner=function(e){var t=this;e.defaultPrevented||this.isReadOnly||!this.step||(this._increment(this.step*(contains(this._btnUp,e.target)?1:-1)),this.isTouching||setTimeout(function(){return t.selectAll()}))},t.prototype._updateAria=function(){var e=this.hostElement;e&&(setAttribute(e,"aria-valuemin",this.min),setAttribute(e,"aria-valuemax",this.max),setAttribute(e,"aria-valuenow",this.value))},t.controlTemplate='<div class="wj-input"><div class="wj-input-group"><span wj-part="btn-dec" class="wj-input-group-btn" tabindex="-1"><button class="wj-btn wj-btn-default" tabindex="-1">-</button></span><input type="tel" wj-part="input" class="wj-form-control wj-numeric"/><span wj-part="btn-inc" class="wj-input-group-btn" tabindex="-1"><button class="wj-btn wj-btn-default" tabindex="-1">+</button></span></div></div>',t}(Control);export{InputNumber};var InputMask=function(e){function t(t,i){var n=e.call(this,t)||this;n.valueChanged=new Event;var s=n.getTemplate();if(n.applyTemplate("wj-control wj-content wj-inputmask",s,{_tbx:"input"},"input"),"INPUT"==n._orgTag){var o=n._tbx.getAttribute("value");o&&(n.value=o)}return n._msk=new _MaskProvider(n._tbx),n.isRequired=!0,n.initialize(i),n.addEventListener(n._tbx,"input",function(){setTimeout(function(){n.onValueChanged()})}),n}return __extends(t,e),Object.defineProperty(t.prototype,"inputElement",{get:function(){return this._tbx},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inputType",{get:function(){return this._tbx.type},set:function(e){this._tbx.type=asString(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return this._tbx.value},set:function(e){e!=this.value&&(this._tbx.value=asString(e),e=this._msk._applyMask(),this._tbx.value=e,this.onValueChanged())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rawValue",{get:function(){return this._msk.getRawValue()},set:function(e){e!=this.rawValue&&(this.value=asString(e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"mask",{get:function(){return this._msk.mask},set:function(e){var t=this.value;this._msk.mask=asString(e),this.value!=t&&this.onValueChanged()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"promptChar",{get:function(){return this._msk.promptChar},set:function(e){var t=this.value;this._msk.promptChar=e,this.value!=t&&this.onValueChanged()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"placeholder",{get:function(){return this._tbx.placeholder},set:function(e){this._tbx.placeholder=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maskFull",{get:function(){return this._msk.maskFull},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isRequired",{get:function(){return this._tbx.required},set:function(e){this._tbx.required=asBoolean(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isReadOnly",{get:function(){return this._tbx.readOnly},set:function(e){this._tbx.readOnly=asBoolean(e),toggleClass(this.hostElement,"wj-state-readonly",this.isReadOnly)},enumerable:!0,configurable:!0}),t.prototype.selectAll=function(){var e=this._msk.getMaskRange();setSelectionRange(this._tbx,e[0],e[1]+1)},t.prototype.onValueChanged=function(e){this.value!=this._oldValue&&(this._oldValue=this.value,this.valueChanged.raise(this,e)),this._updateState()},t.prototype._updateState=function(){e.prototype._updateState.call(this);var t=!this._pristine&&this._tbx.value&&!this.maskFull;toggleClass(this.hostElement,"wj-state-invalid",t)},t.prototype.dispose=function(){this._msk.input=null,e.prototype.dispose.call(this)},t.prototype.refresh=function(t){void 0===t&&(t=!0),e.prototype.refresh.call(this,t),this._msk.refresh()},t.prototype.onGotFocus=function(t){e.prototype.onGotFocus.call(this,t),this.selectAll()},t.controlTemplate='<div class="wj-input"><div class="wj-input-group"><input wj-part="input" class="wj-form-control"/></div></div>',t}(Control);export{InputMask};var ColorPicker=function(e){function t(i,n){var s=e.call(this,i)||this;s._hsb=[.5,1,1],s._alpha=1,s.valueChanged=new Event;var o=s.getTemplate();s.applyTemplate("wj-control wj-content wj-colorpicker",o,{_eSB:"div-sb",_eHue:"div-hue",_eAlpha:"div-alpha",_ePreview:"div-pv",_ePal:"div-pal",_eText:"div-text"}),s._palette="#FFF,#000, #F00,#FFC000,#FFFF00,#92D050,#00B050,#00B0F0,#0070C0,#7030A0".split(","),s._updatePalette(),s._eHue.style.backgroundImage="url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAD4CAIAAACi6hsPAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAYdEVYdFNvZnR3YXJlAHBhaW50Lm5ldCA0LjAuM4zml1AAAAGvSURBVDhPXdBPaM9xHMfxz4pWaxcmtoOhpdXSVpiyHWxqmVpDjaU5rK34XfypjTJ/p+ZPay6jhsOsRrKwaJElf9IQq03WIkv4FeMwMq221tfje1ByeFzfvd7PEKWGEKWTQRZLySWfVRRTQjmVbKWGOhLsZT+HaeY0bbTTQSfdXOcWffTzmAFeMcwoYyT5ygS/mA5hNgphip98J8kHRnnNSwZ4yH1uc4OrdHGR87RximYO0cgedlLLdqqoYAPrWMtKVrCcJSxiPmnMJUQp/Bsyk2xyyKOAQooopYwKtlDNDur5G7SBJo7RQiv/B+2hl3s84CkvGGKEOOYnxolj/mYmhBmDJ5ngCx95xxsGecYj4pB3iENeoZMO2mmlhaMcpIE4ZII6aqhmM3HMMkooopB88sghm0wySCeVlCjMCVFIYx4LWUwOeRSwhmLWU84mqqihll3sppEmjnOSs5zjEl1c4yZ99POE5wwxwns+840fTDFLFKaZZIJxkozxlmEGGSC+GF++Sy89dHOZC8Rr4lVnOMERDrCPBPXEX22jko2UEn+/mnxyWUYWC0gnNUQh/AEc0HJs6cex0gAAAABJRU5ErkJggg==)",s._eHue.style.backgroundSize="contain",navigator.appVersion.indexOf("MSIE 9")>-1&&(s._eSB.children[0].style.filter="progid:DXImageTransform.Microsoft.gradient(startColorstr=#ffffffff,endColorstr=#00ffffff,GradientType=1)",s._eSB.children[1].style.filter="progid:DXImageTransform.Microsoft.gradient(startColorstr=#00000000,endColorstr=#ff000000,GradientType=0)"),o=t._tplCursor,s._cSB=createElement(o),s._cHue=createElement(o),s._cHue.style.width="100%",s._cAlpha=createElement(o),s._cAlpha.style.height="100%",s._eSB.appendChild(s._cSB),s._eHue.appendChild(s._cHue),s._eAlpha.appendChild(s._cAlpha),s.addEventListener(s.hostElement,"mousedown",function(e){document.addEventListener("mousemove",r),document.addEventListener("mouseup",a),s._mouseDown(e)});var r=function(e){s._mouseMove(e)},a=function(e){document.removeEventListener("mousemove",r),document.removeEventListener("mouseup",a),s._mouseUp(e)};return s.addEventListener(s.hostElement,"click",function(e){var t=e.target;if(t&&"DIV"==t.tagName&&contains(s._ePal,t)){var i=t.style.backgroundColor;i&&(s.value=new Color(i).toString())}}),s.value="#ffffff",s.initialize(n),s._updatePanels(),s}return __extends(t,e),Object.defineProperty(t.prototype,"showAlphaChannel",{get:function(){return"none"!=this._eAlpha.parentElement.style.display},set:function(e){this._eAlpha.parentElement.style.display=asBoolean(e)?"":"none"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"showColorString",{get:function(){return"none"!=this._eText.style.display},set:function(e){this._eText.style.display=asBoolean(e)?"":"none"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return this._value},set:function(e){if(e!=this.value){this._value=asString(e),this._eText.innerText=this._value;var t=new Color(this._value),i=t.getHsb();this._hsb[0]==i[0]&&this._hsb[1]==i[1]&&this._hsb[2]==i[2]&&this._alpha==t.a||(0==i[2]?(i[0]=this._hsb[0],i[1]=this._hsb[1]):0==i[1]&&(i[0]=this._hsb[0]),this._hsb=i,this._alpha=t.a,this.onValueChanged())}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"palette",{get:function(){return this._palette},set:function(e){e=asArray(e);for(var t=0;t<e.length&&t<this._palette.length;t++){var i=asString(e[t]);this._palette[t]=i}this._updatePalette()},enumerable:!0,configurable:!0}),t.prototype.onValueChanged=function(e){this._updatePanels(),this.valueChanged.raise(this,e)},t.prototype._mouseDown=function(e){this._htDown=this._getTargetPanel(e),this._htDown&&(e.preventDefault(),this.focus(),this._mouseMove(e))},t.prototype._mouseMove=function(e){if(this._htDown){var t=this._htDown.getBoundingClientRect();this._htDown==this._eHue?(this._hsb[0]=clamp((e.clientY-t.top)/t.height,0,.99),this._updateColor()):this._htDown==this._eSB?(this._hsb[1]=clamp((e.clientX-t.left)/t.width,0,1),this._hsb[2]=clamp(1-(e.clientY-t.top)/t.height,0,1),this._updateColor()):this._htDown==this._eAlpha&&(this._alpha=clamp((e.clientX-t.left)/t.width,0,1),this._updateColor())}},t.prototype._mouseUp=function(e){this._htDown=null},t.prototype._updateColor=function(){var e=Color.fromHsb(this._hsb[0],this._hsb[1],this._hsb[2],this._alpha);this.value=e.toString(),this._updatePanels()},t.prototype._updatePalette=function(){var e=new Color("#fff"),t=new Color("#000");this._ePal.innerHTML="";for(var i=0;i<this._palette.length;i++){var n=createElement('<div style="float:left;width:10%;box-sizing:border-box;padding:1px">'),s=new Color(this._palette[i]),o=s.getHsb();n.appendChild(this._makePalEntry(s,4));for(var r=0;r<5;r++){if(0==o[1]){var a=.1*r+(o[2]>.5?.05:.55);s=Color.interpolate(e,t,a)}else s=Color.fromHsb(o[0],.1+.2*r,1-.1*r);n.appendChild(this._makePalEntry(s,0))}this._ePal.appendChild(n)}},t.prototype._makePalEntry=function(e,t){var i=document.createElement("div");return setCss(i,{cursor:"pointer",backgroundColor:e.toString(),marginBottom:t||""}),i.innerHTML="&nbsp",i},t.prototype._updatePanels=function(){var e=Color.fromHsb(this._hsb[0],1,1,1),t=Color.fromHsb(this._hsb[0],this._hsb[1],this._hsb[2],1);this._eSB.style.backgroundColor=e.toString(),this._eAlpha.style.background="linear-gradient(to right, transparent 0%, "+t.toString()+" 100%)",navigator.appVersion.indexOf("MSIE 9")>-1&&(this._eAlpha.style.filter="progid:DXImageTransform.Microsoft.gradient(startColorstr=#00000000,endColorstr="+t.toString()+", GradientType = 1)"),this._ePreview.style.backgroundColor=this.value,this._cHue.style.top=(100*this._hsb[0]).toFixed(0)+"%",this._cSB.style.left=(100*this._hsb[1]).toFixed(0)+"%",this._cSB.style.top=(100-100*this._hsb[2]).toFixed(0)+"%",this._cAlpha.style.left=(100*this._alpha).toFixed(0)+"%"},t.prototype._getTargetPanel=function(e){var t=e.target;return contains(this._eSB,t)?this._eSB:contains(this._eHue,t)?this._eHue:contains(this._eAlpha,t)?this._eAlpha:null},t.controlTemplate='<div style="position:relative;width:100%;height:100%"><div style="float:left;width:50%;height:100%;box-sizing:border-box;padding:2px"><div wj-part="div-pal"><div style="float:left;width:10%;box-sizing:border-box;padding:2px"><div style="background-color:black;width:100%">&nbsp;</div><div style="height:6px"></div></div></div><div wj-part="div-text" style="position:absolute;bottom:0px;display:none"></div></div><div style="float:left;width:50%;height:100%;box-sizing:border-box;padding:2px"><div wj-part="div-sb" class="wj-colorbox" style="float:left;width:89%;height:89%"><div style="position:absolute;width:100%;height:100%;background:linear-gradient(to right, white 0%,transparent 100%)"></div><div style="position:absolute;width:100%;height:100%;background:linear-gradient(to top, black 0%,transparent 100%)"></div></div><div style="float:left;width:1%;height:89%"></div><div style="float:left;width:10%;height:89%"><div wj-part="div-hue" class="wj-colorbox"></div></div><div style="float:left;width:89%;height:1%"></div><div style="float:left;width:89%;height:10%"><div style="width:100%;height:100%;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAIAAABLbSncAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAYdEVYdFNvZnR3YXJlAHBhaW50Lm5ldCA0LjAuM4zml1AAAAAcSURBVBhXY/iPBBYgAWpKQGkwgMqDAdUk/v8HAM7Mm6GatDUYAAAAAElFTkSuQmCC)"><div wj-part="div-alpha" class="wj-colorbox"></div></div></div><div style="float:left;width:1%;height:10%"></div><div style="float:left;width:10%;height:10%"><div wj-part="div-pv" class="wj-colorbox" style="position:static"></div></div></div></div>',t._tplCursor='<div style="position:absolute;left:50%;top:50%;width:7px;height:7px;transform:translate(-50%,-50%);border:2px solid #f0f0f0;border-radius:50px;box-shadow:0px 0px 4px 2px #0f0f0f"></div>',t}(Control);export{ColorPicker};var ListBox=function(e){function t(t,i){var n=e.call(this,t)||this;n._pathDisplay=new Binding(null),n._pathValue=new Binding(null),n._pathChecked=new Binding(null),n._html=!1,n._shGroups=!1,n._checkedItems=[],n._itemRole="option",n._search="",n._fmtItemHandlers=0,n._itemCount=0,n.selectedIndexChanged=new Event,n.itemsChanged=new Event,n.loadingItems=new Event,n.loadedItems=new Event,n.itemChecked=new Event,n.checkedItemsChanged=new Event,n.formatItem=new Event(function(){n.invalidate()}),n.applyTemplate("wj-control wj-content wj-listbox",null,null);var s=n.hostElement;return setAttribute(s,"role","listbox",!0),"SELECT"==n._orgTag&&n._initFromSelect(n.hostElement),n.addEventListener(s,"click",n._click.bind(n)),n.addEventListener(s,"keydown",n._keydown.bind(n)),n.addEventListener(s,"keypress",n._keypress.bind(n)),n.addEventListener(s,"wheel",function(e){s.scrollHeight>s.offsetHeight&&(e.deltaY<0&&0==s.scrollTop||e.deltaY>0&&s.scrollTop+s.offsetHeight>=s.scrollHeight)&&e.preventDefault()}),n.initialize(i),n}return __extends(t,e),Object.defineProperty(t.prototype,"itemsSource",{get:function(){return this._items},set:function(e){this._items!=e&&(this._cv&&(this._cv.currentChanged.removeHandler(this._cvCurrentChanged,this),this._cv.collectionChanged.removeHandler(this._cvCollectionChanged,this),this._cv=null),this._items=e,this._cv=asCollectionView(e),null!=this._cv&&(this._cv.currentChanged.addHandler(this._cvCurrentChanged,this),this._cv.collectionChanged.addHandler(this._cvCollectionChanged,this)),this._populateList(),this.onItemsChanged(),this.onSelectedIndexChanged())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"collectionView",{get:function(){return this._cv},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"showGroups",{get:function(){return this._shGroups},set:function(e){e!=this._shGroups&&(this._shGroups=asBoolean(e),this._populateList())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isContentHtml",{get:function(){return this._html},set:function(e){e!=this._html&&(this._html=asBoolean(e),this._populateList())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"itemFormatter",{get:function(){return this._itemFormatter},set:function(e){e!=this._itemFormatter&&(this._itemFormatter=asFunction(e),this._populateList())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"displayMemberPath",{get:function(){return this._pathDisplay.path},set:function(e){e!=this.displayMemberPath&&(this._pathDisplay.path=asString(e),this._populateList())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"selectedValuePath",{get:function(){return this._pathValue.path},set:function(e){this._pathValue.path=asString(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"checkedMemberPath",{get:function(){return this._pathChecked.path},set:function(e){e!=this.checkedMemberPath&&(this._pathChecked.path=asString(e),this._populateList())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"itemRole",{get:function(){return this._itemRole},set:function(e){e!=this.itemRole&&(this._itemRole=asString(e),this._populateList())},enumerable:!0,configurable:!0}),t.prototype.getDisplayValue=function(e){var t=null;e>-1&&hasItems(this._cv)&&(t=this._cv.items[e],this.displayMemberPath&&(t=this._pathDisplay.getValue(t)));var i=null!=t?t.toString():"";return this._itemFormatter&&(i=this._itemFormatter(e,i)),i},t.prototype.getDisplayText=function(e){var t=this._getChild(e);return null!=t?t.textContent:""},t.prototype.isItemEnabled=function(e){var t=this._getChild(e);return null!=t&&!t.hasAttribute("disabled")&&!hasClass(t,"wj-state-disabled")&&!hasClass(t,"wj-separator")},Object.defineProperty(t.prototype,"selectedIndex",{get:function(){return this._cv?this._cv.currentPosition:-1},set:function(e){this._cv&&this._cv.moveCurrentToPosition(asNumber(e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"selectedItem",{get:function(){return this._cv?this._cv.currentItem:null},set:function(e){this._cv&&this._cv.moveCurrentTo(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"selectedValue",{get:function(){var e=this.selectedItem;return e&&this.selectedValuePath&&(e=this._pathValue.getValue(e)),e},set:function(e){var t=this.selectedValuePath,i=-1;if(this._cv){for(var n=0;n<this._cv.items.length;n++){var s=this._cv.items[n],o=t?this._pathValue.getValue(s):s;if(o===e||DateTime.equals(o,e)){i=n;break}}this.selectedIndex=i}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxHeight",{get:function(){var e=this.hostElement;return e?parseFloat(e.style.maxHeight):null},set:function(e){var t=this.hostElement;t&&(t.style.maxHeight=asNumber(e)+"px")},enumerable:!0,configurable:!0}),t.prototype.showSelection=function(e){var t=this.selectedIndex,i=this.hostElement,n=i.children;t=this._getElementIndex(t);for(var s=0;s<n.length;s++){var o=n[s],r=s==t;toggleClass(o,"wj-state-selected",r),setAttribute(o,"aria-selected",r),o.tabIndex=r?this._orgTabIndex:-1}if(t>-1&&t<n.length){var a=(o=n[t]).getBoundingClientRect(),l=i.getBoundingClientRect(),h=0;if(this._shGroups){var c=n[0];hasClass(c,"wj-header")&&(h=c.offsetHeight)}a.bottom>l.bottom?i.scrollTop+=a.bottom-l.bottom:a.top<l.top+h&&(i.scrollTop-=l.top+h-a.top)}t>-1&&(null==e&&(e=this.containsFocus()),e&&(o=n[t])instanceof HTMLElement&&!contains(o,getActiveElement())&&o.focus());i.tabIndex=t<0?this._orgTabIndex:-1},t.prototype.loadList=function(){this._populateList()},t.prototype.getItemChecked=function(e){var t=this._cv.items[e],i=this._pathChecked;if(isObject(t)&&i.path)return i.getValue(t);var n=this._getCheckbox(e);return!!n&&n.checked},t.prototype.setItemChecked=function(e,t){this._setItemChecked(e,t,!0)},t.prototype.toggleItemChecked=function(e){this.setItemChecked(e,!this.getItemChecked(e))},Object.defineProperty(t.prototype,"checkedItems",{get:function(){if(this._checkedItems.splice(0,this._checkedItems.length),this._cv)for(var e=0;e<this._cv.items.length;e++)this.getItemChecked(e)&&this._checkedItems.push(this._cv.items[e]);return this._checkedItems},set:function(e){var t=this._cv,i=this.hostElement,n=asArray(e,!1),s=!1;if(t&&n){for(var o=t.currentPosition,r=i.scrollTop,a=0;a<t.items.length;a++){var l=t.items[a];this._setItemChecked(a,n.indexOf(l)>-1,!1)&&(s=!0)}t.moveCurrentToPosition(o),i.scrollTop=r,s&&this.onCheckedItemsChanged()}},enumerable:!0,configurable:!0}),t.prototype.indexOf=function(e){if(this._shGroups&&hasClass(e,"wj-header"))return-1;for(var t=this.hostElement.children,i=0,n=0;i<t.length;i++){var s=t[i];if(contains(t[i],e))return n;this._shGroups&&hasClass(s,"wj-header")||n++}return-1},t.prototype.onSelectedIndexChanged=function(e){this.selectedIndexChanged.raise(this,e)},t.prototype.onItemsChanged=function(e){this.itemsChanged.raise(this,e)},t.prototype.onLoadingItems=function(e){this.loadingItems.raise(this,e)},t.prototype.onLoadedItems=function(e){this.loadedItems.raise(this,e)},t.prototype.onItemChecked=function(e){this.itemChecked.raise(this,e)},t.prototype.onCheckedItemsChanged=function(e){this.checkedItemsChanged.raise(this,e)},t.prototype.onFormatItem=function(e){this.formatItem.raise(this,e)},t.prototype.refresh=function(t){void 0===t&&(t=!0),e.prototype.refresh.call(this,t);var i=this._cv?this._cv.items.length:0,n=this.formatItem.handlerCount;i==this._itemCount&&n==this._fmtItemHandlers||(this._fmtItemHandlers=n,this._populateList())},t.prototype._getChild=function(e){return e=this._getElementIndex(e),this.hostElement.children[e]},t.prototype._getElementIndex=function(e){if(this._shGroups)for(var t=this.hostElement.children,i=0;i<=e&&i<t.length;i++){var n=t[i];hasClass(n,"wj-header")&&e++}return e},t.prototype._setItemChecked=function(e,t,i){void 0===i&&(i=!0);var n=this._cv.items[e],s=this._pathChecked,o=!1;if(isObject(n)&&s.path){var r=tryCast(this._cv,"IEditableCollectionView");s.getValue(n)!=t&&(o=!0,this._checking=!0,r?(r.editItem(n),s.setValue(n,t),r.commitEdit()):(s.setValue(n,t),this._cv.refresh()),this._checking=!1)}else o=!0;var a=this._getCheckbox(e);if(a){a.checked=t;var l=closest(a,".wj-listbox-item");l&&toggleClass(l,"wj-state-checked",t)}return i&&o&&(this.onItemChecked(),this.onCheckedItemsChanged()),o},t.prototype._cvCollectionChanged=function(e,t){this._checking||(this._populateList(),this.onItemsChanged())},t.prototype._cvCurrentChanged=function(e,t){this._checking||(this.showSelection(),this.onSelectedIndexChanged())},t.prototype._populateList=function(){var e=this.hostElement;if(this._itemCount=this._cv?this._cv.items.length:0,e){var t=this.containsFocus(),i=-1,n=void 0;this.onLoadingItems(),e.textContent="",e.scrollTop=0;var s=this._cv;if(s){var o=[],r=0,a=void 0;if(i=s.currentPosition,this._shGroups&&s.groups&&s.groups.length){n={};for(var l=0;l<s.groups.length;l++){var h=s.groups[l];n[r]=h,a=this._createHeaderItem(h),o.push(a);for(var c=0;c<h.items.length;c++,r++)a=this._createItem(r),o.push(a)}}else for(c=0;c<s.items.length;c++,r++)a=this._createItem(r),o.push(a);e.innerHTML=o.join("")}if(this.formatItem.hasHandlers&&s){var u=e.children,p=s.items,d=(r=0,new FormatItemEventArgs(0,null,null));for(c=0;c<u.length;c++)d._item=u[c],this._shGroups&&hasClass(d._item,"wj-header")?(d._index=-1,d._data=n[r]):(d._index=r,d._data=p[r],r++),this.onFormatItem(d)}if(0==e.children.length&&e.appendChild(document.createElement("div")),e.tabIndex=i<0?this._orgTabIndex:-1,t)(i>=0?e.children[this._getElementIndex(i)]:e).focus();else i>0&&this.showSelection();this.onLoadedItems()}},t.prototype._createItem=function(e){var t=this._cv.items[e],i=e==this._cv.currentPosition,n=this.getDisplayValue(e);1!=this._html&&(n=escapeHtml(n));var s=!1;this.checkedMemberPath&&(n='<label><input tabindex="-1" type="checkbox"'+((s=this._pathChecked.getValue(t))?" checked":"")+"> "+n+"</label>");var o="wj-listbox-item";if(i&&(o+=" wj-state-selected"),s&&(o+=" wj-state-checked"),this._html){var r=["wj-separator","wj-state-disabled"];if(n.indexOf(r[0])>-1||n.indexOf(r[1])>-1){var a=createElement(n);r.forEach(function(e){hasClass(a,e)&&(o+=" "+e)})}}return'<div class="'+o+'" role="'+this.itemRole+'" aria-selected="'+i+'" tabindex="'+(i?this._orgTabIndex:-1)+'">'+n+"</div>"},t.prototype._createHeaderItem=function(e){return'<div class="wj-listbox-item wj-header wj-state-disabled" role="presentation" tabindex="-1">'+escapeHtml(e.name)+"</div>"},t.prototype._click=function(e){if(0==e.button&&!e.defaultPrevented){var t=this.indexOf(e.target);if(t>-1&&(this.selectedIndex=t,this.checkedMemberPath)){var i=this._getCheckbox(t),n=this.hostElement.children[t];i!=e.target&&e.target!=n||(n.focus({preventScroll:!0}),this.setItemChecked(t,i.checked))}}},t.prototype._keydown=function(e){var t=this.selectedIndex;this.hostElement.children;if(!e.defaultPrevented){if(65==e.keyCode&&(e.ctrlKey||e.metaKey)&&this.checkedMemberPath&&hasItems(this.collectionView))return this.checkedItems=this.getItemChecked(0)?[]:this.collectionView.items,void e.preventDefault();if(!(e.ctrlKey||e.shiftKey||e.altKey||e.metaKey))switch(e.keyCode){case Key.Down:e.preventDefault(),this._selectNext();break;case Key.Up:e.preventDefault(),this._selectPrev();break;case Key.Home:e.preventDefault(),this._selectFirst();break;case Key.End:e.preventDefault(),this._selectLast();break;case Key.PageDown:e.preventDefault(),this._selectNextPage();break;case Key.PageUp:e.preventDefault(),this._selectPrevPage();break;case Key.Space:if(this.checkedMemberPath&&t>-1){var i=this._getCheckbox(t);i&&this.isItemEnabled(t)&&(this.setItemChecked(t,!i.checked),e.preventDefault())}}}},t.prototype._keypress=function(e){var t=this;if(!e.defaultPrevented&&!(e.target instanceof HTMLInputElement)&&(e.charCode>32||32==e.charCode&&this._search)){e.preventDefault(),this._search+=String.fromCharCode(e.charCode).toLowerCase(),this._toSearch&&clearTimeout(this._toSearch),this._toSearch=setTimeout(function(){t._toSearch=null,t._search=""},Control._SEARCH_DELAY);var i=this._findNext();i<0&&this._search.length>1&&(this._search=this._search[this._search.length-1],i=this._findNext()),i>-1&&(this.selectedIndex=i)}},t.prototype._selectNext=function(){for(var e=this.hostElement.children.length,t=this.selectedIndex+1;t<e;t++)if(this.isItemEnabled(t))return this.selectedIndex=t,!0;return!1},t.prototype._selectPrev=function(){for(var e=this.selectedIndex-1;e>=0;e--)if(this.isItemEnabled(e))return this.selectedIndex=e,!0;return!1},t.prototype._selectFirst=function(){for(var e=this.hostElement.children.length,t=0;t<e;t++)if(this.isItemEnabled(t))return this.selectedIndex=t,!0;return!1},t.prototype._selectLast=function(){for(var e=this.hostElement.children.length-1;e>=0;e--)if(this.isItemEnabled(e))return this.selectedIndex=e,!0;return!1},t.prototype._selectNextPage=function(){for(var e=this.hostElement,t=e.offsetHeight,i=e.children,n=0,s=this.selectedIndex+1;s<this._cv.items.length;s++){var o=i[s].scrollHeight;if(n+o>t&&this.isItemEnabled(s))return this.selectedIndex=s,!0;n+=o}return this._selectLast()},t.prototype._selectPrevPage=function(){for(var e=this.hostElement,t=e.offsetHeight,i=e.children,n=0,s=this.selectedIndex-1;s>0;s--){var o=i[s].scrollHeight;if(n+o>t&&this.isItemEnabled(s))return this.selectedIndex=s,!0;n+=o}return this._selectFirst()},t.prototype._findNext=function(){if(this.hostElement){var e=this.hostElement.childElementCount,t=this.selectedIndex;(t<0||1==this._search.length)&&t++;for(var i=0;i<e;i++){var n=(t+i)%e;if(0==this.getDisplayText(n).trim().toLowerCase().indexOf(this._search)&&this.isItemEnabled(n))return n}}return-1},t.prototype._getCheckbox=function(e){var t=this.hostElement,i=t?t.children:null;return e=this._getElementIndex(e),t&&e>-1&&e<i.length?i[e].querySelector("input[type=checkbox]"):null},t.prototype._initFromSelect=function(e){for(var t=e.children,i=[],n=-1,s=0;s<t.length;s++){var o=t[s];"OPTION"==o.tagName&&(o.hasAttribute("selected")&&(n=i.length),o.innerHTML?i.push({hdr:o.innerHTML,val:o.getAttribute("value"),cmdParam:o.getAttribute("cmd-param")}):i.push({hdr:'<div class="wj-separator"></div>'}),e.removeChild(o),s--)}i&&(this.displayMemberPath="hdr",this.selectedValuePath="val",this.itemsSource=i,this.selectedIndex=n)},t}(Control);export{ListBox};var FormatItemEventArgs=function(e){function t(t,i,n){var s=e.call(this)||this;return s._index=asNumber(t),s._data=i,s._item=asType(n,HTMLElement,!0),s}return __extends(t,e),Object.defineProperty(t.prototype,"index",{get:function(){return this._index},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"data",{get:function(){return this._data},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"item",{get:function(){return this._item},enumerable:!0,configurable:!0}),t}(EventArgs);export{FormatItemEventArgs};_addCultureInfo("Calendar",{ariaLabels:{calendar:"Calendar",monthView:"Month View",yearView:"Year View",prvMo:"Previous Month",today:"Today",nxtMo:"Next Month",prvYr:"Previous Year",currMo:"Current Month",nxtYr:"Next Year"}});export var DateSelectionMode;!function(e){e[e.None=0]="None",e[e.Day=1]="Day",e[e.Month=2]="Month"}(DateSelectionMode||(DateSelectionMode={}));var Calendar=function(e){function t(t,i){var n=e.call(this,t,null,!0)||this;n._readOnly=!1,n._selMode=DateSelectionMode.Day,n._yrPicker=!0,n._tmYrHidden=0,n._fmtYrMo="y",n._fmtYr="yyyy",n._fmtDayHdr="ddd",n._fmtDay="d ",n._fmtMonths="MMM",n.valueChanged=new Event,n.displayMonthChanged=new Event,n.formatItem=new Event(function(){n.invalidate()});var s=n.hostElement;s.tabIndex=-1,n._value=DateTime.newDate(),n._currMonth=n._getMonth(n._value),n._createChildren(),n._createYearPicker();var o=n.addEventListener.bind(n);return o(s,"keydown",n._keydown.bind(n)),o(s,"click",n._click.bind(n)),n._rptUp=new _ClickRepeater(n._btnPrv),n._rptDn=new _ClickRepeater(n._btnNxt),n.addEventListener(s,"wheel",function(e){if(!e.defaultPrevented&&!n.isReadOnly&&n.containsFocus()){clamp(-e.deltaY,-1,1);e.deltaY<0?n._btnPrv.click():n._btnNxt.click(),e.preventDefault()}}),n.initialize(i),n.refresh(!0),n}return __extends(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this._value},set:function(e){e=asDate(e,!0),e=this._clamp(e),(this._valid(e)||null==e)&&(this.displayMonth=this._getMonth(e),DateTime.equals(this._value,e)||(this._value=e,this.invalidate(!1),this.onValueChanged()))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"min",{get:function(){return this._min},set:function(e){e!=this.min&&(this._min=asDate(e,!0),this.refresh())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"max",{get:function(){return this._max},set:function(e){e!=this.max&&(this._max=asDate(e,!0),this.refresh())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"selectionMode",{get:function(){return this._selMode},set:function(e){if((e=asEnum(e,DateSelectionMode))!=this._selMode){this._selMode=e;var t=this._monthMode();t&&(this.monthView=!1);var i=this._btnMth.querySelector(".wj-glyph-down");i&&(i.style.display=t?"none":""),this.refresh()}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isReadOnly",{get:function(){return this._readOnly},set:function(e){this._readOnly=asBoolean(e),toggleClass(this.hostElement,"wj-state-readonly",this.isReadOnly)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"repeatButtons",{get:function(){return!this._rptUp.disabled},set:function(e){this._rptUp.disabled=this._rptDn.disabled=!asBoolean(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"showYearPicker",{get:function(){return this._yrPicker},set:function(e){this._yrPicker=asBoolean(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"firstDayOfWeek",{get:function(){return this._fdw},set:function(e){if(e!=this._fdw){if((e=asNumber(e,!0))&&(e>6||e<0))throw"firstDayOfWeek must be between 0 and 6 (Sunday to Saturday).";this._fdw=e,this.refresh()}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"displayMonth",{get:function(){return this._currMonth},set:function(e){DateTime.equals(this.displayMonth,e)||(e=asDate(e),(this.monthView?this._monthInValidRange(e):this._yearInValidRange(e))&&(this._currMonth=this._getMonth(this._clamp(e)),this.invalidate(!0),this.onDisplayMonthChanged()))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"formatYearMonth",{get:function(){return this._fmtYrMo},set:function(e){e!=this._fmtYrMo&&(this._fmtYrMo=asString(e),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"formatDayHeaders",{get:function(){return this._fmtDayHdr},set:function(e){e!=this._fmtDayHdr&&(this._fmtDayHdr=asString(e),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"formatDays",{get:function(){return this._fmtDay},set:function(e){e!=this._fmtDay&&(this._fmtDay=asString(e),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"formatYear",{get:function(){return this._fmtYr},set:function(e){e!=this._fmtYr&&(this._fmtYr=asString(e),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"formatMonths",{get:function(){return this._fmtMonths},set:function(e){e!=this._fmtMonths&&(this._fmtMonths=asString(e),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"showHeader",{get:function(){return"none"!=this._tbHdr.style.display},set:function(e){this._tbHdr.style.display=asBoolean(e)?"":"none"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"monthView",{get:function(){return"none"!=this._tbMth.style.display},set:function(e){if(e!=this.monthView){this._tbMth.style.display=e?"":"none",this._tbYr.style.display=e?"none":"",this.refresh();var t=culture.Calendar.ariaLabels;setAriaLabel(this._btnPrv,e?t.prvMo:t.prvYr),setAriaLabel(this._btnTdy,e?t.today:t.currMo),setAriaLabel(this._btnNxt,e?t.nxtMo:t.nxtYr),setAriaLabel(this._btnMth,e?t.monthView:t.yearView)}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"itemFormatter",{get:function(){return this._itemFormatter},set:function(e){e!=this._itemFormatter&&(this._itemFormatter=asFunction(e),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"itemValidator",{get:function(){return this._itemValidator},set:function(e){e!=this._itemValidator&&(this._itemValidator=asFunction(e),this.invalidate())},enumerable:!0,configurable:!0}),t.prototype.onValueChanged=function(e){this.valueChanged.raise(this,e)},t.prototype.onDisplayMonthChanged=function(e){this.displayMonthChanged.raise(this,e)},t.prototype.onFormatItem=function(e){this.formatItem.raise(this,e)},t.prototype.containsFocus=function(){return e.prototype.containsFocus.call(this)||this._lbYears.containsFocus()},t.prototype.dispose=function(){this._rptUp.element=null,this._rptDn.element=null,this._lbYears.dispose(),e.prototype.dispose.call(this)},t.prototype.refresh=function(t){void 0===t&&(t=!0);var i,n,s,o=this.displayMonth,r=null!=this.firstDayOfWeek?this.firstDayOfWeek:Globalize.getFirstDayOfWeek(),a=this.hostElement,l=getActiveElement(),h=this.containsFocus(),c=contains(a,l)?l:null;e.prototype.refresh.call(this,t),this._firstDay=DateTime.addDays(o,-(o.getDay()-r+7)%7),setText(this._spMth,Globalize.format(o,this._fmtYrMo)),i=this._tbMth.querySelectorAll("td");for(var u=0;u<7&&u<i.length;u++)s=DateTime.addDays(this._firstDay,u),setText(i[u],Globalize.format(s,this._fmtDayHdr));for(u=7;u<i.length;u++){n=i[u],s=DateTime.addDays(this._firstDay,u-7),setText(n,Globalize.format(s,this._fmtDay));var p=!this._valid(s),d=this._selMode&&DateTime.sameDate(s,this.value),f=s.getDay();if(toggleClass(n,"wj-state-invalid",p),toggleClass(n,"wj-state-selected",d),toggleClass(n,"wj-day-weekend",0==f||6==f),toggleClass(n,"wj-day-today",DateTime.sameDate(s,DateTime.newDate())),toggleClass(n,"wj-day-othermonth",p||s.getMonth()!=o.getMonth()||!this._inValidRange(s)),setAttribute(n,"aria-selected",d),n.tabIndex=-1,this.itemFormatter&&this.itemFormatter(s,n),this.formatItem.hasHandlers){var m=new FormatItemEventArgs(u,s,n);this.onFormatItem(m)}}var _=this._tbMth.querySelectorAll("tr");_.length&&(s=DateTime.addDays(this._firstDay,28),_[_.length-2].style.display=s.getMonth()==o.getMonth()?"":"none",s=DateTime.addDays(this._firstDay,35),_[_.length-1].style.display=s.getMonth()==o.getMonth()?"":"none"),(i=this._tbYr.querySelectorAll("td")).length&&setText(i[0],Globalize.format(o,this._fmtYr));for(u=1;u<i.length;u++){s=DateTime.newDate(o.getFullYear(),u-1,1);p=!this._monthInValidRange(s),d=this._sameMonth(s,this.value);n=i[u],setText(n,Globalize.format(s,this._fmtMonths)),toggleClass(n,"wj-state-disabled",p),toggleClass(n,"wj-state-selected",d),setAttribute(n,"aria-selected",d),n.tabIndex=-1}var b=(this.monthView?this._tbMth:this._tbYr).querySelector("td.wj-state-selected")||a;b.tabIndex=this._orgTabIndex,h&&(c&&c!=b&&(c.tabIndex=-1),b.focus())},t.prototype._canChangeValue=function(){return!this._readOnly&&this._selMode!=DateSelectionMode.None},t.prototype._valid=function(e){return!!isDate(e)&&(!!DateTime.sameDate(e,this._clamp(e))&&(!isFunction(this.itemValidator)||this.itemValidator(e)))},t.prototype._inValidRange=function(e){return!(this.min&&e<DateTime.fromDateTime(this.min,e))&&!(this.max&&e>DateTime.fromDateTime(this.max,e))},t.prototype._monthInValidRange=function(e){if(this.min||this.max){var t=e.getFullYear(),i=e.getMonth(),n=DateTime.newDate(t,i,1),s=DateTime.newDate(t,i+1,0);if(this.min&&this.min>s)return!1;if(this.max&&this.max<n)return!1}return!0},t.prototype._yearInValidRange=function(e){if(this.min||this.max){var t=e.getFullYear(),i=DateTime.newDate(t,0,1),n=DateTime.newDate(t,11,31);if(this.min&&this.min>n)return!1;if(this.max&&this.max<i)return!1}return!0},t.prototype._sameMonth=function(e,t){return isDate(e)&&isDate(t)&&e.getMonth()==t.getMonth()&&e.getFullYear()==t.getFullYear()},t.prototype._getValidDate=function(e,t){if(isDate(e))for(var i=e.getFullYear(),n=e.getMonth()+(t?0:1),s=t?1:0,o=DateTime.newDate(i,n,s),r=t?1:-1,a=0;a<31;a++){if(this._valid(o))return o;o=DateTime.addDays(o,r)}return null},t.prototype._clamp=function(e){if(e){if(this.min){var t=DateTime.fromDateTime(this.min,e);e<t&&(e=t)}if(this.max){var i=DateTime.fromDateTime(this.max,e);e>i&&(e=i)}}return e},t.prototype._createChildren=function(){var e=this.getTemplate();this.applyTemplate("wj-control wj-calendar",e,{_tbHdr:"tbl-header",_btnMth:"btn-month",_spMth:"span-month",_btnPrv:"btn-prev",_btnTdy:"btn-today",_btnNxt:"btn-next",_tbMth:"tbl-month",_tbYr:"tbl-year"});var t=culture.Calendar.ariaLabels;setAriaLabel(this._tbMth,t.calendar),setAriaLabel(this._tbYr,t.calendar),setAriaLabel(this._btnPrv,t.calendar),setAriaLabel(this._btnMth,t.monthView),setAriaLabel(this._btnPrv,t.prvMo),setAriaLabel(this._btnTdy,t.today),setAriaLabel(this._btnNxt,t.nxtMo);for(var i=this._createElement("tr",this._tbMth,"wj-header"),n=0;n<7;n++)this._createElement("td",i);for(var s=0;s<6;s++){i=this._createElement("tr",this._tbMth);for(n=0;n<7;n++)this._createElement("td",i)}i=this._createElement("tr",this._tbYr,"wj-header"),this._createElement("td",i).setAttribute("colspan","4");for(var o=0;o<3;o++){i=this._createElement("tr",this._tbYr);for(var r=0;r<4;r++)this._createElement("td",i)}},t.prototype._createYearPicker=function(){var e=this,t=this.hostElement,i=this._createElement("div",null,"wj-dropdown-panel wj-yearpicker");i.tabIndex=this._orgTabIndex,this._lbYears=new ListBox(i,{lostFocus:function(t,n){if(hidePopup(i),e._tmYrHidden=Date.now(),e.removeEventListener(window,"touchstart"),t.selectedIndex>-1){var s=DateTime.clone(e.displayMonth);s.setFullYear(t.selectedIndex+t.itemsSource[0]),e.displayMonth=s}}}),this.addEventListener(i,"keydown",function(i){switch(i.keyCode){case Key.Enter:t.focus();break;case Key.Escape:e._lbYears.selectedIndex=-1,t.focus()}i.defaultPrevented&&i.stopPropagation()}),this.addEventListener(i,"click",function(e){t.focus()})},t.prototype._createElement=function(e,t,i){var n=document.createElement(e);if(n.tabIndex=-1,i&&addClass(n,i),"TD"==n.tagName){var s=closest(n,".wj-header")?"columnheader":"gridcell";setAttribute(n,"role",s),setAttribute(n,"aria-selected",!1)}return t&&t.appendChild(n),n},t.prototype._click=function(e){var t=this;if(!e.defaultPrevented&&0==e.button){var i=!1,n=e.target;if(contains(this._btnMth,n)&&!this._monthMode()?(this.monthView=!this.monthView,i=!0):contains(this._btnPrv,n)?(this._navigate(-1),i=!0):contains(this._btnNxt,n)?(this._navigate(1),i=!0):contains(this._btnTdy,n)&&(this._navigate(0),i=!0),n&&!i&&this._yrPicker&&contains(this._tbYr,n)&&closest(n,".wj-header")){if(Date.now()-this._tmYrHidden<600)return void e.preventDefault();for(var s=this.displayMonth.getFullYear(),o=this.min?this.min.getFullYear():s-100,r=this.max?this.max.getFullYear():s+100,a=[],l=o;l<=r;l++)a.push(l);var h=this._lbYears,c=h.hostElement,u=closest(n,".wj-header");return h.itemsSource=a,h.selectedIndex=s-a[0],setAttribute(c,"dir",this.rightToLeft?"rtl":null),c.style.minWidth="",showPopup(c,u,!1,!1,this.hostElement),h.focus(),this.addEventListener(window,"touchstart",function(e){contains(c,e.target)||(hidePopup(c),t._tmYrHidden=Date.now(),t.removeEventListener(window,"touchstart"))}),void e.preventDefault()}if(n&&!i){var p,d=closest(n,"TD");if(d)if(this.monthView){if((p=this._getCellIndex(this._tbMth,d))>6&&this._canChangeValue()){var f=DateTime.fromDateTime(DateTime.addDays(this._firstDay,p-7),this.value);this._inValidRange(f)&&this._valid(f)&&(this.value=f),i=!0}}else if((p=this._getCellIndex(this._tbYr,d))>0){if(this.displayMonth=DateTime.newDate(this.displayMonth.getFullYear(),p-1,1),this._monthMode()){if(this._canChangeValue()){f=DateTime.fromDateTime(this.displayMonth,this.value);this._inValidRange(f)&&(this.value=f)}}else this.monthView=!0;i=!0}}i&&(e.preventDefault(),this.focus())}},t.prototype._getCellIndex=function(e,t){for(var i=e.querySelectorAll("TD"),n=0;n<i.length;n++)if(i[n]==t)return n;return-1},t.prototype._keydown=function(e){if(!e.defaultPrevented){if(e.altKey)switch(e.keyCode){case Key.Up:case Key.Down:return;case Key.End:return this._navigate(0),void e.preventDefault()}if(!(e.ctrlKey||e.metaKey||e.shiftKey)){var t=this._getKeyCode(e),i=0,n=0,s=!0;if(this.monthView)switch(t){case Key.Left:i=-1;break;case Key.Right:i=1;break;case Key.Up:i=-7;break;case Key.Down:i=7;break;case Key.PageDown:n=e.altKey?12:1;break;case Key.PageUp:n=e.altKey?-12:-1;break;case Key.Home:case Key.End:if(this._canChangeValue()){var o=this.value||this.displayMonth;(r=this._getValidDate(o,t==Key.Home))&&(this.value=DateTime.fromDateTime(r,this.value))}break;default:s=!1}else switch(t){case Key.Left:n=-1;break;case Key.Right:n=1;break;case Key.Up:n=-4;break;case Key.Down:n=4;break;case Key.PageDown:n=e.altKey?120:12;break;case Key.PageUp:n=e.altKey?-120:-12;break;case Key.Home:n=this.value?-this.value.getMonth():0;break;case Key.End:n=this.value?11-this.value.getMonth():0;break;case Key.Enter:this._monthMode()?s=!1:this.monthView=!0;break;default:s=!1}if(this._canChangeValue()&&(i||n)){var r;if((r=this.value)?(r=DateTime.addDays(r,i),r=DateTime.addMonths(r,n)):r=this._getValidDate(new Date,!0),n&&!this._valid(r)){o=r.getMonth();for(var a=1;a<31&&!this._valid(r);a++){var l=DateTime.addDays(r,+a),h=DateTime.addDays(r,-a);this._valid(l)&&l.getMonth()==o?r=l:this._valid(h)&&h.getMonth()==o&&(r=h)}}for(a=0;a<31&&!this._valid(r);a++)r=DateTime.addDays(r,i>0||n>0?1:-1);this.value=r}s&&e.preventDefault()}}},t.prototype._getMonth=function(e){return e||(e=DateTime.newDate()),DateTime.newDate(e.getFullYear(),e.getMonth(),1)},t.prototype._monthMode=function(){return this.selectionMode==DateSelectionMode.Month},t.prototype._navigate=function(e){var t=this.monthView,i=this.displayMonth;switch(e){case 0:var n=DateTime.newDate();this._canChangeValue()&&(this.value=t?DateTime.fromDateTime(n,this.value):this._getMonth(n)),i=this._getMonth(n);break;case 1:i=DateTime.addMonths(i,t?1:12);break;case-1:i=DateTime.addMonths(i,t?-1:-12)}this.displayMonth=i},t.controlTemplate='<div class="wj-content wj-calendar-outer"><div wj-part="tbl-header" class="wj-calendar-header"><div wj-part="btn-month" class="wj-month-select" role="button"><span wj-part="span-month"></span> <span class="wj-glyph-down"></span></div><div class="wj-btn-group"><button wj-part="btn-prev" class="wj-btn wj-btn-default" tabindex="-1"><span class="wj-glyph-left"></span></button><button wj-part="btn-today" class="wj-btn wj-btn-default" tabindex="-1"><span class="wj-glyph-circle"></span></button><button wj-part="btn-next" class="wj-btn wj-btn-default" tabindex="-1"><span class="wj-glyph-right"></span></button></div></div><table wj-part="tbl-month" class="wj-calendar-month" role="grid"></table><table wj-part="tbl-year" class="wj-calendar-year" role="grid" style="display:none"></table></div>',t}(Control);export{Calendar};_addCultureInfo("DropDown",{ariaLabels:{tgl:"Toggle Dropdown"}});var DropDown=function(e){function t(t,i){var n=e.call(this,t,null,!0)||this;n._showBtn=!0,n._autoExpand=!0,n._animate=!1,n.textChanged=new Event,n.isDroppedDownChanging=new Event,n.isDroppedDownChanged=new Event;var s=n.getTemplate();n.applyTemplate("wj-control wj-content wj-dropdown",s,{_tbx:"input",_btn:"btn",_dropDown:"dropdown"},"input");var o=culture.DropDown.ariaLabels;setAriaLabel(n._btn.querySelector("button"),o.tgl);var r=n._elRef=n._tbx;disableAutoComplete(r),n._createDropDown(),n._updateBtn();var a=n.hostElement;addClass(a,"wj-state-collapsed");var l=n.dropDown,h=n.addEventListener.bind(n),c=n._updateFocusState.bind(n);h(l,"blur",c,!0),h(l,"focus",c);var u=n._keydown.bind(n);return h(a,"keydown",u),h(l,"keydown",u),h(r,"keypress",function(e){9787==e.keyCode&&n._altDown&&e.preventDefault()}),h(r,"keyup",function(e){n._altDown=n._altDown||e.altKey}),h(r,"input",function(){n._setText(n.text,!1)}),h(r,"click",function(){n._autoExpand&&n._expandSelection()}),h(r,"blur",function(){n._commitText()},!0),h(n._btn,"mousedown",function(e){e.defaultPrevented||0!=e.button||(n._btnclick(e),e.preventDefault())}),removeChild(l),isIE()&&n._elRef==n._tbx&&h(a,"mouseup",function(e){if(!e.defaultPrevented&&0==e.button&&hasClass(e.target,"wj-btn")){var t=getActiveElement();t&&t!=e.target&&setTimeout(function(){t.focus()})}}),isIE9()&&h(r,"keyup",function(){n._setText(n.text,!1)}),h(l,"click",n._dropDownClick.bind(n)),n}return __extends(t,e),Object.defineProperty(t.prototype,"text",{get:function(){return this._tbx.value},set:function(e){e!=this.text&&this._setText(e,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inputElement",{get:function(){return this._tbx},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inputType",{get:function(){return this._tbx.type},set:function(e){this._tbx.type=asString(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isReadOnly",{get:function(){return this._tbx.readOnly},set:function(e){this._tbx.readOnly=asBoolean(e),toggleClass(this.hostElement,"wj-state-readonly",this.isReadOnly)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isRequired",{get:function(){return this._tbx.required},set:function(e){this._tbx.required=asBoolean(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"placeholder",{get:function(){return this._tbx.placeholder},set:function(e){this._tbx.placeholder=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isDroppedDown",{get:function(){var e=this._dropDown;return e&&"none"!=e.style.display},set:function(e){var t=this,i=this.hostElement,n=this._dropDown,s=this.containsFocus()||this._setFocus;i&&n&&(e=asBoolean(e)&&!this.isDisabled&&!this.isReadOnly)!=this.isDroppedDown&&this.onIsDroppedDownChanging(new CancelEventArgs)&&(e?(this._minWidthDropdown=n.style.minWidth,n.style.display="block",this._updateDropDown(),this.addEventListener(window,"touchstart",function(e){for(var n=e.target;n;){if(n==i)return;n=n[Control._OWNR_KEY]||n.parentNode}Control._touching=!0,t.isDroppedDown=!1,Control._touching=!1})):(this.removeEventListener(window,"touchstart"),hidePopup(n),n.style.minWidth=this._minWidthDropdown),this._setFocus=!1,s&&(this.isTouching&&this.showDropDownButton?i.focus():this.selectAll()),this._updateFocusState(),toggleClass(i,"wj-state-collapsed",!this.isDroppedDown),this.onIsDroppedDownChanged())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dropDown",{get:function(){return this._dropDown},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dropDownCssClass",{get:function(){return this._cssClass},set:function(e){e!=this._cssClass&&(removeClass(this._dropDown,this._cssClass),this._cssClass=asString(e),addClass(this._dropDown,this._cssClass))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"showDropDownButton",{get:function(){return this._showBtn},set:function(e){this._showBtn=asBoolean(e),this._updateBtn()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"autoExpandSelection",{get:function(){return this._autoExpand},set:function(e){this._autoExpand=asBoolean(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isAnimated",{get:function(){return this._animate},set:function(e){this._animate=asBoolean(e)},enumerable:!0,configurable:!0}),t.prototype.selectAll=function(){var e=this._tbx;this._elRef==e&&setSelectionRange(e,0,this.text.length),this.containsFocus()||this.focus()},t.prototype.onTextChanged=function(e){this.textChanged.raise(this,e),this._updateState()},t.prototype.onIsDroppedDownChanging=function(e){return this.isDroppedDownChanging.raise(this,e),!e.cancel},t.prototype.onIsDroppedDownChanged=function(e){this.isDroppedDownChanged.raise(this,e)},t.prototype.onGotFocus=function(t){this.isTouching||contains(this._dropDown,getActiveElement())||this.selectAll(),e.prototype.onGotFocus.call(this,t)},t.prototype.onLostFocus=function(t){this._commitText(),this.isDroppedDown=!1,e.prototype.onLostFocus.call(this,t)},t.prototype.containsFocus=function(){return e.prototype.containsFocus.call(this)||this.isDroppedDown&&contains(this._dropDown,getActiveElement())},t.prototype.dispose=function(){this.isDroppedDown=!1;var t=this._dropDown;if(t){var i=Control.getControl(t);i&&i.dispose(),removeChild(t),this._dropDown=null}e.prototype.dispose.call(this)},t.prototype.refresh=function(t){if(void 0===t&&(t=!0),e.prototype.refresh.call(this,t),this.hostElement.offsetHeight&&this.isDroppedDown){var i=getActiveElement();this.isAnimated&&""!=this._dropDown.style.opacity||showPopup(this._dropDown,this.hostElement,!1,!1,null==this.dropDownCssClass),i instanceof HTMLElement&&i!=getActiveElement()&&i.focus()}},t.prototype._handleResize=function(){this.isDroppedDown&&this.refresh()},t.prototype._dropDownClick=function(e){e.stopPropagation()},t.prototype._expandSelection=function(){var e=this._tbx,t=e.value,i=e.selectionStart,n=e.selectionEnd;if(t&&i==n){var s=this._getCharType(t,i);if(s>-1){for(;n<t.length&&this._getCharType(t,n)==s;n++);for(;i>0&&this._getCharType(t,i-1)==s;i--);i!=n&&setSelectionRange(e,i,n)}}},t.prototype._getCharType=function(e,t){var i=e[t];return i>="0"&&i<="9"?0:i>="a"&&i<="z"||i>="A"&&i<="Z"?1:-1},t.prototype._keydown=function(e){if(this._altDown=e.altKey,!e.defaultPrevented)switch(e.keyCode){case Key.Tab:case Key.Escape:case Key.Enter:this.isDroppedDown&&(this.isDroppedDown=!1,e.keyCode==Key.Tab||this.containsFocus()||this.focus(),e.preventDefault());break;case Key.F4:case Key.Up:case Key.Down:if(e.keyCode==Key.F4||e.altKey){var t=this.hostElement;t&&t.offsetHeight&&(this.isDroppedDown=!this.isDroppedDown,e.preventDefault())}}},t.prototype._btnclick=function(e){0==e.button&&(this._setFocus=!0,this.isDroppedDown=!this.isDroppedDown)},t.prototype._setText=function(e,t){null==e&&(e=""),(e=e.toString())!=this._tbx.value&&(this._tbx.value=e),e!=this._oldText&&(this._oldText=e,this.onTextChanged())},t.prototype._updateBtn=function(){this._btn.style.display=this._showBtn?"":"none"},t.prototype._createDropDown=function(){},t.prototype._commitText=function(){},t.prototype._updateDropDown=function(){if(this.isDroppedDown){this._commitText();var e=this.dropDown;setAttribute(e,"dir",this.rightToLeft?"rtl":null),showPopup(e,this.hostElement,!1,this._animate,null==this.dropDownCssClass)}},t.controlTemplate='<div class="wj-template"><div class="wj-input"><div class="wj-input-group wj-input-btn-visible"><input wj-part="input" type="text" class="wj-form-control"/><span wj-part="btn" class="wj-input-group-btn"><button class="wj-btn wj-btn-default" tabindex="-1"><span class="wj-glyph-down"></span></button></span></div></div><div wj-part="dropdown" class="wj-content wj-dropdown-panel" style="display:none"></div></div>',t}(Control);export{DropDown};export var PopupTrigger;!function(e){e[e.None=0]="None",e[e.Click=1]="Click",e[e.Blur=2]="Blur",e[e.ClickOrBlur=3]="ClickOrBlur"}(PopupTrigger||(PopupTrigger={}));var Popup=function(e){function t(t,i){var n=e.call(this,t,null,!0)||this;n._showTrigger=PopupTrigger.Click,n._hideTrigger=PopupTrigger.Blur,n._hideAnim=[],n._fadeIn=!0,n._fadeOut=!0,n._removeOnHide=!0,n._visible=!1,n._ownerClickBnd=n._ownerClick.bind(n),n._ownerMousedownBnd=n._ownerMouseDown.bind(n),n.showing=new Event,n.shown=new Event,n.hiding=new Event,n.hidden=new Event;var s=n.hostElement;return addClass(s,"wj-control wj-content wj-popup"),s.getAttribute("tabindex")||(s.tabIndex=0),hidePopup(s,!1),n.addEventListener(s,"compositionstart",function(e){n._composing=!0}),n.addEventListener(s,"compositionend",function(e){n._composing=!1}),n.addEventListener(s,"keydown",function(e){if(!e.defaultPrevented){if(e.keyCode!=Key.Escape||n._composing||(e.preventDefault(),n.hide()),e.keyCode==Key.Enter){var t=n.dialogResultEnter;t&&(e.preventDefault(),n._validateAndHide(t))}e.keyCode==Key.Tab&&n.modal&&(e.preventDefault(),moveFocus(s,e.shiftKey?-1:1))}}),n.addEventListener(s,"click",function(e){if(e.target instanceof HTMLElement){var t=e.target.className.match(/\bwj-hide[\S]*\b/);t&&t.length>0&&(e.preventDefault(),e.stopPropagation(),n.hide(t[0]))}}),n.addEventListener(document,"wheel",function(e){if(n.isVisible&&n._modal){for(var t=e.target;t&&t!=document.body;t=t.parentElement)if(t.scrollHeight>t.clientHeight)return;e.preventDefault()}}),n.initialize(i),n}return __extends(t,e),Object.defineProperty(t.prototype,"owner",{get:function(){return this._owner},set:function(e){var t=this._owner;t&&(this.removeEventListener(t,"mousedown"),this.removeEventListener(t,"click")),(t=this._owner=null!=e?getElement(e):null)&&(this.addEventListener(t,"mousedown",this._ownerMousedownBnd,!0),this.addEventListener(t,"click",this._ownerClickBnd,!0))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"content",{get:function(){return this.hostElement.firstElementChild},set:function(e){e!=this.content&&(this.hostElement.innerHTML="",e instanceof HTMLElement&&this.hostElement.appendChild(e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"showTrigger",{get:function(){return this._showTrigger},set:function(e){this._showTrigger=asEnum(e,PopupTrigger)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hideTrigger",{get:function(){return this._hideTrigger},set:function(e){this._hideTrigger=asEnum(e,PopupTrigger)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fadeIn",{get:function(){return this._fadeIn},set:function(e){this._fadeIn=asBoolean(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fadeOut",{get:function(){return this._fadeOut},set:function(e){this._fadeOut=asBoolean(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"removeOnHide",{get:function(){return this._removeOnHide},set:function(e){this._removeOnHide=asBoolean(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"modal",{get:function(){return this._modal},set:function(e){this._modal=asBoolean(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isDraggable",{get:function(){return this._draggable},set:function(e){this._draggable=asBoolean(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dialogResult",{get:function(){return this._result},set:function(e){this._result=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dialogResultEnter",{get:function(){return this._resultEnter},set:function(e){this._resultEnter=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isVisible",{get:function(){var e=this.hostElement;return this._visible&&null!=e&&e.offsetHeight>0},enumerable:!0,configurable:!0}),t.prototype.show=function(e,t){var i=this;if(!this.isVisible){var n=this.hostElement;this.dialogResult=null,this._callback=null,this._hideAnim.forEach(function(e){clearInterval(e)}),this._hideAnim.length=0;var s=new CancelEventArgs;this.onShowing(s)&&(null!=e&&(this.modal=asBoolean(e)),null!=t&&(this._callback=asFunction(t)),showPopup(n,this._owner,!1,this._fadeIn,!1),this._modal&&this._showBackdrop(),this._composing=!1,this._visible=!0,this.onShown(s),this.modal&&this.addEventListener(window,"focus",function(){i.containsFocus()||moveFocus(n,0)}),this._dragged=!1,this._makeDraggable(this._draggable),this.addEventListener(window,"touchstart",function(e){i._hideTrigger&PopupTrigger.Blur&&!contains(n,e.target,!0)&&i.hide()}),setTimeout(function(){if(!i.isTouching){var e=n.querySelector("input[autofocus]");e&&e.clientHeight>0&&!e.disabled&&e.tabIndex>-1&&!closest(e,"[disabled],.wj-state-disabled")?(e.focus(),e.select()):moveFocus(n,0)}i.containsFocus()||(n.tabIndex=0,n.focus())},200))}},t.prototype.hide=function(e){var t=this;if(this._makeDraggable(!1),this.removeEventListener(window,"touchstart"),this.isVisible){isUndefined(e)||(this.dialogResult=e);var i=new CancelEventArgs;if(this.onHiding(i)){for(var n=this.hostElement.querySelectorAll(".wj-control.wj-dropdown"),s=0;s<n.length;s++){var o=Control.getControl(n[s]);o instanceof DropDown&&(o.isDroppedDown=!1)}var r=this.removeOnHide,a=this.fadeOut;this._bkdrop&&this._hideAnim.push(hidePopup(this._bkdrop,r,a)),this._hideAnim.push(hidePopup(this.hostElement,r,a)),this._visible=!1,this.removeEventListener(window,"focus"),this.containsFocus()&&getActiveElement().blur(),setTimeout(function(){t._updateState(),t.onHidden(i),t._callback&&t._callback(t)})}}},t.prototype.onShowing=function(e){return this.showing.raise(this,e),!e.cancel},t.prototype.onShown=function(e){this.shown.raise(this,e)},t.prototype.onHiding=function(e){return this.hiding.raise(this,e),!e.cancel},t.prototype.onHidden=function(e){this.hidden.raise(this,e)},t.prototype.dispose=function(){this.owner=null,e.prototype.dispose.call(this)},t.prototype.onLostFocus=function(t){this.isVisible&&this._hideTrigger&PopupTrigger.Blur&&(this.containsFocus()||this.hide()),e.prototype.onLostFocus.call(this,t)},t.prototype.refresh=function(t){if(void 0===t&&(t=!0),e.prototype.refresh.call(this,t),this.isVisible&&!this._refreshing){this._refreshing=!0;var i=getActiveElement(),n=this._owner?this._owner.getBoundingClientRect():null;showPopup(this.hostElement,n),this._modal&&i instanceof HTMLElement&&i!=getActiveElement()&&i.focus(),this._refreshing=!1}},t.prototype._makeDraggable=function(e){var i,n,s=this,o=this.hostElement,r=o?o.querySelector(".wj-dialog-header"):null,a=document,l="mousedown",h="mousemove",c="mouseup",u="touchstart",p="touchmove",d="touchend",f=!1,m=function(e){o&&contains(r,e.target)&&!e.button&&(i=new Point(o.offsetLeft,o.offsetTop),n=mouseToPage(e),f=!1,[h,c,p,d].forEach(function(e){s.removeEventListener(a,e)}),[h,p].forEach(function(e){s.addEventListener(a,e,_,!1,!0)}),[c,d].forEach(function(e){s.addEventListener(a,e,b)}))},_=function(e){var r=mouseToPage(e),a=r.x-n.x,l=r.y-n.y;(f||Math.abs(a)+Math.abs(l)>t._DRAG_THRESHOLD)&&(setCss(o,{left:Math.max(i.x+a,50-o.offsetWidth),top:Math.max(i.y+(r.y-n.y),0)}),s._dragged=!0,f=!0)},b=function(e){[h,c,p,d].forEach(function(e){s.removeEventListener(a,e)})};[l,u].forEach(function(e){s.removeEventListener(a,e)}),r&&(setCss(r,{touchAction:e?"none":""}),e&&[l,u].forEach(function(e){s.addEventListener(a,e,m)}))},t.prototype._handleResize=function(){this.isVisible&&!this._dragged&&this.refresh()},t.prototype._ownerClick=function(e){this.isVisible?this._hideTrigger&PopupTrigger.Click&&this.hide():this._showTrigger&PopupTrigger.Click&&(this._wasVisible||this.show())},t.prototype._ownerMouseDown=function(e){this._wasVisible=this.isVisible},t.prototype._showBackdrop=function(){var e=this;this._bkdrop||(this._bkdrop=document.createElement("div"),this._bkdrop.tabIndex=-1,addClass(this._bkdrop,"wj-popup-backdrop"),this.addEventListener(this._bkdrop,"mousedown",function(t){t.preventDefault(),t.stopPropagation(),e.hostElement.focus(),e.hideTrigger&PopupTrigger.Blur&&e.hide()})),setCss(this._bkdrop,{zIndex:Control._POPUP_ZINDEX,display:""});var t=this.hostElement;t.parentElement.insertBefore(this._bkdrop,t)},t.prototype._validateAndHide=function(e){var t=this.hostElement.querySelector(":invalid");t?t.focus():this.hide(e)},t._DRAG_THRESHOLD=6,t}(Control);export{Popup};var InputDate=function(e){function t(t,i){var n=e.call(this,t)||this;if(n._format="d",n.valueChanged=new Event,addClass(n.hostElement,"wj-inputdate"),n._msk=new _MaskProvider(n._tbx),isIE9()||(n.inputType="tel"),n._tbx.type.match(/date/i)&&(n.inputType=""),n.addEventListener(n.hostElement,"wheel",function(e){if(!e.defaultPrevented&&!n.isDroppedDown&&n.containsFocus()&&null!=n.value&&n._canChangeValue()){var t=clamp(-e.deltaY,-1,1);n.value=n.selectionMode==DateSelectionMode.Month?DateTime.addMonths(n.value,t):DateTime.addDays(n.value,t),n.selectAll(),e.preventDefault()}}),n.value=DateTime.newDate(),"INPUT"==n._orgTag){var s=n._tbx.getAttribute("value");s&&(n.value=Globalize.parseDate(s,"yyyy-MM-dd"))}return n.isRequired=!0,n.initialize(i),n}return __extends(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this._value},set:function(e){if(DateTime.equals(this._value,e))this._tbx.value=Globalize.format(e,this.format);else{var t=!this.isRequired||null==e&&null==this.value;e=asDate(e,t),e=this._clamp(e),this._isValidDate(e)?(this._tbx.value=e?Globalize.format(e,this.format):"",e==this._value||DateTime.equals(this._value,e)||(this._value=e,this.onValueChanged())):this._tbx.value=e?Globalize.format(this.value,this.format):"",this._calChanging=!0,this._calendar.value=this.value,this._calChanging=!1,this.text!=this._oldText&&(this._oldText=this.text,this.onTextChanged())}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"text",{get:function(){return this._tbx.value},set:function(e){e!=this.text&&(this._setText(e,!0),this._commitText())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"selectionMode",{get:function(){return this.calendar.selectionMode},set:function(e){this.calendar.selectionMode=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"min",{get:function(){return this._calendar.min},set:function(e){this._calendar.min=asDate(e,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"max",{get:function(){return this._calendar.max},set:function(e){this._calendar.max=asDate(e,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"repeatButtons",{get:function(){return this.calendar.repeatButtons},set:function(e){this.calendar.repeatButtons=asBoolean(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"showYearPicker",{get:function(){return this.calendar.showYearPicker},set:function(e){this.calendar.showYearPicker=asBoolean(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"format",{get:function(){return this._format},set:function(e){e!=this.format&&(this._format=asString(e),this._tbx.value=Globalize.format(this.value,this.format))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"mask",{get:function(){return this._msk.mask},set:function(e){this._msk.mask=asString(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"calendar",{get:function(){return this._calendar},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inputElement",{get:function(){return this._tbx},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inputType",{get:function(){return this._tbx.type},set:function(e){this._tbx.type=asString(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"itemValidator",{get:function(){return this._calendar.itemValidator},set:function(e){e!=this.itemValidator&&(this._calendar.itemValidator=asFunction(e),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"itemFormatter",{get:function(){return this.calendar.itemFormatter},set:function(e){e!=this.itemFormatter&&(this.calendar.itemFormatter=asFunction(e))},enumerable:!0,configurable:!0}),t.prototype.onValueChanged=function(e){this.valueChanged.raise(this,e)},t.prototype.refresh=function(t){void 0===t&&(t=!0),e.prototype.refresh.call(this,t),this.isDroppedDown=!1,this._msk&&this._msk.refresh(),this._calendar&&this._calendar.refresh(),this._tbx.value=Globalize.format(this.value,this.format)},t.prototype.onIsDroppedDownChanged=function(t){e.prototype.onIsDroppedDownChanged.call(this,t),this.isDroppedDown&&(this._calChanged=!1,this.dropDown.focus(),this._calendar.refresh())},t.prototype._createDropDown=function(){var e=this;this._calendar=new Calendar(this._dropDown),this._calendar.valueChanged.addHandler(function(){e._calChanging||(e.value=DateTime.fromDateTime(e._calendar.value,e.value),e._calChanged=!0)}),this.addEventListener(this._dropDown,"click",function(t){var i=t.target;hasClass(i,"wj-state-invalid")||closest(i,".wj-header")&&closest(i,".wj-calendar-year")||(e._calChanged&&!closest(i,".wj-calendar-header")?e.isDroppedDown=!1:(i=closest(i,".wj-btn"))&&"btn-today"==i.getAttribute("wj-part")&&(e.isDroppedDown=!1))})},t.prototype._updateDropDown=function(){this._commitText();var t=this._calendar;t.value=this.value,t.min=this.min,t.max=this.max,this.selectionMode!=DateSelectionMode.Month&&(t.monthView=!0);var i=getComputedStyle(this.hostElement);this._dropDown.style.minWidth=18*parseFloat(i.fontSize)+"px",this._calendar.refresh(),e.prototype._updateDropDown.call(this)},t.prototype._keydown=function(t){if(!(t.defaultPrevented||t.altKey||t.ctrlKey||t.metaKey))switch(t.keyCode){case Key.Enter:this._commitText(),this.selectAll();break;case Key.Escape:this.text=Globalize.format(this.value,this.format),this.selectAll();break;case Key.Up:case Key.Down:if(!this.isDroppedDown&&this.value&&this._canChangeValue()){var i=t.keyCode==Key.Up?1:-1,n=this.selectionMode==DateSelectionMode.Month?DateTime.addMonths(this.value,i):DateTime.addDays(this.value,i);this.value=DateTime.fromDateTime(n,this.value),this.selectAll(),t.preventDefault()}}e.prototype._keydown.call(this,t)},t.prototype._canChangeValue=function(){return!this.isReadOnly&&this.selectionMode!=DateSelectionMode.None},t.prototype._clamp=function(e){return this.calendar._clamp(e)},t.prototype._commitText=function(){var e=this._tbx.value;if(e||this.isRequired){var t=Globalize.parseDate(e,this.format,this.value);t?this.value=DateTime.fromDateTime(t,this.value):this._tbx.value=Globalize.format(this.value,this.format)}else this.value=null},t.prototype._isValidDate=function(e){if(e){if(this._clamp(e)!=e)return!1;if(this.itemValidator&&!this.itemValidator(e))return!1}return!0},t}(DropDown);export{InputDate};var InputColor=function(e){function t(t,i){var n=e.call(this,t)||this;n.valueChanged=new Event,addClass(n.hostElement,"wj-inputcolor");return n._ePreview=createElement('<div class="wj-inputcolorbox"></div>',n.hostElement.firstElementChild),"INPUT"==n._orgTag&&(n._tbx.type="",n._commitText()),n.value="#ffffff",n.isRequired=!0,n.initialize(i),n.addEventListener(n._colorPicker.hostElement,"click",function(e){var t=e.target;t&&"DIV"==t.tagName&&((closest(t,'[wj-part="div-pal"]')||closest(t,'[wj-part="div-pv"]'))&&t.style.backgroundColor&&(n.isDroppedDown=!1))}),n}return __extends(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this._value},set:function(e){e!=this.value&&(!e&&this.isRequired||(this.text=asString(e)))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"text",{get:function(){return this._tbx.value},set:function(e){e!=this.text&&(this._setText(asString(e),!0),this._commitText())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"showAlphaChannel",{get:function(){return this._colorPicker.showAlphaChannel},set:function(e){this._colorPicker.showAlphaChannel=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"palette",{get:function(){return this._colorPicker.palette},set:function(e){this._colorPicker.palette=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"colorPicker",{get:function(){return this._colorPicker},enumerable:!0,configurable:!0}),t.prototype.onValueChanged=function(e){this.valueChanged.raise(this,e)},t.prototype.onIsDroppedDownChanged=function(t){e.prototype.onIsDroppedDownChanged.call(this,t),this.isDroppedDown&&!this.isTouching&&this.selectAll()},t.prototype._createDropDown=function(){var e=this;this._colorPicker=new ColorPicker(this._dropDown),setCss(this._dropDown,{minWidth:420,minHeight:200}),this._colorPicker.valueChanged.addHandler(function(){e.value=e._colorPicker.value})},t.prototype._keydown=function(t){if(!t.defaultPrevented)switch(t.keyCode){case Key.Enter:this._commitText(),this.selectAll();break;case Key.Escape:this.text=this.value,this.selectAll()}e.prototype._keydown.call(this,t)},t.prototype._commitText=function(){if(this.value!=this.text){if(!this.isRequired&&!this.text)return this._value=this.text,void(this._ePreview.style.backgroundColor="");Color.fromString(this.text)?(this._colorPicker.value=this.text,this._value=this._colorPicker.value,this._ePreview.style.backgroundColor=this.value,this.onValueChanged()):this.text=this._value?this._value:""}},t}(DropDown);export{InputColor};var ComboBox=function(e){function t(t,i){var n=e.call(this,t)||this;n._editable=!1,n._trimText=!0,n._delKey=0,n._composing=!1,n._pathHdr=new Binding(null),n._bsCollapse=!0,n._fmtItemHandlers=0,n.itemsSourceChanged=new Event,n.selectedIndexChanged=new Event;var s=n.hostElement;return addClass(s,"wj-combobox"),n.dropDown.id=getUniqueId(s.id+"_dropdown"),n.autoExpandSelection=!1,n.addEventListener(n._tbx,"compositionstart",function(){n._composing=!0}),n.addEventListener(n._tbx,"compositionend",function(){n._composing=!1,setTimeout(function(){n._setText(n.text,!0)})}),n.addEventListener(s,"wheel",n._wheel.bind(n)),"SELECT"==n._orgTag&&n._lbx._initFromSelect(s),n._lbx.loadedItems.addHandler(function(e){n.selectedIndex>-1&&(n.selectedIndex=n._lbx.selectedIndex)}),n.isRequired=!0,n.initialize(i),n}return __extends(t,e),Object.defineProperty(t.prototype,"itemsSource",{get:function(){return this._lbx.itemsSource},set:function(e){this._lbx.itemsSource!=e&&(this._lbx.itemsSource=e,this.onItemsSourceChanged()),this._updateBtn()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"collectionView",{get:function(){return this._lbx.collectionView},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"showGroups",{get:function(){return this._lbx.showGroups},set:function(e){this._lbx.showGroups=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"displayMemberPath",{get:function(){return this._lbx.displayMemberPath},set:function(e){this._lbx.displayMemberPath=e;var t=this.getDisplayText();this.text!=t&&this._setText(t,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"headerPath",{get:function(){return this._pathHdr.path},set:function(e){this._pathHdr.path=asString(e);var t=this.getDisplayText();this.text!=t&&this._setText(t,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"selectedValuePath",{get:function(){return this._lbx.selectedValuePath},set:function(e){this._lbx.selectedValuePath=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isContentHtml",{get:function(){return this._lbx.isContentHtml},set:function(e){if(e!=this.isContentHtml){this._lbx.isContentHtml=asBoolean(e);var t=this.getDisplayText();this.text!=t&&this._setText(t,!0)}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"trimText",{get:function(){return this._trimText},set:function(e){e!=this._trimText&&(this._trimText=asBoolean(e),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"itemFormatter",{get:function(){return this._lbx.itemFormatter},set:function(e){this._lbx.itemFormatter=asFunction(e),this.selectedIndex=this._lbx.selectedIndex},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"formatItem",{get:function(){return this.listBox.formatItem},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"selectedIndex",{get:function(){return this._lbx.selectedIndex},set:function(e){e!=this.selectedIndex&&(this._lbx.selectedIndex=e),e=this.selectedIndex;var t=this.getDisplayText(e);this.text!=t&&this._setText(t,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"selectedItem",{get:function(){return this._lbx.selectedItem},set:function(e){this._lbx.selectedItem=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"selectedValue",{get:function(){return this.collectionView?this._lbx.selectedValue:this.text},set:function(e){this.collectionView?this._lbx.selectedValue=e:null!=e&&(this.text=e.toString())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isEditable",{get:function(){return this._editable},set:function(e){this._editable=asBoolean(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxDropDownHeight",{get:function(){return this._lbx.maxHeight},set:function(e){this._lbx.maxHeight=asNumber(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxDropDownWidth",{get:function(){var e=this._dropDown;return parseInt(e.style.maxWidth)},set:function(e){var t=this._dropDown;t.style.maxWidth=asNumber(e)+"px",t.style.minWidth=""},enumerable:!0,configurable:!0}),t.prototype.getDisplayText=function(e){var t;if(void 0===e&&(e=this.selectedIndex),this.headerPath&&e>-1&&hasItems(this.collectionView)){var i=this.collectionView.items[e];t=null!=(t=i?this._pathHdr.getValue(i):null)?t.toString():"",this.isContentHtml&&(t=toPlainText(t))}else t=this._lbx.getDisplayText(e);return this._trimText?t.trim():t},t.prototype.indexOf=function(e,t){var i=this.collectionView;if(hasItems(i)&&null!=e){var n=this.selectedIndex;if(t&&e==this.getDisplayText(n))return n;e=e.toString().toLowerCase();for(var s=0;s<i.items.length;s++)if(this.listBox.isItemEnabled(s)){var o=this.getDisplayText(s).toLowerCase();if(t){if(o==e)return s}else if(e&&0==o.indexOf(e))return s}}return-1},Object.defineProperty(t.prototype,"listBox",{get:function(){return this._lbx},enumerable:!0,configurable:!0}),t.prototype.onItemsSourceChanged=function(e){this.itemsSourceChanged.raise(this,e)},t.prototype.onSelectedIndexChanged=function(e){this._updateBtn(),this.selectedIndexChanged.raise(this,e)},t.prototype.refresh=function(t){void 0===t&&(t=!0),e.prototype.refresh.call(this,t),hasItems(this.collectionView)&&(this._lbx.refresh(),this.selectedIndex>-1&&(this.selectedIndex=this._lbx.selectedIndex))},t.prototype.onLostFocus=function(t){this._composing&&(this._composing=!1,this._setText(this.text,!0)),this.isEditable&&this.isRequired&&!this.text&&hasItems(this.collectionView)&&(this.selectedIndex=0),e.prototype.onLostFocus.call(this,t)},t.prototype.onIsDroppedDownChanging=function(t){return this.isDroppedDown||hasItems(this.collectionView)?e.prototype.onIsDroppedDownChanging.call(this,t):(t.cancel=!0,!1)},t.prototype.onIsDroppedDownChanged=function(t){e.prototype.onIsDroppedDownChanged.call(this,t),this.isDroppedDown&&(this._fmtItemHandlers=this.formatItem.handlerCount,this._lbx.showSelection()),setAttribute(this.dropDown,"aria-expanded",this.isDroppedDown)},t.prototype._updateBtn=function(){var t=this.collectionView,i=this._tbx,n=this.dropDown.id,s=hasItems(t);e.prototype._updateBtn.call(this),this._btn.style.display=this._showBtn&&null!=t?"":"none",enable(this._btn,s),setAttribute(i,"role",s?"combobox":null),setAttribute(i,"aria-autocomplete",s?"both":null),setAttribute(i,"aria-owns",s&&this.dropDown.parentElement?n:null),setAttribute(this.dropDown,"aria-expanded",!s&&null)},t.prototype._createDropDown=function(){var e=this;this._lbx||(this._lbx=new ListBox(this._dropDown)),this._lbx.maxHeight=200,this._lbx.selectedIndexChanged.addHandler(function(){e._updateBtn();var t=e._lbx.selectedIndex,i=e._lbx.hostElement.children,n=t>-1&&t<i.length?i[t].id:null;setAttribute(e._tbx,"aria-activedescendant",n&&n.length?n:null),e.selectedIndex=t,e.onSelectedIndexChanged()}),this._lbx.itemsChanged.addHandler(function(){e._updateBtn()})},t.prototype._wheel=function(e){if(!e.defaultPrevented&&!this.isDroppedDown&&!this.isReadOnly&&this.containsFocus()&&this.selectedIndex>-1){var t=clamp(-e.deltaY,-1,1);this.selectedIndex=clamp(this.selectedIndex-t,0,this.collectionView.items.length-1),e.preventDefault()}},t.prototype._dropDownClick=function(t){t.defaultPrevented||t.target!=this._dropDown&&(this.isDroppedDown=!1),e.prototype._dropDownClick.call(this,t)},t.prototype._setText=function(t,i){if(!this._composing&&!this._settingText){if(this._settingText=!0,this.containsFocus()){var n=this.formatItem.handlerCount;this._fmtItemHandlers!=n&&(this._fmtItemHandlers=n,this._lbx.loadList())}null==t&&(t=""),t=t.toString();var s=this.selectedIndex,o=this.collectionView,r=this._getSelStart(),a=-1,l=!0;if(this.isEditable&&(this._delKey||this._getSelEnd()<t.length||!this.containsFocus())&&(i=!0,l=!1),s=this.indexOf(t,i),l&&(s<0&&i&&(s=this.indexOf(t,!1)),s<0&&r>0&&(s=this.indexOf(t.substr(0,r),!1))),s<0&&!this.isEditable&&hasItems(o)&&(this.isRequired||t)){var h=this._oldText||"";s=Math.max(0,this.indexOf(h,!1));for(var c=0;c<t.length&&c<h.length;c++)if(t[c]!=h[c]){r=c;break}}s>-1&&(a=r,t=this.getDisplayText(s)),t!=this._tbx.value&&(this._tbx.value=t),a>-1&&this.containsFocus()&&!this.isTouching&&this._updateInputSelection(a),o&&o.moveCurrentToPosition(s),this._delKey=0,this._settingText=!1;var u=this._oldText,p=this.selectedIndex;e.prototype._setText.call(this,t,i),this.text!=u&&this.selectedIndex==p&&p<0&&this.onSelectedIndexChanged()}},t.prototype._findNext=function(e,t){var i=this.selectedIndex,n=this.collectionView,s=n?n.items.length:0,o=this.listBox;if(n&&s&&t){e=e.toLowerCase();for(var r=i+t;r>-1&&r<s;r+=t){if(0==this.getDisplayText(r).toLowerCase().indexOf(e))if(!this.dropDown.children[r]||o.isItemEnabled(r))return r}}return i},t.prototype._keydown=function(t){if(e.prototype._keydown.call(this,t),!t.defaultPrevented&&!this.isReadOnly&&!t.altKey&&hasItems(this.collectionView)&&this._elRef==this._tbx){this._delKey=0;var i=this._getSelStart();switch(t.keyCode){case Key.Back:if(this._bsCollapse&&!this.isEditable){var n=this._getSelEnd();i>0&&n==this._tbx.value.length&&hasItems(this.collectionView)&&this._setSelRange(i-1,n)}this._delKey=t.keyCode;break;case Key.Delete:this._delKey=t.keyCode;break;case Key.Up:case Key.Down:i==this.text.length&&(i=0),this.selectedIndex=this._findNext(this.text.substr(0,i),t.keyCode==Key.Up?-1:1),this._setSelRange(i,this.text.length),t.preventDefault();break;case Key.PageUp:this._lbx._selectPrevPage(),this.selectAll(),t.preventDefault();break;case Key.PageDown:this._lbx._selectNextPage(),this.selectAll(),t.preventDefault()}}},t.prototype._updateInputSelection=function(e){this._elRef==this._tbx&&this._setSelRange(e,this._tbx.value.length)},t.prototype._getSelStart=function(){return this._tbx&&this._tbx.value?this._tbx.selectionStart:0},t.prototype._getSelEnd=function(){return this._tbx&&this._tbx.value?this._tbx.selectionEnd:0},t.prototype._setSelRange=function(e,t){var i=this._tbx;this._elRef!=i||i.readOnly||setSelectionRange(i,e,t)},t}(DropDown);export{ComboBox};_addCultureInfo("MultiSelect",{itemsSelected:"{count:n0} items selected",selectAll:"Select All"});var MultiSelect=function(e){function t(t,i){var n=e.call(this,t)||this;return n._maxHdrItems=2,n._readOnly=!1,n._hdrFmt=culture.MultiSelect.itemsSelected,n.checkedItemsChanged=new Event,addClass(n.hostElement,"wj-multiselect"),n._tbx.readOnly=!0,n.checkedMemberPath=null,n.addEventListener(n.inputElement,"click",function(e){document.elementFromPoint(e.clientX,e.clientY)==n.inputElement&&(n._btnclick(e),e.preventDefault())}),n.addEventListener(n._selectAll,"click",function(e){hasItems(n.collectionView)&&e.target==n._selectAllCheckbox&&(n.checkedItems=e.target.checked?n.collectionView.items:[])}),n.removeEventListener(n.dropDown,"click"),n._updateHeader(),n.listBox.itemsChanged.addHandler(function(){n._updateHeader()}),n.listBox.checkedItemsChanged.addHandler(function(){n._updateHeader(),n.onCheckedItemsChanged()}),n.initialize(i),n}return __extends(t,e),Object.defineProperty(t.prototype,"showSelectAllCheckbox",{get:function(){return""==this._selectAll.style.display},set:function(e){this._selectAll.style.display=asBoolean(e)?"":"none"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"selectAllLabel",{get:function(){return this._selectAllLabel},set:function(e){e!=this._selectAllLabel&&(this._selectAllLabel=asString(e),this.refresh())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"checkedMemberPath",{get:function(){var e=this.listBox.checkedMemberPath;return e!=t._DEF_CHECKED_PATH?e:null},set:function(e){e=asString(e),this.listBox.checkedMemberPath=e||t._DEF_CHECKED_PATH},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxHeaderItems",{get:function(){return this._maxHdrItems},set:function(e){this._maxHdrItems!=e&&(this._maxHdrItems=asNumber(e),this._updateHeader())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"headerFormat",{get:function(){return this._hdrFmt},set:function(e){e!=this._hdrFmt&&(this._hdrFmt=asString(e),this._updateHeader())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"headerFormatter",{get:function(){return this._hdrFormatter},set:function(e){e!=this._hdrFormatter&&(this._hdrFormatter=asFunction(e),this._updateHeader())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"checkedItems",{get:function(){return this.listBox.checkedItems},set:function(e){this.listBox.checkedItems=asArray(e)},enumerable:!0,configurable:!0}),t.prototype.onCheckedItemsChanged=function(e){this.checkedItemsChanged.raise(this,e)},t.prototype.onIsDroppedDownChanged=function(t){e.prototype.onIsDroppedDownChanged.call(this,t),this.isDroppedDown&&this.listBox.focus()},t.prototype._createDropDown=function(){this._selectAll=createElement('<div class="wj-header wj-select-all wj-listbox-item" style="display:none" tabindex="0"><label><input type="checkbox"> <span></span></label></div>',this._dropDown),this._selectAllCheckbox=this._selectAll.querySelector("input[type=checkbox]"),this._selectAllSpan=this._selectAll.querySelector("label>span"),setText(this._selectAllSpan,culture.MultiSelect.selectAll);var t=createElement("<div></div>",this._dropDown);this._lbx=new ListBox(t),e.prototype._createDropDown.call(this),addClass(this.dropDown,"wj-control wj-listbox"),this.dropDown.style.overflow="hidden"},Object.defineProperty(t.prototype,"isReadOnly",{get:function(){return this._readOnly},set:function(e){this._readOnly=asBoolean(e),toggleClass(this.hostElement,"wj-state-readonly",this.isReadOnly)},enumerable:!0,configurable:!0}),t.prototype.refresh=function(t){void 0===t&&(t=!0),e.prototype.refresh.call(this,t),this._updateHeader(),this._selectAllSpan&&setText(this._selectAllSpan,this._selectAllLabel||culture.MultiSelect.selectAll)},t.prototype._setText=function(e,t){},t.prototype._keydown=function(t){e.prototype._keydown.call(this,t),!t.defaultPrevented&&hasItems(this.collectionView)&&t.keyCode>32&&(this.isDroppedDown=!0)},t.prototype._updateHeader=function(){var e=this.checkedItems;if(isFunction(this._hdrFormatter))this.inputElement.value=this._hdrFormatter();else{var t="";if(e.length>0)if(e.length<=this._maxHdrItems){if(this.displayMemberPath){var i=new Binding(this.displayMemberPath);e=e.map(function(e){return i.getValue(e)})}t=e.join(", ")}else t=format(this.headerFormat,{count:e.length});this.inputElement.value=t}var n=null,s=this.collectionView;hasItems(s)&&(0==e.length?n=!1:e.length==s.items.length&&(n=!0)),this._selectAllCheckbox.indeterminate=null==n,null!=n&&(this._selectAllCheckbox.checked=n),this._updateState()},t._DEF_CHECKED_PATH="$checked",t}(ComboBox);export{MultiSelect};var Menu=function(e){function t(t,i){var n=e.call(this,t)||this;n._isButton=!1,n._openOnHover=!1,n._closeOnLeave=!0,n._hoverEnterBnd=n._hoverEnter.bind(n),n._hoverLeaveBnd=n._hoverLeave.bind(n),n._hoverOverBnd=n._hoverOver.bind(n),n.itemClicked=new Event;var s=n.hostElement,o=n._tbx,r=n._lbx,a=n.dropDown;addClass(s,"wj-menu"),o.style.display="none";n._hdr=n._elRef=createElement('<div wj-part="header" class="wj-form-control"/>'),o.parentElement.insertBefore(n._hdr,n._tbx);var l=n._orgOuter.match(/tabindex="?(-?\d+)"?/i);return s.tabIndex=l?parseInt(l[1]):0,n.isRequired=!1,setAttribute(s,"role","menubar",!0),setAttribute(o,"role",null),setAttribute(o,"aria-autocomplete",null),setAttribute(o,"aria-owns",null),setAttribute(a,"role","menu"),r.itemRole="menuitem","SELECT"==n._orgTag&&(n.header=s.getAttribute("header"),n._lbx.itemsSource&&(n.commandParameterPath="cmdParam")),n.isContentHtml=!0,n.maxDropDownHeight=500,n.addEventListener(n._hdr,"click",function(e){e.defaultPrevented||(n._clearHover(),n._isButton?(n.isDroppedDown=!1,n._raiseCommand()):n.isDroppedDown=!n.isDroppedDown)}),r.lostFocus.addHandler(function(){n.containsFocus()||(n.isDroppedDown=!1)}),addClass(a,"wj-menu-items"),r.formatItem.addHandler(n._formatMenuItem.bind(n)),n.initialize(i),n}return __extends(t,e),Object.defineProperty(t.prototype,"header",{get:function(){return this._hdr.innerHTML},set:function(e){this._hdr.innerHTML=asString(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"command",{get:function(){return this._cmd},set:function(e){this._cmd=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"commandPath",{get:function(){return this._cmdPath},set:function(e){this._cmdPath=asString(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"commandParameterPath",{get:function(){return this._cmdParamPath},set:function(e){this._cmdParamPath=asString(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"subItemsPath",{get:function(){return this._subPath},set:function(e){e!=this._subPath&&(this._subPath=e,this.refresh(!0))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"openOnHover",{get:function(){return this._openOnHover},set:function(e){this._openOnHover=asBoolean(e),this._updateHoverEvents()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"closeOnLeave",{get:function(){return this._closeOnLeave},set:function(e){this._closeOnLeave=asBoolean(e),this._updateHoverEvents()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isButton",{get:function(){return this._isButton},set:function(e){this._isButton=asBoolean(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"owner",{get:function(){return this._owner},set:function(e){this._owner=asType(e,HTMLElement,!0),this._enableDisableItems()},enumerable:!0,configurable:!0}),t.prototype.show=function(e){if(!this.isDroppedDown&&(this.selectedIndex=-1,this.onIsDroppedDownChanging(new CancelEventArgs))){var t=this.owner||e.target,i=this.dropDown;t instanceof HTMLElement&&(i[Control._OWNR_KEY]=t),showPopup(i,e,!1,this.isAnimated),this.onIsDroppedDownChanged(),i.focus()}},t.prototype.hide=function(){this.isDroppedDown&&this.onIsDroppedDownChanging(new CancelEventArgs)&&(hidePopup(this.dropDown),this.onIsDroppedDownChanged())},t.prototype.onItemClicked=function(e){this.itemClicked.raise(this,e)},t.prototype.refresh=function(t){void 0===t&&(t=!0),e.prototype.refresh.call(this,t),this._enableDisableItems()},t.prototype.onIsDroppedDownChanged=function(t){e.prototype.onIsDroppedDownChanged.call(this,t),this.isDroppedDown?(this._closing=!0,this._defaultItem=this.selectedItem,this.isRequired=!1,this.selectedIndex=-1,this._enableDisableItems(),this._closing=!1,this.dropDown.focus()):this.selectedItem||(this.selectedItem=this._defaultItem)},t.prototype._updateHoverEvents=function(){var e=this.hostElement,t=this.dropDown,i=this.addEventListener.bind(this),n=this.removeEventListener.bind(this),s="mouseleave";n(e,"mouseenter",this._hoverEnterBnd),n(e,s,this._hoverLeaveBnd),n(t,"mouseover",this._hoverOverBnd),n(t,s,this._hoverLeaveBnd),this._openOnHover&&(i(e,"mouseenter",this._hoverEnterBnd),i(t,"mouseover",this._hoverOverBnd),this._closeOnLeave&&(i(e,s,this._hoverLeaveBnd),i(t,s,this._hoverLeaveBnd)))},t.prototype._getSubItems=function(e){var t=this.subItemsPath,i=e&&t?e[t]:null;return isArray(i)&&i.length?i:null},t.prototype._formatMenuItem=function(e,t){var i=t.item;this._getSubItems(t.data)?addClass(i,"wj-subitems"):"-"==i.innerHTML&&(i.innerHTML="",addClass(i,"wj-separator"))},t.prototype._keydown=function(i){if(!i.defaultPrevented){var n=this._getKeyCode(i);if(this.isDroppedDown)switch(n){case Key.Enter:case Key.Right:if(this._showSubMenu())return void i.preventDefault();break;case Key.Left:var s=Control.getControl(this.owner);if(s instanceof t){var o=s.dropDown,r=s.selectedIndex;return(r>-1?o.children[r]:o).focus(),void i.preventDefault()}}n==Key.Enter&&(this.isDroppedDown?this.getDisplayText(this.selectedIndex)&&this._raiseCommand():(this.isDroppedDown=!0,i.preventDefault()))}e.prototype._keydown.call(this,i)},t.prototype._dropDownClick=function(t){if(!t.defaultPrevented&&t.target!=this.dropDown){if(this._clearHover(),this._showSubMenu())return void t.preventDefault();this.getDisplayText(this.selectedIndex)&&this._raiseCommand()}e.prototype._dropDownClick.call(this,t)},t.prototype._showSubMenu=function(){var e=this,i=this._getSubItems(this.selectedItem);if(!i)return null;var n=this.dropDown.children[this.selectedIndex].getBoundingClientRect(),s=new Point(n.right,n.top);if(0==n.height)return null;var o=this.rightToLeft||"rtl"==this.dropDown.getAttribute("dir");o&&(s.x=n.left);var r=new t(document.createElement("div"),{owner:this.hostElement,itemsSource:i,itemClicked:function(t,i){e.itemClicked.raise(t,i)}});"displayMemberPath,selectedValuePath,isContentHtml,command,commandPath,commandParameterPath,maxDropDownWidth,maxDropDownHeight,dropDownCssClass,isAnimated,subItemsPath,openOnHover,closeOnLeave".split(",").forEach(function(t){r[t]=e[t]});var a=r.dropDown;return setAttribute(a,"dir",o?"rtl":null),r.show(s),a[Control._OWNR_KEY]=this.dropDown,a.focus(),r},t.prototype._raiseCommand=function(e){var i=this.selectedItem,n=this._getSubItems(i),s=this._getCommand(i);if(s&&!n){var o=this._getCommandParm(i);if(!this._canExecuteCommand(s,o))return;this._executeCommand(s,o)}if(this.onItemClicked(e),this.containsFocus()){for(var r=this;r&&r.owner;){var a=Control.getControl(r.owner);if(!(a instanceof t))break;r=a}var l=r.owner;!l&&r.dropDown&&(l=r.dropDown[Control._OWNR_KEY]),r.isDroppedDown=!1,r.focus(),r.containsFocus()||l instanceof HTMLElement&&l.focus()}},t.prototype._getCommand=function(e){var t=e&&this._cmdPath?e[this._cmdPath]:null;return t||this._cmd},t.prototype._getCommandParm=function(e){var t=this._cmdParamPath;return e&&t?e[t]:e},t.prototype._executeCommand=function(e,t){e&&!isFunction(e)&&(e=e.executeCommand),isFunction(e)&&e(t)},t.prototype._canExecuteCommand=function(e,t){if(e){var i=e.canExecuteCommand;if(isFunction(i))return i(t)}return!0},t.prototype._enableDisableItems=function(){if(this.collectionView&&(this._cmd||this._cmdPath))for(var e=this.collectionView.items,t=0;t<e.length;t++){var i=e[t],n=this._getCommand(i);if(n){var s=this._lbx.hostElement.children[t],o=this._getCommandParm(i);toggleClass(s,"wj-state-disabled",!this._canExecuteCommand(n,o))}}},t.prototype._clearHover=function(){this._toHover&&clearTimeout(this._toHover),this._toHover=null},t.prototype._hoverEnter=function(e){var t=this;this._clearHover(),this._toHover=setTimeout(function(){t._toHover=null,t.isDroppedDown=!0},Control._HOVER_DELAY)},t.prototype._hoverLeave=function(e){if(this._clearHover(),this.isDroppedDown){var t=document.elementFromPoint(e.clientX,e.clientY),i=closest(t,".wj-listbox.wj-menu-items"),n=this._subMenu;i||contains(this.hostElement,t)||(this.isDroppedDown=!1,n&&(n.isDroppedDown=!1))}},t.prototype._hoverOver=function(e){var t=this;this._clearHover(),this._toHover=setTimeout(function(){t._toHover=null;var i=t.listBox.indexOf(e.target);i>-1&&(t.selectedIndex=i,t._subMenu=t._showSubMenu())},Control._HOVER_DELAY)},t}(ComboBox);export{Menu};var InputTime=function(e){function t(t,i){var n=e.call(this,t)||this;if(n._format="t",n.valueChanged=new Event,addClass(n.hostElement,"wj-inputtime"),n.isEditable=!0,n._value=DateTime.newDate(),n._msk=new _MaskProvider(n._tbx),isIE9()||(n._tbx.type="tel"),"INPUT"==n._orgTag){var s=n._tbx.getAttribute("value");s&&(n.value=Globalize.parseDate(s,"HH:mm:ss"))}return n.step=15,n.autoExpandSelection=!0,n.initialize(i),n}return __extends(t,e),Object.defineProperty(t.prototype,"inputElement",{get:function(){return this._tbx},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inputType",{get:function(){return this._tbx.type},set:function(e){this._tbx.type=asString(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return this._value},set:function(e){(e=asDate(e,!this.isRequired))&&(e=this._clamp(e)),this._setText(e?Globalize.format(e,this.format):"",!0),this.selectedItem&&this.selectedItem.value&&(e=DateTime.fromDateTime(e,this.selectedItem.value)),e==this._value||DateTime.equals(e,this._value)||(this._value=e,this.onValueChanged())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"text",{get:function(){return this._tbx.value},set:function(e){e!=this.text&&(this._setText(e,!0),this._commitText())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"min",{get:function(){return this._min},set:function(e){this._min=asDate(e,!0),this.isDroppedDown=!1,this._updateItems()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"max",{get:function(){return this._max},set:function(e){this._max=asDate(e,!0),this.isDroppedDown=!1,this._updateItems()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"step",{get:function(){return this._step},set:function(e){this._step=asNumber(e,!0),this.isDroppedDown=!1,this._updateItems()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"format",{get:function(){return this._format},set:function(e){e!=this.format&&(this._format=asString(e),this._tbx.value=Globalize.format(this.value,this.format),hasItems(this.collectionView)&&this._updateItems())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"mask",{get:function(){return this._msk.mask},set:function(e){this._msk.mask=asString(e)},enumerable:!0,configurable:!0}),t.prototype.onValueChanged=function(e){this.valueChanged.raise(this,e)},t.prototype.onItemsSourceChanged=function(t){e.prototype.onItemsSourceChanged.call(this,t),this._hasCustomItems=null!=this.itemsSource},t.prototype.refresh=function(t){void 0===t&&(t=!0),e.prototype.refresh.call(this,t),this.isDroppedDown=!1,this._msk.refresh(),this._tbx.value=Globalize.format(this.value,this.format),this._updateItems()},t.prototype.onSelectedIndexChanged=function(t){if(this.selectedIndex>-1&&!this._settingText){var i=this.value?this.value:DateTime.newDate(),n=null!=this.selectedItem.value?this.selectedItem.value:Globalize.parseDate(this.text,this.format,this.value);this.value=DateTime.fromDateTime(i,n)}e.prototype.onSelectedIndexChanged.call(this,t)},t.prototype._clamp=function(e){return null!=this._min&&this._getTime(e)<this._getTime(this._min)&&(e=DateTime.fromDateTime(e,this._min)),null!=this._max&&this._getTime(e)>this._getTime(this._max)&&(e=DateTime.fromDateTime(e,this._max)),e},t.prototype._wheel=function(t){if(!t.defaultPrevented&&!this.isDroppedDown&&!this.isReadOnly&&this.containsFocus()&&this.selectedIndex<0&&this.value&&isNumber(this.step)&&this.step>0){var i=DateTime.addMinutes(this.value,this.step*clamp(t.deltaY,-1,1));this.value=this._clamp(i),this.selectAll(),t.preventDefault()}e.prototype._wheel.call(this,t)},t.prototype._updateInputSelection=function(t){if(this._delKey)e.prototype._updateInputSelection.call(this,t);else{for(var i=this._tbx.value;t<i.length&&!i[t].match(/[a-z0-9]/i);)t++;setSelectionRange(this._tbx,t,this._tbx.value.length)}},t.prototype._updateItems=function(){if(!this._hasCustomItems){var e=[],t=DateTime.newDate(0,0,0,0,0),i=DateTime.newDate(0,0,0,23,59,59);if(this.min&&t.setHours(this.min.getHours(),this.min.getMinutes(),this.min.getSeconds()),this.max&&i.setHours(this.max.getHours(),this.max.getMinutes(),this.max.getSeconds()),isNumber(this.step)&&this.step>0)for(var n=t;n<=i;n=DateTime.addMinutes(n,this.step))e.push({value:n,text:Globalize.format(n,this.format)});var s=this.value;this._settingText=!0,this.displayMemberPath="text",this.selectedValuePath="text",this.itemsSource=e,this._hasCustomItems=!1,this._settingText=!1,this.value=s}},t.prototype._getTime=function(e){return 3600*e.getHours()+60*e.getMinutes()+e.getSeconds()},t.prototype._keydown=function(t){if(e.prototype._keydown.call(this,t),!t.defaultPrevented)switch(t.keyCode){case Key.Enter:this.isDroppedDown||(this._commitText(),this.selectAll());break;case Key.Escape:this.text=Globalize.format(this.value,this.format),this.selectAll()}},t.prototype._commitText=function(){if(this.text||this.isRequired){var e=this.value?Globalize.format(this.value,this.format):null;if(this.text!=e){var t=this.selectedItem&&this.selectedItem.value?this.selectedItem.value:Globalize.parseDate(this.text,this.format,this.value);t?this.value=DateTime.fromDateTime(this.value,t):this.text=e}}else this.value=null},t}(ComboBox);export{InputTime};_addCultureInfo("InputDateTime",{ariaLabels:{tglDate:"Toggle Calendar",tglTime:"Toggle Time List"}});var InputDateTime=function(e){function t(t,i){var n=e.call(this,t)||this;addClass(n.hostElement,"wj-inputdatetime"),n._btnTm=n.hostElement.querySelector('[wj-part="btn-tm"]');var s=culture.InputDateTime.ariaLabels;setAriaLabel(n._btn,s.tglDate),setAriaLabel(n._btnTm,s.tglTime),n.format="g",n._inputTime=new InputTime(document.createElement("div"),{valueChanged:function(e,t){n.value=DateTime.fromDateTime(n.value,e.value)}});var o=n._inputTime.dropDown,r=n.calendar.hostElement,a=n.addEventListener.bind(n),l=n._keydown.bind(n);return a(o,"keydown",l,!0),a(o,"blur",function(){n._updateFocusState()},!0),a(o,"click",function(e){e.defaultPrevented||e.target!=o&&n.hostElement.focus()},!0),a(n._btn,"mousedown",function(e){n._setDropdown(r)&&n._btnclick(e)}),a(n._btnTm,"mousedown",function(e){n._setDropdown(o),n._btnclick(e),e.preventDefault()}),n.initialize(i),n}return __extends(t,e),Object.defineProperty(t.prototype,"timeMin",{get:function(){return this._inputTime.min},set:function(e){this._inputTime.min=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"timeMax",{get:function(){return this._inputTime.max},set:function(e){this._inputTime.max=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"timeFormat",{get:function(){return this._inputTime.format},set:function(e){this._inputTime.format=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"timeStep",{get:function(){return this._inputTime.step},set:function(e){this._inputTime.step=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inputTime",{get:function(){return this._inputTime},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){this._setDropdown(this.calendar.hostElement),e.prototype.dispose.call(this),this._inputTime.dispose()},t.prototype.refresh=function(t){void 0===t&&(t=!0),this._setDropdown(this.calendar.hostElement),this._inputTime.refresh(),e.prototype.refresh.call(this,t)},t.prototype._updateBtn=function(){e.prototype._updateBtn.call(this),this._btnTm&&(this._btnTm.tabIndex=this._btn.tabIndex,this._btnTm.parentElement.style.display=this._btn.style.display)},t.prototype._clamp=function(e){return e&&(this.min&&e<this.min&&(e=this.min),this.max&&e>this.max&&(e=this.max)),e},t.prototype._commitText=function(){var e=this._tbx.value;if(e||this.isRequired){var t=Globalize.parseDate(e,this.format,this.value);t?this.value=t:this._tbx.value=Globalize.format(this.value,this.format)}else this.value=null},t.prototype._setDropdown=function(e){if(this._dropDown==e)return!1;this.isDroppedDown&&(this.isDroppedDown=!1);var t=this.dropDownCssClass;return this.dropDownCssClass="",this._dropDown=e,this.dropDownCssClass=t,!0},t.prototype._updateDropDown=function(){var t=this._inputTime;this._dropDown==t.dropDown?(this._commitText(),e.prototype._updateDropDown.call(this),t.isRequired=this.isRequired&&null!=this.value,t.value=this.value,this.isDroppedDown&&t.listBox.showSelection()):e.prototype._updateDropDown.call(this)},t.controlTemplate='<div class="wj-template"><div class="wj-input"><div class="wj-input-group wj-input-btn-visible"><input wj-part="input" type="text" class="wj-form-control"/><span class="wj-input-group-btn"><button wj-part="btn" class="wj-btn wj-btn-default" tabindex="-1"><span class="wj-glyph-calendar"></span></button><button wj-part="btn-tm" class="wj-btn wj-btn-default" tabindex="-1"><span class="wj-glyph-clock"></span></button></span></div></div><div wj-part="dropdown" class="wj-content wj-dropdown-panel" style="display:none"></div></div>',t}(InputDate);export{InputDateTime};var AutoComplete=function(e){function t(t,i){var n=e.call(this,t)||this;return n._cssMatch="wj-autocomplete-match",n._minLength=2,n._maxItems=6,n._itemCount=0,n._delay=500,n._query="",n._inCallback=!1,n._srchProps=[],addClass(n.hostElement,"wj-autocomplete"),n._bsCollapse=!1,n.isEditable=!0,n.isRequired=!1,n.listBox.formatItem.addHandler(n._formatListItem,n),n._itemsSourceFnCallBackBnd=n._itemSourceFunctionCallback.bind(n),n.initialize(i),n}return __extends(t,e),Object.defineProperty(t.prototype,"minLength",{get:function(){return this._minLength},set:function(e){this._minLength=asNumber(e,!1,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxItems",{get:function(){return this._maxItems},set:function(e){this._maxItems=asNumber(e,!1,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"delay",{get:function(){return this._delay},set:function(e){this._delay=asNumber(e,!1,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"searchMemberPath",{get:function(){return this._srchProp},set:function(e){this._srchProp=asString(e),this._srchProps=e?e.trim().split(/\s*,\s*/):[]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"itemsSourceFunction",{get:function(){return this._itemsSourceFn},set:function(e){this._itemsSourceFn=asFunction(e),isFunction(this._itemsSourceFn)&&this.itemsSourceFunction(this.text,this.maxItems,this._itemsSourceFnCallBackBnd)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cssMatch",{get:function(){return this._cssMatch},set:function(e){this._cssMatch=asString(e)},enumerable:!0,configurable:!0}),t.prototype._keydown=function(t){if(!t.defaultPrevented&&this.isDroppedDown)switch(t.keyCode){case Key.Up:case Key.Down:this.selectAll()}e.prototype._keydown.call(this,t)},t.prototype._setText=function(e){var t=this;if(!this._inCallback){if(!e&&this.selectedIndex>-1&&this.getDisplayText()&&(this.selectedIndex=-1),e!=this._oldText&&(this._tbx.value!=e&&(this._tbx.value=e),this._oldText=e,this.onTextChanged(),!e&&this.collectionView))return(this._query||this.selectedIndex<0)&&(this.isDroppedDown=!1),this._query=this._rxHighlight=null,void(this.collectionView.filter=null);this._toSearch&&clearTimeout(this._toSearch),e!=this.getDisplayText()&&(this._toSearch=setTimeout(function(){t._toSearch=null;var e=t.text.trim();if(e.length>=t._minLength&&e!=t._query){t._query=e,e=e.replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1");var i=escapeHtml(e);t._rxMatch=new RegExp("(?=.*"+e.replace(/ /g,")(?=.*")+")","ig"),t._rxHighlight=t.isContentHtml?new RegExp("("+i.replace(/ /g,"|")+")(?![^<]*>|[^<>]* </)","ig"):new RegExp("("+i.replace(/ /g,"|")+")","ig"),t.itemsSourceFunction?t.itemsSourceFunction(e,t.maxItems,t._itemsSourceFnCallBackBnd):t._updateItems()}},this._delay))}},t.prototype._itemSourceFunctionCallback=function(e){this._inCallback=!0;var t=asCollectionView(e);if(t&&t.moveCurrentToPosition(-1),this.itemsSource=t,this._inCallback=!1,this.containsFocus()){var i=this._tbx,n=i.selectionStart,s=i.selectionEnd;this.isDroppedDown=!0,setSelectionRange(i,n,s),this.refresh()}},t.prototype.onIsDroppedDownChanged=function(t){if(e.prototype.onIsDroppedDownChanged.call(this,t),this.containsFocus()&&!this.isTouching&&this.selectedIndex<0){var i=this.collectionView.items,n=this.text;1==i.length&&i[0]==n?this.selectedIndex=0:setSelectionRange(this._tbx,n.length)}this._query=""},t.prototype._updateItems=function(){var e=this.collectionView;if(e){this._inCallback=!0,e.beginUpdate(),this._itemCount=0,e.filter=this._filter.bind(this),e.moveCurrentToPosition(-1),e.endUpdate(),this._inCallback=!1;var t=e.items.length,i=this._tbx,n=i.selectionStart,s=i.selectionEnd;this.isDroppedDown=t>0&&this.containsFocus(),t||this.isEditable||(this.selectedIndex=-1),this.isDroppedDown&&setSelectionRange(i,n,s),this.refresh()}},t.prototype._filter=function(e){if(this._itemCount>=this._maxItems)return!1;var t=this._getItemText(e,!1);if(this._srchProps)for(var i=0;i<this._srchProps.length;i++)t+="\0"+e[this._srchProps[i]];return this.isContentHtml&&(t=t.replace(/<[^>]*>/g,"")),!!t.match(this._rxMatch)&&(this._itemCount++,!0)},t.prototype._getItemText=function(e,t){var i=e?e.toString():"",n=t&&this.headerPath?this._pathHdr:this._lbx._pathDisplay;return n&&(i=null!=(i=n.getValue(e))?i.toString():""),i},t.prototype._formatListItem=function(e,t){if(this._cssMatch&&this._rxHighlight){var i='<span class="'+this._cssMatch+'">$1</span>';t.item.innerHTML=t.item.innerHTML.replace(this._rxHighlight,i)}},t}(ComboBox);export{AutoComplete};var MultiAutoComplete=function(e){function t(t,i){var n=e.call(this,t)||this;return n._selItems=[],n._lastInputValue="",n._selPath=new Binding(null),n._notAddItm=!1,n.selectedItemsChanged=new Event,addClass(n.hostElement,"wj-multi-autocomplete"),n.showDropDownButton=!1,n.initialize(i),n._wjTpl=n.hostElement.querySelector(".wj-template"),n._wjInput=n.hostElement.querySelector(".wj-input"),n.addEventListener(n.hostElement,"keyup",n._keyup.bind(n),!0),n.addEventListener(window,"resize",n._adjustInputWidth.bind(n)),n.addEventListener(n._tbx,"focus",function(){n._itemOff()}),n._addHelperInput(),n._initSeltems(),n.listBox.itemsChanged.addHandler(function(){return n.selectedIndex=-1}),n._refreshHeader(),n}return __extends(t,e),Object.defineProperty(t.prototype,"showDropDownButton",{set:function(e){this._showBtn=!1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxSelectedItems",{get:function(){return this._maxSelItems},set:function(e){this._maxSelItems!=e&&(this._maxSelItems=asNumber(e,!0),this._updateMaxItems(),this._refreshHeader(),this._clearSelIndex())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"selectedMemberPath",{get:function(){return this._selPath.path},set:function(e){(e=asString(e))!==this.selectedMemberPath&&(this._selPath.path=e,this._initSeltems(),this._refreshHeader(),this.onSelectedItemsChanged())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"selectedItems",{get:function(){return this._selItems},set:function(e){if(this._selItems=asArray(e),this.selectedMemberPath&&""!==this.selectedMemberPath&&this._selItems)for(var t=0;t<this._selItems.length;t++){var i=this._selItems[t];this._setSelItem(i,!1)}this._updateMaxItems(),this.onSelectedItemsChanged(),this._refreshHeader(),this._clearSelIndex()},enumerable:!0,configurable:!0}),t.prototype.onSelectedItemsChanged=function(e){this.selectedItemsChanged.raise(this,e)},t.prototype.onIsDroppedDownChanged=function(t){!this.isDroppedDown&&this.selectedIndex>-1&&!this._notAddItm&&this._addItem(!0),this._notAddItm=!1,e.prototype.onIsDroppedDownChanged.call(this,t)},t.prototype.refresh=function(t){void 0===t&&(t=!0),e.prototype.refresh.call(this,t),this._initSeltems(),this.isDroppedDown||this._refreshHeader()},t.prototype._keydown=function(t){if(!this.isReadOnly){if(!t.defaultPrevented)switch(t.keyCode){case Key.Back:this._lastInputValue=this._tbx.value;break;case Key.Enter:this._itemOff(),this._addItem(!0),isIE&&setSelectionRange(this._tbx,0,0);break;case Key.Tab:this.isDroppedDown?(this._addItem(!1),this._tbx.value="",this._lbx.selectedIndex=-1,t.preventDefault()):this._updateFocus();break;case Key.Space:if(""!==this._tbx.value)return;this.isDroppedDown||this._tbx.disabled||(this.isDroppedDown=!0,this._clearSelIndex());break;case Key.Escape:this.isDroppedDown&&(this._notAddItm=!0);break;case Key.Left:this._itemOn(!this.rightToLeft);break;case Key.Right:this._itemOn(!!this.rightToLeft);break;case Key.Up:case Key.Down:var i=getActiveElement();if(t.altKey){if(this._tbx==i)return this.isDroppedDown=!this.isDroppedDown,this.isDroppedDown||this._tbx.focus(),void t.preventDefault()}else if(this._tbx!==i)return;default:if(t.keyCode===Key.Back||t.keyCode===Key.Delete)return;this._itemOff(),null!=this._maxSelItems&&this._selItems.length>=this._maxSelItems&&t.preventDefault()}this._tbx.disabled||e.prototype._keydown.call(this,t)}},t.prototype._updateState=function(){e.prototype._updateState.call(this),this._wjTpl&&(hasClass(this.hostElement,"wj-state-focused")||this._itemOff())},t.prototype._keyup=function(e){if(!this.isReadOnly&&!e.defaultPrevented)switch(e.keyCode){case Key.Back:0===this._tbx.value.length&&0===this._lastInputValue.length&&this._delItem(!1);break;case Key.Delete:this._delItem(!0)}},t.prototype._addHelperInput=function(){var e=document.createElement("input");e.type="text",e.tabIndex=-1,e.className="wj-token-helper",e.readOnly=!0,this._wjTpl.insertBefore(e,this._wjInput),this._helperInput=e},t.prototype._refreshHeader=function(){for(var e=this.hostElement.querySelectorAll(".wj-token"),t=0;t<e.length;t++)this._wjTpl.removeChild(e[t]);var i=this.selectedItems;if(!i||0===i.length)return this._wjInput.style.cssFloat=this.rightToLeft?"right":"left",void this._adjustInputWidth();for(t=0;t<i.length;t++)this._insertToken(i[t]);this._wjInput.style.cssFloat=this.rightToLeft?"right":"left",this._adjustInputWidth()},t.prototype._insertToken=function(e){var t=this._getItemText(e,!0);this.isContentHtml||(t=escapeHtml(t)),this._wjTpl.insertBefore(this._createItem(t),this._wjInput)},t.prototype._updateMaxItems=function(){null!=this._maxSelItems&&this._selItems&&this._selItems.length>this._maxSelItems&&(this._selItems=this._selItems.slice(0,this._maxSelItems))},t.prototype._updateFocus=function(){var e=this,i=this._wjTpl.querySelector("."+t._clsActive);i?(removeClass(i,t._clsActive),setTimeout(function(){e._tbx.focus()})):(this._clearSelIndex(),removeClass(this.hostElement,"wj-state-focused"))},t.prototype._addItem=function(e){this.selectedItems.indexOf(this.selectedItem)>-1?this._clearSelIndex():this.selectedIndex>-1&&(this._updateSelItems(this.selectedItem,!0),this._refreshHeader(),e&&this._clearSelIndex(),this._disableInput(!0))},t.prototype._delItem=function(e){var i,n,s=this._wjTpl.querySelector("."+t._clsActive),o=!1;e&&!s||(s?(n=this._getItemIndex(s))>-1&&(i=this._selItems[n],o=!0):this._selItems.length>0&&(i=this._selItems[this._selItems.length-1],o=!0),o&&(this._updateSelItems(i,!1),this._refreshHeader(),this._clearSelIndex(),this._disableInput(!1)),this._tbx.focus())},t.prototype._updateSelItems=function(e,t){if(t){if(this._selItems&&0!==this._selItems.length||(this._selItems=[]),null!=this._maxSelItems&&this._selItems.length>=this._maxSelItems)return;this._selItems.push(e)}else{var i=this._selItems.indexOf(e);this._selItems.splice(i,1)}this._hasSelectedMemeberPath()&&this._setSelItem(e,t),this.onSelectedItemsChanged()},t.prototype._createItem=function(e){var i=this,n=document.createElement("div"),s=document.createElement("span"),o=document.createElement("a");return n.appendChild(s),n.appendChild(o),n.className="wj-token",s.className="wj-token-label",s.innerHTML=e,o.className="wj-token-close",o.href="#",o.tabIndex=-1,o.text="×",n.style.cssFloat=this.rightToLeft?"right":"left",this.addEventListener(n,"click",function(e){i._helperInput.focus();var s=i._wjTpl.querySelector("."+t._clsActive);s&&removeClass(s,t._clsActive),addClass(n,t._clsActive),e.stopPropagation(),e.preventDefault()}),this.addEventListener(o,"click",function(e){if(!i.isReadOnly){var t=i._getItemIndex(n);if(t>-1){var s=i._selItems[t];i._updateSelItems(s,!1)}i._wjTpl.removeChild(n),i._adjustInputWidth(),i._disableInput(!1),i._tbx.focus(),e.stopPropagation(),e.preventDefault()}}),n},t.prototype._itemOn=function(e){var i,n,s,o=getActiveElement();if((this._tbx!=o||0===this._tbx.value.length)&&0!==(i=this._wjTpl.querySelectorAll(".wj-token")).length)if(n=this._wjTpl.querySelector("."+t._clsActive),s=this._getItemIndex(n),e){if(0===s)return;-1===s?(addClass(i[i.length-1],t._clsActive),this._helperInput.focus()):(removeClass(n,t._clsActive),addClass(i[s-1],t._clsActive),this._helperInput.focus())}else if(!e){if(-1===s)return;s!==i.length-1?(removeClass(n,t._clsActive),addClass(i[s+1],t._clsActive),this._helperInput.focus()):(removeClass(n,t._clsActive),this._tbx.focus())}},t.prototype._itemOff=function(){var e=this._wjTpl.querySelector("."+t._clsActive);e&&removeClass(e,t._clsActive)},t.prototype._initSeltems=function(){if(this.selectedMemberPath&&""!==this.selectedMemberPath){var e=this.itemsSource;if(this._selItems.splice(0,this._selItems.length),e)for(var t=0;t<e.sourceCollection.length;t++)this._getSelItem(t)&&this._selItems.push(e.sourceCollection[t])}},t.prototype._getSelItem=function(e){var t=this.itemsSource.sourceCollection[e];return!(!isObject(t)||!this.selectedMemberPath)&&this._selPath.getValue(t)},t.prototype._setSelItem=function(e,t){this.itemsSource;isObject(e)&&this._selPath.getValue(e)!=t&&this._selPath.setValue(e,t)},t.prototype._clearSelIndex=function(){this.selectedIndex=-1},t.prototype._hasSelectedMemeberPath=function(){return this.selectedMemberPath&&""!==this.selectedMemberPath},t.prototype._disableInput=function(e){null!=this._maxSelItems&&(this._selItems.length<this._maxSelItems?(this._tbx.disabled=!1,this._tbx.focus()):(this._tbx.disabled=!0,this.hostElement.focus()))},t.prototype._adjustInputWidth=function(){this._tbx.style.width="60px";var e,t=getElementRect(this.hostElement),i=getElementRect(this._tbx),n=getComputedStyle(this._tbx),s=parseInt(n.paddingLeft,10),o=parseInt(n.paddingRight,10);e=this.rightToLeft?i.left+i.width-t.left-s-o-8:t.left+t.width-i.left-s-o-8,this._tbx.style.width=e+"px"},t.prototype._getItemIndex=function(e){for(var t=this.hostElement.querySelectorAll(".wj-token"),i=0;i<t.length;i++)if(e===t[i])return i;return-1},t._clsActive="wj-token-active",t}(AutoComplete);export{MultiAutoComplete};_registerModule("wijmo.input",selfModule);