/*!
    *
    * Wijmo Library 5.20191.603
    * http://wijmo.com/
    *
    * Copyright(c) GrapeCity, Inc.  All rights reserved.
    *
    * Licensed under the GrapeCity Commercial License.
    * sales@wijmo.com
    * wijmo.com/products/wijmo-5/license/
    *
    */

"use strict";var __extends=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function o(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}();Object.defineProperty(exports,"__esModule",{value:!0});var wijmo_1=require("wijmo/wijmo"),selfModule=require("wijmo/wijmo.input");wijmo_1._addCultureInfo("InputNumber",{ariaLabels:{incVal:"Increase Value",decVal:"Decrease Value"}});var InputNumber=function(t){function e(e,i){var o=t.call(this,e)||this;o._showBtn=!0,o._readOnly=!1,o.textChanged=new wijmo_1.Event,o.valueChanged=new wijmo_1.Event;var n=o.hostElement;wijmo_1.setAttribute(n,"role","spinbutton",!0);var s=o.getTemplate();o.applyTemplate("wj-control wj-content wj-inputnumber",s,{_tbx:"input",_btnUp:"btn-inc",_btnDn:"btn-dec"},"input");var r=wijmo_1.culture.InputNumber.ariaLabels;wijmo_1.setAriaLabel(o._btnUp.querySelector("button"),r.incVal),wijmo_1.setAriaLabel(o._btnDn.querySelector("button"),r.decVal),o._tbx.type.match(/number/i)&&(o.inputType="");var a=o._tbx;a.autocomplete="off",a.spellcheck=!1,o._updateSymbols();var l=o.addEventListener.bind(o);l(a,"keypress",o._keypress.bind(o)),l(a,"keydown",o._keydown.bind(o)),l(a,"input",o._input.bind(o)),l(a,"blur",function(){o.text!=o._oldText&&o._setText(o.text)}),l(a,"compositionstart",function(){o._composing=!0}),l(a,"compositionend",function(){o._composing=!1,setTimeout(function(){var t=o.text;o._oldText.indexOf(o._chrPct)>-1&&t.indexOf(o._chrPct)<0&&(t+=o._chrPct),o._setText(t)})});var h=o._clickSpinner.bind(o);return l(o._btnUp,"click",h),l(o._btnDn,"click",h),o._rptUp=new wijmo_1._ClickRepeater(o._btnUp.querySelector("button")),o._rptDn=new wijmo_1._ClickRepeater(o._btnDn.querySelector("button")),l(n,"wheel",function(t){if(!t.defaultPrevented&&!o.isReadOnly&&o.containsFocus()){var e=wijmo_1.clamp(-t.deltaY,-1,1);o._increment((o.step||1)*e),setTimeout(function(){return o.selectAll()}),t.preventDefault()}}),o.value=0,o.isRequired=!0,o.initialize(i),o}return __extends(e,t),Object.defineProperty(e.prototype,"inputElement",{get:function(){return this._tbx},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inputType",{get:function(){return this._tbx.type},set:function(t){this._tbx.type=wijmo_1.asString(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(t){if(t!=this._value)if(null==(t=wijmo_1.asNumber(t,!this.isRequired||null==t&&null==this._value)))this._setText("");else if(!isNaN(t)){var e=wijmo_1.Globalize.format(t,this.format);this._setText(e)}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isRequired",{get:function(){return this._tbx.required},set:function(t){this._tbx.required=wijmo_1.asBoolean(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isReadOnly",{get:function(){return this._readOnly},set:function(t){this._readOnly=wijmo_1.asBoolean(t),this.inputElement.readOnly=this._readOnly,wijmo_1.toggleClass(this.hostElement,"wj-state-readonly",this.isReadOnly)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"min",{get:function(){return this._min},set:function(t){t!=this._min&&(this._min=wijmo_1.asNumber(t,!0),this._updateAria())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"max",{get:function(){return this._max},set:function(t){t!=this._max&&(this._max=wijmo_1.asNumber(t,!0),this._updateAria())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"step",{get:function(){return this._step},set:function(t){this._step=wijmo_1.asNumber(t,!0),this._updateBtn()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"format",{get:function(){return this._format},set:function(t){t!=this.format&&(this._format=wijmo_1.asString(t),this.refresh())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"text",{get:function(){return this._tbx.value},set:function(t){t!=this.text&&(this._oldText=null,this._setText(t))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"placeholder",{get:function(){return this._tbx.placeholder},set:function(t){this._tbx.placeholder=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"showSpinner",{get:function(){return this._showBtn},set:function(t){this._showBtn=wijmo_1.asBoolean(t),this._updateBtn()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"repeatButtons",{get:function(){return!this._rptUp.disabled},set:function(t){this._rptUp.disabled=this._rptDn.disabled=!wijmo_1.asBoolean(t)},enumerable:!0,configurable:!0}),e.prototype.selectAll=function(){var t=this._tbx;wijmo_1.setSelectionRange(t,0,t.value.length)},e.prototype.clamp=function(t){return wijmo_1.clamp(t,this.min,this.max)},e.prototype.onTextChanged=function(t){this.textChanged.raise(this,t),this._updateState()},e.prototype.onValueChanged=function(t){this._updateAria(),this.valueChanged.raise(this,t)},e.prototype.dispose=function(){this._rptUp.element=null,this._rptDn.element=null,t.prototype.dispose.call(this)},e.prototype.onGotFocus=function(e){this._oldValue=this.value,this.isTouching||(this._tbx.focus(),this.selectAll()),t.prototype.onGotFocus.call(this,e)},e.prototype.onLostFocus=function(e){this._composing&&(this._composing=!1,this._setText(this.text));var i=this.clamp(this.value),o=wijmo_1.Globalize.format(i,this.format);this._setText(o),t.prototype.onLostFocus.call(this,e)},e.prototype.refresh=function(e){void 0===e&&(e=!0),t.prototype.refresh.call(this,e),this._updateSymbols();var i=wijmo_1.Globalize.format(this.value,this.format);this._setText(i)},e.prototype._updateSymbols=function(){var t=wijmo_1.culture.Globalize.numberFormat,e=this.format?this.format.match(/([a-z])(\d*)(,*)(.*)/i):null;this._chrDec=t["."]||".",this._chrTho=t[","]||",",this._chrNeg=t["-"]||"-",this._chrPls=t["+"]||"+",this._chrPct=t["%"]||"%",this._chrCur=e&&e[4]?e[4]:t.currency.symbol||"$",this._fmtSpc=e&&e[1]?e[1].toLowerCase():"n",this._fmtPrc=e&&e[2]?parseInt(e[2]):null,this._rxSym=new RegExp("^[%+\\-() \\"+this._chrDec+"\\"+this._chrCur+"\\"+this._chrNeg+"\\"+this._chrPls+"\\"+this._chrPct+"]*$"),this._rxNeg=new RegExp("(\\-|\\(|\\"+this._chrNeg+")")},e.prototype._isNumeric=function(t,e){var i=t==this._chrDec||t>="0"&&t<="9",o="x"==this._fmtSpc;return!i&&o&&(i=t>="a"&&t<="f"||t>="A"&&t<="F"),i||e||o||(i=t==this._chrPls||t==this._chrNeg||"("==t||")"==t),i},e.prototype._getInputRange=function(t){for(var e=[0,0],i=this.text,o=!1,n=0;n<i.length;n++)this._isNumeric(i[n],t)&&(o||(e[0]=n,o=!0),e[1]=n+1);return e},e.prototype._flipSign=function(){var t=this._getSelStartDigits();this.value*=-1,this._setSelStartDigits(t)},e.prototype._getSelStartDigits=function(){for(var t=0,e=this._tbx.selectionStart,i=this._tbx.value,o=0;o<i.length&&o<e;o++)this._isNumeric(i[o],!0)&&t++;return t},e.prototype._setSelStartDigits=function(t){for(var e=this._tbx.value,i=0;i<e.length&&t>=0;i++)if(this._isNumeric(e[i],!0)){if(!t){wijmo_1.setSelectionRange(this._tbx,i);break}t--}else if(!t){wijmo_1.setSelectionRange(this._tbx,i);break}},e.prototype._increment=function(t){if(t){var e=this.clamp(wijmo_1.isNumber(this.value)?this.value+t:0),i=wijmo_1.Globalize.format(e,this.format,!1,!1);this._setText(i)}},e.prototype._updateBtn=function(){var t=this.showSpinner&&!!this.step,e=t;wijmo_1.setCss([this._btnUp,this._btnDn],{display:t?"":"none"}),wijmo_1.toggleClass(this.hostElement,"wj-input-show-spinner",t),wijmo_1.enable(this._btnUp,e),wijmo_1.enable(this._btnDn,e),this._updateAria()},e.prototype._setText=function(t){if(!this._composing){var e=this._tbx,i=this._rxNeg.test(t),o=this._delKey;if(t&&this._rxSym.test(t)&&this.containsFocus()&&(t=this.isRequired||!o?"0":""),this._delKey=!1,o&&0==this.value&&!this.isRequired&&(t=""),!t){if(!this.isRequired)return e.value="",null!=this._value&&(this._value=null,this.onValueChanged()),this._oldText&&(this._oldText=t,this.onTextChanged()),void this._updateBtn();t="0"}var n=this._format||(t.indexOf(this._chrDec)>-1?"n2":"n0"),s=wijmo_1.Globalize.parseFloat(t,n);if(isNaN(s))e.value=this._oldText;else{var r=wijmo_1.Globalize.format(s,n,!1);i&&s>=0&&!o&&(r=this._chrNeg+r),null!=this._fmtPrc&&"g"!=this._fmtSpc||!o&&e.value.match(/\.0?$/)&&(r=t+("0"==t?this._chrDec:"")),e.value!=r&&("g"==this._fmtSpc&&e.value.match(r+"0*")&&this.containsFocus()&&e.selectionStart==e.value.length&&(r=e.value),e.value=r,s=wijmo_1.Globalize.parseFloat(r,this.format)),s!=this._value&&(this._value=s,this.onValueChanged()),this.text!=this._oldText&&(this._oldText=this.text,this.onTextChanged()),this._updateBtn()}}},e.prototype._keypress=function(t){if(!(t.defaultPrevented||this._composing||this.isReadOnly)&&t.charCode&&!t.ctrlKey&&!t.metaKey){var e=this._tbx,i=String.fromCharCode(t.charCode);if(this._isNumeric(i,!1)){var o=this._getInputRange(!0),n=e.selectionStart,s=e.selectionEnd;if(n<o[0]&&s<e.value.length&&(s=Math.max(s,o[0]),wijmo_1.setSelectionRange(e,o[0],s)),n>=o[1]){var r=null!=this._fmtPrc?this._fmtPrc:2,a=e.value.indexOf(this._chrDec);a>-1&&n-a>r&&t.preventDefault()}}else t.preventDefault();switch(i){case"-":case this._chrNeg:this.min>=0?this.value<0&&this._flipSign():this.value&&e.selectionStart==e.selectionEnd?this._flipSign():this.clamp(-1)<0&&(e.value=this._chrNeg,wijmo_1.setSelectionRange(e,1)),t.preventDefault();break;case"+":case this._chrPls:this.value<0&&this._flipSign(),t.preventDefault();break;case".":case this._chrDec:if(0==this._fmtPrc)t.preventDefault();else{var l=e.value.indexOf(this._chrDec);l>-1&&(e.selectionStart<=l&&l++,wijmo_1.setSelectionRange(e,l),t.preventDefault())}}if(!t.defaultPrevented&&wijmo_1.isIE()){var h=e.value;(n=e.selectionStart)==(s=e.selectionEnd)&&(e.value=h.substr(0,n)+i+h.substr(s),wijmo_1.setSelectionRange(e,n+1),t.preventDefault(),this._input())}}},e.prototype._keydown=function(t){var e=this;if(this._delKey=!1,!t.defaultPrevented&&!this._composing){var i=this._tbx,o=i.value,n=i.selectionStart,s=i.selectionEnd;switch(t.keyCode){case 65:t.ctrlKey&&(setTimeout(function(){e.selectAll()}),t.preventDefault());break;case wijmo_1.Key.Up:case wijmo_1.Key.Down:this.step&&!this.isReadOnly&&(this._increment(this.step*(t.keyCode==wijmo_1.Key.Up?1:-1)),setTimeout(function(){e.selectAll()}),t.preventDefault());break;case wijmo_1.Key.Back:if(this._delKey=!0,s-n<2&&!this.isReadOnly){var r=o[s-1];r!=this._chrDec&&r!=this._chrPct&&r!=this._chrTho&&")"!=r||(setTimeout(function(){s=r==e._chrPct?e._getInputRange(!0)[1]:s-1,wijmo_1.setSelectionRange(i,s)}),t.preventDefault())}break;case wijmo_1.Key.Delete:if(this._delKey=!0,s-n<2&&!this.isReadOnly)if("0"==o&&1==n)wijmo_1.setSelectionRange(i,0);else{var a=o[n];a!=this._chrDec&&a!=this._chrPct||(setTimeout(function(){wijmo_1.setSelectionRange(i,n+1)}),t.preventDefault())}break;case wijmo_1.Key.Escape:this.value=this._oldValue,this.selectAll()}}},e.prototype._input=function(){var t=this;this._composing||setTimeout(function(){var e=t._tbx,i=e.value,o=i.indexOf(t._chrDec),n=e.selectionStart,s=t._getSelStartDigits();if("p"==t._fmtSpc&&i.length&&i.indexOf(t._chrPct)<0&&(i+=t._chrPct),t._setText(i),t.containsFocus()){var r=e.value,a=r.indexOf(t._chrDec),l=t._getInputRange(!0);if(i==t._chrNeg+t._chrDec&&a>-1)return void wijmo_1.setSelectionRange(e,a+1);if(i[0]==t._chrNeg&&r[0]!=t._chrNeg)return void(1==r.length?wijmo_1.setSelectionRange(e,1):t._setSelStartDigits(s));i?i==t._chrDec&&a>-1?n=a+1:n<=o&&a>-1||o<0&&a<0?n+=r.length-i.length:o<0&&a>-1&&(n=a):n=a>-1?a:l[1],n=wijmo_1.clamp(n,l[0],l[1]),wijmo_1.setSelectionRange(e,n)}})},e.prototype._clickSpinner=function(t){var e=this;t.defaultPrevented||this.isReadOnly||!this.step||(this._increment(this.step*(wijmo_1.contains(this._btnUp,t.target)?1:-1)),this.isTouching||setTimeout(function(){return e.selectAll()}))},e.prototype._updateAria=function(){var t=this.hostElement;t&&(wijmo_1.setAttribute(t,"aria-valuemin",this.min),wijmo_1.setAttribute(t,"aria-valuemax",this.max),wijmo_1.setAttribute(t,"aria-valuenow",this.value))},e.controlTemplate='<div class="wj-input"><div class="wj-input-group"><span wj-part="btn-dec" class="wj-input-group-btn" tabindex="-1"><button class="wj-btn wj-btn-default" tabindex="-1">-</button></span><input type="tel" wj-part="input" class="wj-form-control wj-numeric"/><span wj-part="btn-inc" class="wj-input-group-btn" tabindex="-1"><button class="wj-btn wj-btn-default" tabindex="-1">+</button></span></div></div>',e}(wijmo_1.Control);exports.InputNumber=InputNumber;var InputMask=function(t){function e(e,i){var o=t.call(this,e)||this;o.valueChanged=new wijmo_1.Event;var n=o.getTemplate();if(o.applyTemplate("wj-control wj-content wj-inputmask",n,{_tbx:"input"},"input"),"INPUT"==o._orgTag){var s=o._tbx.getAttribute("value");s&&(o.value=s)}return o._msk=new wijmo_1._MaskProvider(o._tbx),o.isRequired=!0,o.initialize(i),o.addEventListener(o._tbx,"input",function(){setTimeout(function(){o.onValueChanged()})}),o}return __extends(e,t),Object.defineProperty(e.prototype,"inputElement",{get:function(){return this._tbx},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inputType",{get:function(){return this._tbx.type},set:function(t){this._tbx.type=wijmo_1.asString(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this._tbx.value},set:function(t){t!=this.value&&(this._tbx.value=wijmo_1.asString(t),t=this._msk._applyMask(),this._tbx.value=t,this.onValueChanged())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rawValue",{get:function(){return this._msk.getRawValue()},set:function(t){t!=this.rawValue&&(this.value=wijmo_1.asString(t))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mask",{get:function(){return this._msk.mask},set:function(t){var e=this.value;this._msk.mask=wijmo_1.asString(t),this.value!=e&&this.onValueChanged()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"promptChar",{get:function(){return this._msk.promptChar},set:function(t){var e=this.value;this._msk.promptChar=t,this.value!=e&&this.onValueChanged()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"placeholder",{get:function(){return this._tbx.placeholder},set:function(t){this._tbx.placeholder=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maskFull",{get:function(){return this._msk.maskFull},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isRequired",{get:function(){return this._tbx.required},set:function(t){this._tbx.required=wijmo_1.asBoolean(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isReadOnly",{get:function(){return this._tbx.readOnly},set:function(t){this._tbx.readOnly=wijmo_1.asBoolean(t),wijmo_1.toggleClass(this.hostElement,"wj-state-readonly",this.isReadOnly)},enumerable:!0,configurable:!0}),e.prototype.selectAll=function(){var t=this._msk.getMaskRange();wijmo_1.setSelectionRange(this._tbx,t[0],t[1]+1)},e.prototype.onValueChanged=function(t){this.value!=this._oldValue&&(this._oldValue=this.value,this.valueChanged.raise(this,t)),this._updateState()},e.prototype._updateState=function(){t.prototype._updateState.call(this);var e=!this._pristine&&this._tbx.value&&!this.maskFull;wijmo_1.toggleClass(this.hostElement,"wj-state-invalid",e)},e.prototype.dispose=function(){this._msk.input=null,t.prototype.dispose.call(this)},e.prototype.refresh=function(e){void 0===e&&(e=!0),t.prototype.refresh.call(this,e),this._msk.refresh()},e.prototype.onGotFocus=function(e){t.prototype.onGotFocus.call(this,e),this.selectAll()},e.controlTemplate='<div class="wj-input"><div class="wj-input-group"><input wj-part="input" class="wj-form-control"/></div></div>',e}(wijmo_1.Control);exports.InputMask=InputMask;var ColorPicker=function(t){function e(i,o){var n=t.call(this,i)||this;n._hsb=[.5,1,1],n._alpha=1,n.valueChanged=new wijmo_1.Event;var s=n.getTemplate();n.applyTemplate("wj-control wj-content wj-colorpicker",s,{_eSB:"div-sb",_eHue:"div-hue",_eAlpha:"div-alpha",_ePreview:"div-pv",_ePal:"div-pal",_eText:"div-text"}),n._palette="#FFF,#000, #F00,#FFC000,#FFFF00,#92D050,#00B050,#00B0F0,#0070C0,#7030A0".split(","),n._updatePalette(),n._eHue.style.backgroundImage="url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAD4CAIAAACi6hsPAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAYdEVYdFNvZnR3YXJlAHBhaW50Lm5ldCA0LjAuM4zml1AAAAGvSURBVDhPXdBPaM9xHMfxz4pWaxcmtoOhpdXSVpiyHWxqmVpDjaU5rK34XfypjTJ/p+ZPay6jhsOsRrKwaJElf9IQq03WIkv4FeMwMq221tfje1ByeFzfvd7PEKWGEKWTQRZLySWfVRRTQjmVbKWGOhLsZT+HaeY0bbTTQSfdXOcWffTzmAFeMcwoYyT5ygS/mA5hNgphip98J8kHRnnNSwZ4yH1uc4OrdHGR87RximYO0cgedlLLdqqoYAPrWMtKVrCcJSxiPmnMJUQp/Bsyk2xyyKOAQooopYwKtlDNDur5G7SBJo7RQiv/B+2hl3s84CkvGGKEOOYnxolj/mYmhBmDJ5ngCx95xxsGecYj4pB3iENeoZMO2mmlhaMcpIE4ZII6aqhmM3HMMkooopB88sghm0wySCeVlCjMCVFIYx4LWUwOeRSwhmLWU84mqqihll3sppEmjnOSs5zjEl1c4yZ99POE5wwxwns+840fTDFLFKaZZIJxkozxlmEGGSC+GF++Sy89dHOZC8Rr4lVnOMERDrCPBPXEX22jko2UEn+/mnxyWUYWC0gnNUQh/AEc0HJs6cex0gAAAABJRU5ErkJggg==)",n._eHue.style.backgroundSize="contain",navigator.appVersion.indexOf("MSIE 9")>-1&&(n._eSB.children[0].style.filter="progid:DXImageTransform.Microsoft.gradient(startColorstr=#ffffffff,endColorstr=#00ffffff,GradientType=1)",n._eSB.children[1].style.filter="progid:DXImageTransform.Microsoft.gradient(startColorstr=#00000000,endColorstr=#ff000000,GradientType=0)"),s=e._tplCursor,n._cSB=wijmo_1.createElement(s),n._cHue=wijmo_1.createElement(s),n._cHue.style.width="100%",n._cAlpha=wijmo_1.createElement(s),n._cAlpha.style.height="100%",n._eSB.appendChild(n._cSB),n._eHue.appendChild(n._cHue),n._eAlpha.appendChild(n._cAlpha),n.addEventListener(n.hostElement,"mousedown",function(t){document.addEventListener("mousemove",r),document.addEventListener("mouseup",a),n._mouseDown(t)});var r=function(t){n._mouseMove(t)},a=function(t){document.removeEventListener("mousemove",r),document.removeEventListener("mouseup",a),n._mouseUp(t)};return n.addEventListener(n.hostElement,"click",function(t){var e=t.target;if(e&&"DIV"==e.tagName&&wijmo_1.contains(n._ePal,e)){var i=e.style.backgroundColor;i&&(n.value=new wijmo_1.Color(i).toString())}}),n.value="#ffffff",n.initialize(o),n._updatePanels(),n}return __extends(e,t),Object.defineProperty(e.prototype,"showAlphaChannel",{get:function(){return"none"!=this._eAlpha.parentElement.style.display},set:function(t){this._eAlpha.parentElement.style.display=wijmo_1.asBoolean(t)?"":"none"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"showColorString",{get:function(){return"none"!=this._eText.style.display},set:function(t){this._eText.style.display=wijmo_1.asBoolean(t)?"":"none"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(t){if(t!=this.value){this._value=wijmo_1.asString(t),this._eText.innerText=this._value;var e=new wijmo_1.Color(this._value),i=e.getHsb();this._hsb[0]==i[0]&&this._hsb[1]==i[1]&&this._hsb[2]==i[2]&&this._alpha==e.a||(0==i[2]?(i[0]=this._hsb[0],i[1]=this._hsb[1]):0==i[1]&&(i[0]=this._hsb[0]),this._hsb=i,this._alpha=e.a,this.onValueChanged())}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"palette",{get:function(){return this._palette},set:function(t){t=wijmo_1.asArray(t);for(var e=0;e<t.length&&e<this._palette.length;e++){var i=wijmo_1.asString(t[e]);this._palette[e]=i}this._updatePalette()},enumerable:!0,configurable:!0}),e.prototype.onValueChanged=function(t){this._updatePanels(),this.valueChanged.raise(this,t)},e.prototype._mouseDown=function(t){this._htDown=this._getTargetPanel(t),this._htDown&&(t.preventDefault(),this.focus(),this._mouseMove(t))},e.prototype._mouseMove=function(t){if(this._htDown){var e=this._htDown.getBoundingClientRect();this._htDown==this._eHue?(this._hsb[0]=wijmo_1.clamp((t.clientY-e.top)/e.height,0,.99),this._updateColor()):this._htDown==this._eSB?(this._hsb[1]=wijmo_1.clamp((t.clientX-e.left)/e.width,0,1),this._hsb[2]=wijmo_1.clamp(1-(t.clientY-e.top)/e.height,0,1),this._updateColor()):this._htDown==this._eAlpha&&(this._alpha=wijmo_1.clamp((t.clientX-e.left)/e.width,0,1),this._updateColor())}},e.prototype._mouseUp=function(t){this._htDown=null},e.prototype._updateColor=function(){var t=wijmo_1.Color.fromHsb(this._hsb[0],this._hsb[1],this._hsb[2],this._alpha);this.value=t.toString(),this._updatePanels()},e.prototype._updatePalette=function(){var t=new wijmo_1.Color("#fff"),e=new wijmo_1.Color("#000");this._ePal.innerHTML="";for(var i=0;i<this._palette.length;i++){var o=wijmo_1.createElement('<div style="float:left;width:10%;box-sizing:border-box;padding:1px">'),n=new wijmo_1.Color(this._palette[i]),s=n.getHsb();o.appendChild(this._makePalEntry(n,4));for(var r=0;r<5;r++){if(0==s[1]){var a=.1*r+(s[2]>.5?.05:.55);n=wijmo_1.Color.interpolate(t,e,a)}else n=wijmo_1.Color.fromHsb(s[0],.1+.2*r,1-.1*r);o.appendChild(this._makePalEntry(n,0))}this._ePal.appendChild(o)}},e.prototype._makePalEntry=function(t,e){var i=document.createElement("div");return wijmo_1.setCss(i,{cursor:"pointer",backgroundColor:t.toString(),marginBottom:e||""}),i.innerHTML="&nbsp",i},e.prototype._updatePanels=function(){var t=wijmo_1.Color.fromHsb(this._hsb[0],1,1,1),e=wijmo_1.Color.fromHsb(this._hsb[0],this._hsb[1],this._hsb[2],1);this._eSB.style.backgroundColor=t.toString(),this._eAlpha.style.background="linear-gradient(to right, transparent 0%, "+e.toString()+" 100%)",navigator.appVersion.indexOf("MSIE 9")>-1&&(this._eAlpha.style.filter="progid:DXImageTransform.Microsoft.gradient(startColorstr=#00000000,endColorstr="+e.toString()+", GradientType = 1)"),this._ePreview.style.backgroundColor=this.value,this._cHue.style.top=(100*this._hsb[0]).toFixed(0)+"%",this._cSB.style.left=(100*this._hsb[1]).toFixed(0)+"%",this._cSB.style.top=(100-100*this._hsb[2]).toFixed(0)+"%",this._cAlpha.style.left=(100*this._alpha).toFixed(0)+"%"},e.prototype._getTargetPanel=function(t){var e=t.target;return wijmo_1.contains(this._eSB,e)?this._eSB:wijmo_1.contains(this._eHue,e)?this._eHue:wijmo_1.contains(this._eAlpha,e)?this._eAlpha:null},e.controlTemplate='<div style="position:relative;width:100%;height:100%"><div style="float:left;width:50%;height:100%;box-sizing:border-box;padding:2px"><div wj-part="div-pal"><div style="float:left;width:10%;box-sizing:border-box;padding:2px"><div style="background-color:black;width:100%">&nbsp;</div><div style="height:6px"></div></div></div><div wj-part="div-text" style="position:absolute;bottom:0px;display:none"></div></div><div style="float:left;width:50%;height:100%;box-sizing:border-box;padding:2px"><div wj-part="div-sb" class="wj-colorbox" style="float:left;width:89%;height:89%"><div style="position:absolute;width:100%;height:100%;background:linear-gradient(to right, white 0%,transparent 100%)"></div><div style="position:absolute;width:100%;height:100%;background:linear-gradient(to top, black 0%,transparent 100%)"></div></div><div style="float:left;width:1%;height:89%"></div><div style="float:left;width:10%;height:89%"><div wj-part="div-hue" class="wj-colorbox"></div></div><div style="float:left;width:89%;height:1%"></div><div style="float:left;width:89%;height:10%"><div style="width:100%;height:100%;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAIAAABLbSncAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAYdEVYdFNvZnR3YXJlAHBhaW50Lm5ldCA0LjAuM4zml1AAAAAcSURBVBhXY/iPBBYgAWpKQGkwgMqDAdUk/v8HAM7Mm6GatDUYAAAAAElFTkSuQmCC)"><div wj-part="div-alpha" class="wj-colorbox"></div></div></div><div style="float:left;width:1%;height:10%"></div><div style="float:left;width:10%;height:10%"><div wj-part="div-pv" class="wj-colorbox" style="position:static"></div></div></div></div>',e._tplCursor='<div style="position:absolute;left:50%;top:50%;width:7px;height:7px;transform:translate(-50%,-50%);border:2px solid #f0f0f0;border-radius:50px;box-shadow:0px 0px 4px 2px #0f0f0f"></div>',e}(wijmo_1.Control);exports.ColorPicker=ColorPicker;var ListBox=function(t){function e(e,i){var o=t.call(this,e)||this;o._pathDisplay=new wijmo_1.Binding(null),o._pathValue=new wijmo_1.Binding(null),o._pathChecked=new wijmo_1.Binding(null),o._html=!1,o._shGroups=!1,o._checkedItems=[],o._itemRole="option",o._search="",o._fmtItemHandlers=0,o._itemCount=0,o.selectedIndexChanged=new wijmo_1.Event,o.itemsChanged=new wijmo_1.Event,o.loadingItems=new wijmo_1.Event,o.loadedItems=new wijmo_1.Event,o.itemChecked=new wijmo_1.Event,o.checkedItemsChanged=new wijmo_1.Event,o.formatItem=new wijmo_1.Event(function(){o.invalidate()}),o.applyTemplate("wj-control wj-content wj-listbox",null,null);var n=o.hostElement;return wijmo_1.setAttribute(n,"role","listbox",!0),"SELECT"==o._orgTag&&o._initFromSelect(o.hostElement),o.addEventListener(n,"click",o._click.bind(o)),o.addEventListener(n,"keydown",o._keydown.bind(o)),o.addEventListener(n,"keypress",o._keypress.bind(o)),o.addEventListener(n,"wheel",function(t){n.scrollHeight>n.offsetHeight&&(t.deltaY<0&&0==n.scrollTop||t.deltaY>0&&n.scrollTop+n.offsetHeight>=n.scrollHeight)&&t.preventDefault()}),o.initialize(i),o}return __extends(e,t),Object.defineProperty(e.prototype,"itemsSource",{get:function(){return this._items},set:function(t){this._items!=t&&(this._cv&&(this._cv.currentChanged.removeHandler(this._cvCurrentChanged,this),this._cv.collectionChanged.removeHandler(this._cvCollectionChanged,this),this._cv=null),this._items=t,this._cv=wijmo_1.asCollectionView(t),null!=this._cv&&(this._cv.currentChanged.addHandler(this._cvCurrentChanged,this),this._cv.collectionChanged.addHandler(this._cvCollectionChanged,this)),this._populateList(),this.onItemsChanged(),this.onSelectedIndexChanged())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"collectionView",{get:function(){return this._cv},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"showGroups",{get:function(){return this._shGroups},set:function(t){t!=this._shGroups&&(this._shGroups=wijmo_1.asBoolean(t),this._populateList())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isContentHtml",{get:function(){return this._html},set:function(t){t!=this._html&&(this._html=wijmo_1.asBoolean(t),this._populateList())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"itemFormatter",{get:function(){return this._itemFormatter},set:function(t){t!=this._itemFormatter&&(this._itemFormatter=wijmo_1.asFunction(t),this._populateList())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"displayMemberPath",{get:function(){return this._pathDisplay.path},set:function(t){t!=this.displayMemberPath&&(this._pathDisplay.path=wijmo_1.asString(t),this._populateList())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectedValuePath",{get:function(){return this._pathValue.path},set:function(t){this._pathValue.path=wijmo_1.asString(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"checkedMemberPath",{get:function(){return this._pathChecked.path},set:function(t){t!=this.checkedMemberPath&&(this._pathChecked.path=wijmo_1.asString(t),this._populateList())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"itemRole",{get:function(){return this._itemRole},set:function(t){t!=this.itemRole&&(this._itemRole=wijmo_1.asString(t),this._populateList())},enumerable:!0,configurable:!0}),e.prototype.getDisplayValue=function(t){var e=null;t>-1&&wijmo_1.hasItems(this._cv)&&(e=this._cv.items[t],this.displayMemberPath&&(e=this._pathDisplay.getValue(e)));var i=null!=e?e.toString():"";return this._itemFormatter&&(i=this._itemFormatter(t,i)),i},e.prototype.getDisplayText=function(t){var e=this._getChild(t);return null!=e?e.textContent:""},e.prototype.isItemEnabled=function(t){var e=this._getChild(t);return null!=e&&!e.hasAttribute("disabled")&&!wijmo_1.hasClass(e,"wj-state-disabled")&&!wijmo_1.hasClass(e,"wj-separator")},Object.defineProperty(e.prototype,"selectedIndex",{get:function(){return this._cv?this._cv.currentPosition:-1},set:function(t){this._cv&&this._cv.moveCurrentToPosition(wijmo_1.asNumber(t))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectedItem",{get:function(){return this._cv?this._cv.currentItem:null},set:function(t){this._cv&&this._cv.moveCurrentTo(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectedValue",{get:function(){var t=this.selectedItem;return t&&this.selectedValuePath&&(t=this._pathValue.getValue(t)),t},set:function(t){var e=this.selectedValuePath,i=-1;if(this._cv){for(var o=0;o<this._cv.items.length;o++){var n=this._cv.items[o],s=e?this._pathValue.getValue(n):n;if(s===t||wijmo_1.DateTime.equals(s,t)){i=o;break}}this.selectedIndex=i}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxHeight",{get:function(){var t=this.hostElement;return t?parseFloat(t.style.maxHeight):null},set:function(t){var e=this.hostElement;e&&(e.style.maxHeight=wijmo_1.asNumber(t)+"px")},enumerable:!0,configurable:!0}),e.prototype.showSelection=function(t){var e=this.selectedIndex,i=this.hostElement,o=i.children;e=this._getElementIndex(e);for(var n=0;n<o.length;n++){var s=o[n],r=n==e;wijmo_1.toggleClass(s,"wj-state-selected",r),wijmo_1.setAttribute(s,"aria-selected",r),s.tabIndex=r?this._orgTabIndex:-1}if(e>-1&&e<o.length){var a=(s=o[e]).getBoundingClientRect(),l=i.getBoundingClientRect(),h=0;if(this._shGroups){var c=o[0];wijmo_1.hasClass(c,"wj-header")&&(h=c.offsetHeight)}a.bottom>l.bottom?i.scrollTop+=a.bottom-l.bottom:a.top<l.top+h&&(i.scrollTop-=l.top+h-a.top)}e>-1&&(null==t&&(t=this.containsFocus()),t&&(s=o[e])instanceof HTMLElement&&!wijmo_1.contains(s,wijmo_1.getActiveElement())&&s.focus());i.tabIndex=e<0?this._orgTabIndex:-1},e.prototype.loadList=function(){this._populateList()},e.prototype.getItemChecked=function(t){var e=this._cv.items[t],i=this._pathChecked;if(wijmo_1.isObject(e)&&i.path)return i.getValue(e);var o=this._getCheckbox(t);return!!o&&o.checked},e.prototype.setItemChecked=function(t,e){this._setItemChecked(t,e,!0)},e.prototype.toggleItemChecked=function(t){this.setItemChecked(t,!this.getItemChecked(t))},Object.defineProperty(e.prototype,"checkedItems",{get:function(){if(this._checkedItems.splice(0,this._checkedItems.length),this._cv)for(var t=0;t<this._cv.items.length;t++)this.getItemChecked(t)&&this._checkedItems.push(this._cv.items[t]);return this._checkedItems},set:function(t){var e=this._cv,i=this.hostElement,o=wijmo_1.asArray(t,!1),n=!1;if(e&&o){for(var s=e.currentPosition,r=i.scrollTop,a=0;a<e.items.length;a++){var l=e.items[a];this._setItemChecked(a,o.indexOf(l)>-1,!1)&&(n=!0)}e.moveCurrentToPosition(s),i.scrollTop=r,n&&this.onCheckedItemsChanged()}},enumerable:!0,configurable:!0}),e.prototype.indexOf=function(t){if(this._shGroups&&wijmo_1.hasClass(t,"wj-header"))return-1;for(var e=this.hostElement.children,i=0,o=0;i<e.length;i++){var n=e[i];if(wijmo_1.contains(e[i],t))return o;this._shGroups&&wijmo_1.hasClass(n,"wj-header")||o++}return-1},e.prototype.onSelectedIndexChanged=function(t){this.selectedIndexChanged.raise(this,t)},e.prototype.onItemsChanged=function(t){this.itemsChanged.raise(this,t)},e.prototype.onLoadingItems=function(t){this.loadingItems.raise(this,t)},e.prototype.onLoadedItems=function(t){this.loadedItems.raise(this,t)},e.prototype.onItemChecked=function(t){this.itemChecked.raise(this,t)},e.prototype.onCheckedItemsChanged=function(t){this.checkedItemsChanged.raise(this,t)},e.prototype.onFormatItem=function(t){this.formatItem.raise(this,t)},e.prototype.refresh=function(e){void 0===e&&(e=!0),t.prototype.refresh.call(this,e);var i=this._cv?this._cv.items.length:0,o=this.formatItem.handlerCount;i==this._itemCount&&o==this._fmtItemHandlers||(this._fmtItemHandlers=o,this._populateList())},e.prototype._getChild=function(t){return t=this._getElementIndex(t),this.hostElement.children[t]},e.prototype._getElementIndex=function(t){if(this._shGroups)for(var e=this.hostElement.children,i=0;i<=t&&i<e.length;i++){var o=e[i];wijmo_1.hasClass(o,"wj-header")&&t++}return t},e.prototype._setItemChecked=function(t,e,i){void 0===i&&(i=!0);var o=this._cv.items[t],n=this._pathChecked,s=!1;if(wijmo_1.isObject(o)&&n.path){var r=wijmo_1.tryCast(this._cv,"IEditableCollectionView");n.getValue(o)!=e&&(s=!0,this._checking=!0,r?(r.editItem(o),n.setValue(o,e),r.commitEdit()):(n.setValue(o,e),this._cv.refresh()),this._checking=!1)}else s=!0;var a=this._getCheckbox(t);if(a){a.checked=e;var l=wijmo_1.closest(a,".wj-listbox-item");l&&wijmo_1.toggleClass(l,"wj-state-checked",e)}return i&&s&&(this.onItemChecked(),this.onCheckedItemsChanged()),s},e.prototype._cvCollectionChanged=function(t,e){this._checking||(this._populateList(),this.onItemsChanged())},e.prototype._cvCurrentChanged=function(t,e){this._checking||(this.showSelection(),this.onSelectedIndexChanged())},e.prototype._populateList=function(){var t=this.hostElement;if(this._itemCount=this._cv?this._cv.items.length:0,t){var e=this.containsFocus(),i=-1,o=void 0;this.onLoadingItems(),t.textContent="",t.scrollTop=0;var n=this._cv;if(n){var s=[],r=0,a=void 0;if(i=n.currentPosition,this._shGroups&&n.groups&&n.groups.length){o={};for(var l=0;l<n.groups.length;l++){var h=n.groups[l];o[r]=h,a=this._createHeaderItem(h),s.push(a);for(var c=0;c<h.items.length;c++,r++)a=this._createItem(r),s.push(a)}}else for(c=0;c<n.items.length;c++,r++)a=this._createItem(r),s.push(a);t.innerHTML=s.join("")}if(this.formatItem.hasHandlers&&n){var u=t.children,p=n.items,d=(r=0,new FormatItemEventArgs(0,null,null));for(c=0;c<u.length;c++)d._item=u[c],this._shGroups&&wijmo_1.hasClass(d._item,"wj-header")?(d._index=-1,d._data=o[r]):(d._index=r,d._data=p[r],r++),this.onFormatItem(d)}if(0==t.children.length&&t.appendChild(document.createElement("div")),t.tabIndex=i<0?this._orgTabIndex:-1,e)(i>=0?t.children[this._getElementIndex(i)]:t).focus();else i>0&&this.showSelection();this.onLoadedItems()}},e.prototype._createItem=function(t){var e=this._cv.items[t],i=t==this._cv.currentPosition,o=this.getDisplayValue(t);1!=this._html&&(o=wijmo_1.escapeHtml(o));var n=!1;this.checkedMemberPath&&(o='<label><input tabindex="-1" type="checkbox"'+((n=this._pathChecked.getValue(e))?" checked":"")+"> "+o+"</label>");var s="wj-listbox-item";if(i&&(s+=" wj-state-selected"),n&&(s+=" wj-state-checked"),this._html){var r=["wj-separator","wj-state-disabled"];if(o.indexOf(r[0])>-1||o.indexOf(r[1])>-1){var a=wijmo_1.createElement(o);r.forEach(function(t){wijmo_1.hasClass(a,t)&&(s+=" "+t)})}}return'<div class="'+s+'" role="'+this.itemRole+'" aria-selected="'+i+'" tabindex="'+(i?this._orgTabIndex:-1)+'">'+o+"</div>"},e.prototype._createHeaderItem=function(t){return'<div class="wj-listbox-item wj-header wj-state-disabled" role="presentation" tabindex="-1">'+wijmo_1.escapeHtml(t.name)+"</div>"},e.prototype._click=function(t){if(0==t.button&&!t.defaultPrevented){var e=this.indexOf(t.target);if(e>-1&&(this.selectedIndex=e,this.checkedMemberPath)){var i=this._getCheckbox(e),o=this.hostElement.children[e];i!=t.target&&t.target!=o||(o.focus({preventScroll:!0}),this.setItemChecked(e,i.checked))}}},e.prototype._keydown=function(t){var e=this.selectedIndex;this.hostElement.children;if(!t.defaultPrevented){if(65==t.keyCode&&(t.ctrlKey||t.metaKey)&&this.checkedMemberPath&&wijmo_1.hasItems(this.collectionView))return this.checkedItems=this.getItemChecked(0)?[]:this.collectionView.items,void t.preventDefault();if(!(t.ctrlKey||t.shiftKey||t.altKey||t.metaKey))switch(t.keyCode){case wijmo_1.Key.Down:t.preventDefault(),this._selectNext();break;case wijmo_1.Key.Up:t.preventDefault(),this._selectPrev();break;case wijmo_1.Key.Home:t.preventDefault(),this._selectFirst();break;case wijmo_1.Key.End:t.preventDefault(),this._selectLast();break;case wijmo_1.Key.PageDown:t.preventDefault(),this._selectNextPage();break;case wijmo_1.Key.PageUp:t.preventDefault(),this._selectPrevPage();break;case wijmo_1.Key.Space:if(this.checkedMemberPath&&e>-1){var i=this._getCheckbox(e);i&&this.isItemEnabled(e)&&(this.setItemChecked(e,!i.checked),t.preventDefault())}}}},e.prototype._keypress=function(t){var e=this;if(!t.defaultPrevented&&!(t.target instanceof HTMLInputElement)&&(t.charCode>32||32==t.charCode&&this._search)){t.preventDefault(),this._search+=String.fromCharCode(t.charCode).toLowerCase(),this._toSearch&&clearTimeout(this._toSearch),this._toSearch=setTimeout(function(){e._toSearch=null,e._search=""},wijmo_1.Control._SEARCH_DELAY);var i=this._findNext();i<0&&this._search.length>1&&(this._search=this._search[this._search.length-1],i=this._findNext()),i>-1&&(this.selectedIndex=i)}},e.prototype._selectNext=function(){for(var t=this.hostElement.children.length,e=this.selectedIndex+1;e<t;e++)if(this.isItemEnabled(e))return this.selectedIndex=e,!0;return!1},e.prototype._selectPrev=function(){for(var t=this.selectedIndex-1;t>=0;t--)if(this.isItemEnabled(t))return this.selectedIndex=t,!0;return!1},e.prototype._selectFirst=function(){for(var t=this.hostElement.children.length,e=0;e<t;e++)if(this.isItemEnabled(e))return this.selectedIndex=e,!0;return!1},e.prototype._selectLast=function(){for(var t=this.hostElement.children.length-1;t>=0;t--)if(this.isItemEnabled(t))return this.selectedIndex=t,!0;return!1},e.prototype._selectNextPage=function(){for(var t=this.hostElement,e=t.offsetHeight,i=t.children,o=0,n=this.selectedIndex+1;n<this._cv.items.length;n++){var s=i[n].scrollHeight;if(o+s>e&&this.isItemEnabled(n))return this.selectedIndex=n,!0;o+=s}return this._selectLast()},e.prototype._selectPrevPage=function(){for(var t=this.hostElement,e=t.offsetHeight,i=t.children,o=0,n=this.selectedIndex-1;n>0;n--){var s=i[n].scrollHeight;if(o+s>e&&this.isItemEnabled(n))return this.selectedIndex=n,!0;o+=s}return this._selectFirst()},e.prototype._findNext=function(){if(this.hostElement){var t=this.hostElement.childElementCount,e=this.selectedIndex;(e<0||1==this._search.length)&&e++;for(var i=0;i<t;i++){var o=(e+i)%t;if(0==this.getDisplayText(o).trim().toLowerCase().indexOf(this._search)&&this.isItemEnabled(o))return o}}return-1},e.prototype._getCheckbox=function(t){var e=this.hostElement,i=e?e.children:null;return t=this._getElementIndex(t),e&&t>-1&&t<i.length?i[t].querySelector("input[type=checkbox]"):null},e.prototype._initFromSelect=function(t){for(var e=t.children,i=[],o=-1,n=0;n<e.length;n++){var s=e[n];"OPTION"==s.tagName&&(s.hasAttribute("selected")&&(o=i.length),s.innerHTML?i.push({hdr:s.innerHTML,val:s.getAttribute("value"),cmdParam:s.getAttribute("cmd-param")}):i.push({hdr:'<div class="wj-separator"></div>'}),t.removeChild(s),n--)}i&&(this.displayMemberPath="hdr",this.selectedValuePath="val",this.itemsSource=i,this.selectedIndex=o)},e}(wijmo_1.Control);exports.ListBox=ListBox;var DateSelectionMode,FormatItemEventArgs=function(t){function e(e,i,o){var n=t.call(this)||this;return n._index=wijmo_1.asNumber(e),n._data=i,n._item=wijmo_1.asType(o,HTMLElement,!0),n}return __extends(e,t),Object.defineProperty(e.prototype,"index",{get:function(){return this._index},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){return this._data},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"item",{get:function(){return this._item},enumerable:!0,configurable:!0}),e}(wijmo_1.EventArgs);exports.FormatItemEventArgs=FormatItemEventArgs,wijmo_1._addCultureInfo("Calendar",{ariaLabels:{calendar:"Calendar",monthView:"Month View",yearView:"Year View",prvMo:"Previous Month",today:"Today",nxtMo:"Next Month",prvYr:"Previous Year",currMo:"Current Month",nxtYr:"Next Year"}}),function(t){t[t.None=0]="None",t[t.Day=1]="Day",t[t.Month=2]="Month"}(DateSelectionMode=exports.DateSelectionMode||(exports.DateSelectionMode={}));var Calendar=function(t){function e(e,i){var o=t.call(this,e,null,!0)||this;o._readOnly=!1,o._selMode=DateSelectionMode.Day,o._yrPicker=!0,o._tmYrHidden=0,o._fmtYrMo="y",o._fmtYr="yyyy",o._fmtDayHdr="ddd",o._fmtDay="d ",o._fmtMonths="MMM",o.valueChanged=new wijmo_1.Event,o.displayMonthChanged=new wijmo_1.Event,o.formatItem=new wijmo_1.Event(function(){o.invalidate()});var n=o.hostElement;n.tabIndex=-1,o._value=wijmo_1.DateTime.newDate(),o._currMonth=o._getMonth(o._value),o._createChildren(),o._createYearPicker();var s=o.addEventListener.bind(o);return s(n,"keydown",o._keydown.bind(o)),s(n,"click",o._click.bind(o)),o._rptUp=new wijmo_1._ClickRepeater(o._btnPrv),o._rptDn=new wijmo_1._ClickRepeater(o._btnNxt),o.addEventListener(n,"wheel",function(t){if(!t.defaultPrevented&&!o.isReadOnly&&o.containsFocus()){wijmo_1.clamp(-t.deltaY,-1,1);t.deltaY<0?o._btnPrv.click():o._btnNxt.click(),t.preventDefault()}}),o.initialize(i),o.refresh(!0),o}return __extends(e,t),Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(t){t=wijmo_1.asDate(t,!0),t=this._clamp(t),(this._valid(t)||null==t)&&(this.displayMonth=this._getMonth(t),wijmo_1.DateTime.equals(this._value,t)||(this._value=t,this.invalidate(!1),this.onValueChanged()))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"min",{get:function(){return this._min},set:function(t){t!=this.min&&(this._min=wijmo_1.asDate(t,!0),this.refresh())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"max",{get:function(){return this._max},set:function(t){t!=this.max&&(this._max=wijmo_1.asDate(t,!0),this.refresh())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectionMode",{get:function(){return this._selMode},set:function(t){if((t=wijmo_1.asEnum(t,DateSelectionMode))!=this._selMode){this._selMode=t;var e=this._monthMode();e&&(this.monthView=!1);var i=this._btnMth.querySelector(".wj-glyph-down");i&&(i.style.display=e?"none":""),this.refresh()}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isReadOnly",{get:function(){return this._readOnly},set:function(t){this._readOnly=wijmo_1.asBoolean(t),wijmo_1.toggleClass(this.hostElement,"wj-state-readonly",this.isReadOnly)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"repeatButtons",{get:function(){return!this._rptUp.disabled},set:function(t){this._rptUp.disabled=this._rptDn.disabled=!wijmo_1.asBoolean(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"showYearPicker",{get:function(){return this._yrPicker},set:function(t){this._yrPicker=wijmo_1.asBoolean(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"firstDayOfWeek",{get:function(){return this._fdw},set:function(t){if(t!=this._fdw){if((t=wijmo_1.asNumber(t,!0))&&(t>6||t<0))throw"firstDayOfWeek must be between 0 and 6 (Sunday to Saturday).";this._fdw=t,this.refresh()}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"displayMonth",{get:function(){return this._currMonth},set:function(t){wijmo_1.DateTime.equals(this.displayMonth,t)||(t=wijmo_1.asDate(t),(this.monthView?this._monthInValidRange(t):this._yearInValidRange(t))&&(this._currMonth=this._getMonth(this._clamp(t)),this.invalidate(!0),this.onDisplayMonthChanged()))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"formatYearMonth",{get:function(){return this._fmtYrMo},set:function(t){t!=this._fmtYrMo&&(this._fmtYrMo=wijmo_1.asString(t),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"formatDayHeaders",{get:function(){return this._fmtDayHdr},set:function(t){t!=this._fmtDayHdr&&(this._fmtDayHdr=wijmo_1.asString(t),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"formatDays",{get:function(){return this._fmtDay},set:function(t){t!=this._fmtDay&&(this._fmtDay=wijmo_1.asString(t),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"formatYear",{get:function(){return this._fmtYr},set:function(t){t!=this._fmtYr&&(this._fmtYr=wijmo_1.asString(t),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"formatMonths",{get:function(){return this._fmtMonths},set:function(t){t!=this._fmtMonths&&(this._fmtMonths=wijmo_1.asString(t),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"showHeader",{get:function(){return"none"!=this._tbHdr.style.display},set:function(t){this._tbHdr.style.display=wijmo_1.asBoolean(t)?"":"none"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"monthView",{get:function(){return"none"!=this._tbMth.style.display},set:function(t){if(t!=this.monthView){this._tbMth.style.display=t?"":"none",this._tbYr.style.display=t?"none":"",this.refresh();var e=wijmo_1.culture.Calendar.ariaLabels;wijmo_1.setAriaLabel(this._btnPrv,t?e.prvMo:e.prvYr),wijmo_1.setAriaLabel(this._btnTdy,t?e.today:e.currMo),wijmo_1.setAriaLabel(this._btnNxt,t?e.nxtMo:e.nxtYr),wijmo_1.setAriaLabel(this._btnMth,t?e.monthView:e.yearView)}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"itemFormatter",{get:function(){return this._itemFormatter},set:function(t){t!=this._itemFormatter&&(this._itemFormatter=wijmo_1.asFunction(t),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"itemValidator",{get:function(){return this._itemValidator},set:function(t){t!=this._itemValidator&&(this._itemValidator=wijmo_1.asFunction(t),this.invalidate())},enumerable:!0,configurable:!0}),e.prototype.onValueChanged=function(t){this.valueChanged.raise(this,t)},e.prototype.onDisplayMonthChanged=function(t){this.displayMonthChanged.raise(this,t)},e.prototype.onFormatItem=function(t){this.formatItem.raise(this,t)},e.prototype.containsFocus=function(){return t.prototype.containsFocus.call(this)||this._lbYears.containsFocus()},e.prototype.dispose=function(){this._rptUp.element=null,this._rptDn.element=null,this._lbYears.dispose(),t.prototype.dispose.call(this)},e.prototype.refresh=function(e){void 0===e&&(e=!0);var i,o,n,s=this.displayMonth,r=null!=this.firstDayOfWeek?this.firstDayOfWeek:wijmo_1.Globalize.getFirstDayOfWeek(),a=this.hostElement,l=wijmo_1.getActiveElement(),h=this.containsFocus(),c=wijmo_1.contains(a,l)?l:null;t.prototype.refresh.call(this,e),this._firstDay=wijmo_1.DateTime.addDays(s,-(s.getDay()-r+7)%7),wijmo_1.setText(this._spMth,wijmo_1.Globalize.format(s,this._fmtYrMo)),i=this._tbMth.querySelectorAll("td");for(var u=0;u<7&&u<i.length;u++)n=wijmo_1.DateTime.addDays(this._firstDay,u),wijmo_1.setText(i[u],wijmo_1.Globalize.format(n,this._fmtDayHdr));for(u=7;u<i.length;u++){o=i[u],n=wijmo_1.DateTime.addDays(this._firstDay,u-7),wijmo_1.setText(o,wijmo_1.Globalize.format(n,this._fmtDay));var p=!this._valid(n),d=this._selMode&&wijmo_1.DateTime.sameDate(n,this.value),m=n.getDay();if(wijmo_1.toggleClass(o,"wj-state-invalid",p),wijmo_1.toggleClass(o,"wj-state-selected",d),wijmo_1.toggleClass(o,"wj-day-weekend",0==m||6==m),wijmo_1.toggleClass(o,"wj-day-today",wijmo_1.DateTime.sameDate(n,wijmo_1.DateTime.newDate())),wijmo_1.toggleClass(o,"wj-day-othermonth",p||n.getMonth()!=s.getMonth()||!this._inValidRange(n)),wijmo_1.setAttribute(o,"aria-selected",d),o.tabIndex=-1,this.itemFormatter&&this.itemFormatter(n,o),this.formatItem.hasHandlers){var _=new FormatItemEventArgs(u,n,o);this.onFormatItem(_)}}var f=this._tbMth.querySelectorAll("tr");f.length&&(n=wijmo_1.DateTime.addDays(this._firstDay,28),f[f.length-2].style.display=n.getMonth()==s.getMonth()?"":"none",n=wijmo_1.DateTime.addDays(this._firstDay,35),f[f.length-1].style.display=n.getMonth()==s.getMonth()?"":"none"),(i=this._tbYr.querySelectorAll("td")).length&&wijmo_1.setText(i[0],wijmo_1.Globalize.format(s,this._fmtYr));for(u=1;u<i.length;u++){n=wijmo_1.DateTime.newDate(s.getFullYear(),u-1,1);p=!this._monthInValidRange(n),d=this._sameMonth(n,this.value);o=i[u],wijmo_1.setText(o,wijmo_1.Globalize.format(n,this._fmtMonths)),wijmo_1.toggleClass(o,"wj-state-disabled",p),wijmo_1.toggleClass(o,"wj-state-selected",d),wijmo_1.setAttribute(o,"aria-selected",d),o.tabIndex=-1}var w=(this.monthView?this._tbMth:this._tbYr).querySelector("td.wj-state-selected")||a;w.tabIndex=this._orgTabIndex,h&&(c&&c!=w&&(c.tabIndex=-1),w.focus())},e.prototype._canChangeValue=function(){return!this._readOnly&&this._selMode!=DateSelectionMode.None},e.prototype._valid=function(t){return!!wijmo_1.isDate(t)&&(!!wijmo_1.DateTime.sameDate(t,this._clamp(t))&&(!wijmo_1.isFunction(this.itemValidator)||this.itemValidator(t)))},e.prototype._inValidRange=function(t){return!(this.min&&t<wijmo_1.DateTime.fromDateTime(this.min,t))&&!(this.max&&t>wijmo_1.DateTime.fromDateTime(this.max,t))},e.prototype._monthInValidRange=function(t){if(this.min||this.max){var e=t.getFullYear(),i=t.getMonth(),o=wijmo_1.DateTime.newDate(e,i,1),n=wijmo_1.DateTime.newDate(e,i+1,0);if(this.min&&this.min>n)return!1;if(this.max&&this.max<o)return!1}return!0},e.prototype._yearInValidRange=function(t){if(this.min||this.max){var e=t.getFullYear(),i=wijmo_1.DateTime.newDate(e,0,1),o=wijmo_1.DateTime.newDate(e,11,31);if(this.min&&this.min>o)return!1;if(this.max&&this.max<i)return!1}return!0},e.prototype._sameMonth=function(t,e){return wijmo_1.isDate(t)&&wijmo_1.isDate(e)&&t.getMonth()==e.getMonth()&&t.getFullYear()==e.getFullYear()},e.prototype._getValidDate=function(t,e){if(wijmo_1.isDate(t))for(var i=t.getFullYear(),o=t.getMonth()+(e?0:1),n=e?1:0,s=wijmo_1.DateTime.newDate(i,o,n),r=e?1:-1,a=0;a<31;a++){if(this._valid(s))return s;s=wijmo_1.DateTime.addDays(s,r)}return null},e.prototype._clamp=function(t){if(t){if(this.min){var e=wijmo_1.DateTime.fromDateTime(this.min,t);t<e&&(t=e)}if(this.max){var i=wijmo_1.DateTime.fromDateTime(this.max,t);t>i&&(t=i)}}return t},e.prototype._createChildren=function(){var t=this.getTemplate();this.applyTemplate("wj-control wj-calendar",t,{_tbHdr:"tbl-header",_btnMth:"btn-month",_spMth:"span-month",_btnPrv:"btn-prev",_btnTdy:"btn-today",_btnNxt:"btn-next",_tbMth:"tbl-month",_tbYr:"tbl-year"});var e=wijmo_1.culture.Calendar.ariaLabels;wijmo_1.setAriaLabel(this._tbMth,e.calendar),wijmo_1.setAriaLabel(this._tbYr,e.calendar),wijmo_1.setAriaLabel(this._btnPrv,e.calendar),wijmo_1.setAriaLabel(this._btnMth,e.monthView),wijmo_1.setAriaLabel(this._btnPrv,e.prvMo),wijmo_1.setAriaLabel(this._btnTdy,e.today),wijmo_1.setAriaLabel(this._btnNxt,e.nxtMo);for(var i=this._createElement("tr",this._tbMth,"wj-header"),o=0;o<7;o++)this._createElement("td",i);for(var n=0;n<6;n++){i=this._createElement("tr",this._tbMth);for(o=0;o<7;o++)this._createElement("td",i)}i=this._createElement("tr",this._tbYr,"wj-header"),this._createElement("td",i).setAttribute("colspan","4");for(var s=0;s<3;s++){i=this._createElement("tr",this._tbYr);for(var r=0;r<4;r++)this._createElement("td",i)}},e.prototype._createYearPicker=function(){var t=this,e=this.hostElement,i=this._createElement("div",null,"wj-dropdown-panel wj-yearpicker");i.tabIndex=this._orgTabIndex,this._lbYears=new ListBox(i,{lostFocus:function(e,o){if(wijmo_1.hidePopup(i),t._tmYrHidden=Date.now(),t.removeEventListener(window,"touchstart"),e.selectedIndex>-1){var n=wijmo_1.DateTime.clone(t.displayMonth);n.setFullYear(e.selectedIndex+e.itemsSource[0]),t.displayMonth=n}}}),this.addEventListener(i,"keydown",function(i){switch(i.keyCode){case wijmo_1.Key.Enter:e.focus();break;case wijmo_1.Key.Escape:t._lbYears.selectedIndex=-1,e.focus()}i.defaultPrevented&&i.stopPropagation()}),this.addEventListener(i,"click",function(t){e.focus()})},e.prototype._createElement=function(t,e,i){var o=document.createElement(t);if(o.tabIndex=-1,i&&wijmo_1.addClass(o,i),"TD"==o.tagName){var n=wijmo_1.closest(o,".wj-header")?"columnheader":"gridcell";wijmo_1.setAttribute(o,"role",n),wijmo_1.setAttribute(o,"aria-selected",!1)}return e&&e.appendChild(o),o},e.prototype._click=function(t){var e=this;if(!t.defaultPrevented&&0==t.button){var i=!1,o=t.target;if(wijmo_1.contains(this._btnMth,o)&&!this._monthMode()?(this.monthView=!this.monthView,i=!0):wijmo_1.contains(this._btnPrv,o)?(this._navigate(-1),i=!0):wijmo_1.contains(this._btnNxt,o)?(this._navigate(1),i=!0):wijmo_1.contains(this._btnTdy,o)&&(this._navigate(0),i=!0),o&&!i&&this._yrPicker&&wijmo_1.contains(this._tbYr,o)&&wijmo_1.closest(o,".wj-header")){if(Date.now()-this._tmYrHidden<600)return void t.preventDefault();for(var n=this.displayMonth.getFullYear(),s=this.min?this.min.getFullYear():n-100,r=this.max?this.max.getFullYear():n+100,a=[],l=s;l<=r;l++)a.push(l);var h=this._lbYears,c=h.hostElement,u=wijmo_1.closest(o,".wj-header");return h.itemsSource=a,h.selectedIndex=n-a[0],wijmo_1.setAttribute(c,"dir",this.rightToLeft?"rtl":null),c.style.minWidth="",wijmo_1.showPopup(c,u,!1,!1,this.hostElement),h.focus(),this.addEventListener(window,"touchstart",function(t){wijmo_1.contains(c,t.target)||(wijmo_1.hidePopup(c),e._tmYrHidden=Date.now(),e.removeEventListener(window,"touchstart"))}),void t.preventDefault()}if(o&&!i){var p,d=wijmo_1.closest(o,"TD");if(d)if(this.monthView){if((p=this._getCellIndex(this._tbMth,d))>6&&this._canChangeValue()){var m=wijmo_1.DateTime.fromDateTime(wijmo_1.DateTime.addDays(this._firstDay,p-7),this.value);this._inValidRange(m)&&this._valid(m)&&(this.value=m),i=!0}}else if((p=this._getCellIndex(this._tbYr,d))>0){if(this.displayMonth=wijmo_1.DateTime.newDate(this.displayMonth.getFullYear(),p-1,1),this._monthMode()){if(this._canChangeValue()){m=wijmo_1.DateTime.fromDateTime(this.displayMonth,this.value);this._inValidRange(m)&&(this.value=m)}}else this.monthView=!0;i=!0}}i&&(t.preventDefault(),this.focus())}},e.prototype._getCellIndex=function(t,e){for(var i=t.querySelectorAll("TD"),o=0;o<i.length;o++)if(i[o]==e)return o;return-1},e.prototype._keydown=function(t){if(!t.defaultPrevented){if(t.altKey)switch(t.keyCode){case wijmo_1.Key.Up:case wijmo_1.Key.Down:return;case wijmo_1.Key.End:return this._navigate(0),void t.preventDefault()}if(!(t.ctrlKey||t.metaKey||t.shiftKey)){var e=this._getKeyCode(t),i=0,o=0,n=!0;if(this.monthView)switch(e){case wijmo_1.Key.Left:i=-1;break;case wijmo_1.Key.Right:i=1;break;case wijmo_1.Key.Up:i=-7;break;case wijmo_1.Key.Down:i=7;break;case wijmo_1.Key.PageDown:o=t.altKey?12:1;break;case wijmo_1.Key.PageUp:o=t.altKey?-12:-1;break;case wijmo_1.Key.Home:case wijmo_1.Key.End:if(this._canChangeValue()){var s=this.value||this.displayMonth;(r=this._getValidDate(s,e==wijmo_1.Key.Home))&&(this.value=wijmo_1.DateTime.fromDateTime(r,this.value))}break;default:n=!1}else switch(e){case wijmo_1.Key.Left:o=-1;break;case wijmo_1.Key.Right:o=1;break;case wijmo_1.Key.Up:o=-4;break;case wijmo_1.Key.Down:o=4;break;case wijmo_1.Key.PageDown:o=t.altKey?120:12;break;case wijmo_1.Key.PageUp:o=t.altKey?-120:-12;break;case wijmo_1.Key.Home:o=this.value?-this.value.getMonth():0;break;case wijmo_1.Key.End:o=this.value?11-this.value.getMonth():0;break;case wijmo_1.Key.Enter:this._monthMode()?n=!1:this.monthView=!0;break;default:n=!1}if(this._canChangeValue()&&(i||o)){var r;if((r=this.value)?(r=wijmo_1.DateTime.addDays(r,i),r=wijmo_1.DateTime.addMonths(r,o)):r=this._getValidDate(new Date,!0),o&&!this._valid(r)){s=r.getMonth();for(var a=1;a<31&&!this._valid(r);a++){var l=wijmo_1.DateTime.addDays(r,+a),h=wijmo_1.DateTime.addDays(r,-a);this._valid(l)&&l.getMonth()==s?r=l:this._valid(h)&&h.getMonth()==s&&(r=h)}}for(a=0;a<31&&!this._valid(r);a++)r=wijmo_1.DateTime.addDays(r,i>0||o>0?1:-1);this.value=r}n&&t.preventDefault()}}},e.prototype._getMonth=function(t){return t||(t=wijmo_1.DateTime.newDate()),wijmo_1.DateTime.newDate(t.getFullYear(),t.getMonth(),1)},e.prototype._monthMode=function(){return this.selectionMode==DateSelectionMode.Month},e.prototype._navigate=function(t){var e=this.monthView,i=this.displayMonth;switch(t){case 0:var o=wijmo_1.DateTime.newDate();this._canChangeValue()&&(this.value=e?wijmo_1.DateTime.fromDateTime(o,this.value):this._getMonth(o)),i=this._getMonth(o);break;case 1:i=wijmo_1.DateTime.addMonths(i,e?1:12);break;case-1:i=wijmo_1.DateTime.addMonths(i,e?-1:-12)}this.displayMonth=i},e.controlTemplate='<div class="wj-content wj-calendar-outer"><div wj-part="tbl-header" class="wj-calendar-header"><div wj-part="btn-month" class="wj-month-select" role="button"><span wj-part="span-month"></span> <span class="wj-glyph-down"></span></div><div class="wj-btn-group"><button wj-part="btn-prev" class="wj-btn wj-btn-default" tabindex="-1"><span class="wj-glyph-left"></span></button><button wj-part="btn-today" class="wj-btn wj-btn-default" tabindex="-1"><span class="wj-glyph-circle"></span></button><button wj-part="btn-next" class="wj-btn wj-btn-default" tabindex="-1"><span class="wj-glyph-right"></span></button></div></div><table wj-part="tbl-month" class="wj-calendar-month" role="grid"></table><table wj-part="tbl-year" class="wj-calendar-year" role="grid" style="display:none"></table></div>',e}(wijmo_1.Control);exports.Calendar=Calendar,wijmo_1._addCultureInfo("DropDown",{ariaLabels:{tgl:"Toggle Dropdown"}});var PopupTrigger,DropDown=function(t){function e(e,i){var o=t.call(this,e,null,!0)||this;o._showBtn=!0,o._autoExpand=!0,o._animate=!1,o.textChanged=new wijmo_1.Event,o.isDroppedDownChanging=new wijmo_1.Event,o.isDroppedDownChanged=new wijmo_1.Event;var n=o.getTemplate();o.applyTemplate("wj-control wj-content wj-dropdown",n,{_tbx:"input",_btn:"btn",_dropDown:"dropdown"},"input");var s=wijmo_1.culture.DropDown.ariaLabels;wijmo_1.setAriaLabel(o._btn.querySelector("button"),s.tgl);var r=o._elRef=o._tbx;wijmo_1.disableAutoComplete(r),o._createDropDown(),o._updateBtn();var a=o.hostElement;wijmo_1.addClass(a,"wj-state-collapsed");var l=o.dropDown,h=o.addEventListener.bind(o),c=o._updateFocusState.bind(o);h(l,"blur",c,!0),h(l,"focus",c);var u=o._keydown.bind(o);return h(a,"keydown",u),h(l,"keydown",u),h(r,"keypress",function(t){9787==t.keyCode&&o._altDown&&t.preventDefault()}),h(r,"keyup",function(t){o._altDown=o._altDown||t.altKey}),h(r,"input",function(){o._setText(o.text,!1)}),h(r,"click",function(){o._autoExpand&&o._expandSelection()}),h(r,"blur",function(){o._commitText()},!0),h(o._btn,"mousedown",function(t){t.defaultPrevented||0!=t.button||(o._btnclick(t),t.preventDefault())}),wijmo_1.removeChild(l),wijmo_1.isIE()&&o._elRef==o._tbx&&h(a,"mouseup",function(t){if(!t.defaultPrevented&&0==t.button&&wijmo_1.hasClass(t.target,"wj-btn")){var e=wijmo_1.getActiveElement();e&&e!=t.target&&setTimeout(function(){e.focus()})}}),wijmo_1.isIE9()&&h(r,"keyup",function(){o._setText(o.text,!1)}),h(l,"click",o._dropDownClick.bind(o)),o}return __extends(e,t),Object.defineProperty(e.prototype,"text",{get:function(){return this._tbx.value},set:function(t){t!=this.text&&this._setText(t,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inputElement",{get:function(){return this._tbx},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inputType",{get:function(){return this._tbx.type},set:function(t){this._tbx.type=wijmo_1.asString(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isReadOnly",{get:function(){return this._tbx.readOnly},set:function(t){this._tbx.readOnly=wijmo_1.asBoolean(t),wijmo_1.toggleClass(this.hostElement,"wj-state-readonly",this.isReadOnly)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isRequired",{get:function(){return this._tbx.required},set:function(t){this._tbx.required=wijmo_1.asBoolean(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"placeholder",{get:function(){return this._tbx.placeholder},set:function(t){this._tbx.placeholder=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isDroppedDown",{get:function(){var t=this._dropDown;return t&&"none"!=t.style.display},set:function(t){var e=this,i=this.hostElement,o=this._dropDown,n=this.containsFocus()||this._setFocus;i&&o&&(t=wijmo_1.asBoolean(t)&&!this.isDisabled&&!this.isReadOnly)!=this.isDroppedDown&&this.onIsDroppedDownChanging(new wijmo_1.CancelEventArgs)&&(t?(this._minWidthDropdown=o.style.minWidth,o.style.display="block",this._updateDropDown(),this.addEventListener(window,"touchstart",function(t){for(var o=t.target;o;){if(o==i)return;o=o[wijmo_1.Control._OWNR_KEY]||o.parentNode}wijmo_1.Control._touching=!0,e.isDroppedDown=!1,wijmo_1.Control._touching=!1})):(this.removeEventListener(window,"touchstart"),wijmo_1.hidePopup(o),o.style.minWidth=this._minWidthDropdown),this._setFocus=!1,n&&(this.isTouching&&this.showDropDownButton?i.focus():this.selectAll()),this._updateFocusState(),wijmo_1.toggleClass(i,"wj-state-collapsed",!this.isDroppedDown),this.onIsDroppedDownChanged())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dropDown",{get:function(){return this._dropDown},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dropDownCssClass",{get:function(){return this._cssClass},set:function(t){t!=this._cssClass&&(wijmo_1.removeClass(this._dropDown,this._cssClass),this._cssClass=wijmo_1.asString(t),wijmo_1.addClass(this._dropDown,this._cssClass))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"showDropDownButton",{get:function(){return this._showBtn},set:function(t){this._showBtn=wijmo_1.asBoolean(t),this._updateBtn()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"autoExpandSelection",{get:function(){return this._autoExpand},set:function(t){this._autoExpand=wijmo_1.asBoolean(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isAnimated",{get:function(){return this._animate},set:function(t){this._animate=wijmo_1.asBoolean(t)},enumerable:!0,configurable:!0}),e.prototype.selectAll=function(){var t=this._tbx;this._elRef==t&&wijmo_1.setSelectionRange(t,0,this.text.length),this.containsFocus()||this.focus()},e.prototype.onTextChanged=function(t){this.textChanged.raise(this,t),this._updateState()},e.prototype.onIsDroppedDownChanging=function(t){return this.isDroppedDownChanging.raise(this,t),!t.cancel},e.prototype.onIsDroppedDownChanged=function(t){this.isDroppedDownChanged.raise(this,t)},e.prototype.onGotFocus=function(e){this.isTouching||wijmo_1.contains(this._dropDown,wijmo_1.getActiveElement())||this.selectAll(),t.prototype.onGotFocus.call(this,e)},e.prototype.onLostFocus=function(e){this._commitText(),this.isDroppedDown=!1,t.prototype.onLostFocus.call(this,e)},e.prototype.containsFocus=function(){return t.prototype.containsFocus.call(this)||this.isDroppedDown&&wijmo_1.contains(this._dropDown,wijmo_1.getActiveElement())},e.prototype.dispose=function(){this.isDroppedDown=!1;var e=this._dropDown;if(e){var i=wijmo_1.Control.getControl(e);i&&i.dispose(),wijmo_1.removeChild(e),this._dropDown=null}t.prototype.dispose.call(this)},e.prototype.refresh=function(e){if(void 0===e&&(e=!0),t.prototype.refresh.call(this,e),this.hostElement.offsetHeight&&this.isDroppedDown){var i=wijmo_1.getActiveElement();this.isAnimated&&""!=this._dropDown.style.opacity||wijmo_1.showPopup(this._dropDown,this.hostElement,!1,!1,null==this.dropDownCssClass),i instanceof HTMLElement&&i!=wijmo_1.getActiveElement()&&i.focus()}},e.prototype._handleResize=function(){this.isDroppedDown&&this.refresh()},e.prototype._dropDownClick=function(t){t.stopPropagation()},e.prototype._expandSelection=function(){var t=this._tbx,e=t.value,i=t.selectionStart,o=t.selectionEnd;if(e&&i==o){var n=this._getCharType(e,i);if(n>-1){for(;o<e.length&&this._getCharType(e,o)==n;o++);for(;i>0&&this._getCharType(e,i-1)==n;i--);i!=o&&wijmo_1.setSelectionRange(t,i,o)}}},e.prototype._getCharType=function(t,e){var i=t[e];return i>="0"&&i<="9"?0:i>="a"&&i<="z"||i>="A"&&i<="Z"?1:-1},e.prototype._keydown=function(t){if(this._altDown=t.altKey,!t.defaultPrevented)switch(t.keyCode){case wijmo_1.Key.Tab:case wijmo_1.Key.Escape:case wijmo_1.Key.Enter:this.isDroppedDown&&(this.isDroppedDown=!1,t.keyCode==wijmo_1.Key.Tab||this.containsFocus()||this.focus(),t.preventDefault());break;case wijmo_1.Key.F4:case wijmo_1.Key.Up:case wijmo_1.Key.Down:if(t.keyCode==wijmo_1.Key.F4||t.altKey){var e=this.hostElement;e&&e.offsetHeight&&(this.isDroppedDown=!this.isDroppedDown,t.preventDefault())}}},e.prototype._btnclick=function(t){0==t.button&&(this._setFocus=!0,this.isDroppedDown=!this.isDroppedDown)},e.prototype._setText=function(t,e){null==t&&(t=""),(t=t.toString())!=this._tbx.value&&(this._tbx.value=t),t!=this._oldText&&(this._oldText=t,this.onTextChanged())},e.prototype._updateBtn=function(){this._btn.style.display=this._showBtn?"":"none"},e.prototype._createDropDown=function(){},e.prototype._commitText=function(){},e.prototype._updateDropDown=function(){if(this.isDroppedDown){this._commitText();var t=this.dropDown;wijmo_1.setAttribute(t,"dir",this.rightToLeft?"rtl":null),wijmo_1.showPopup(t,this.hostElement,!1,this._animate,null==this.dropDownCssClass)}},e.controlTemplate='<div class="wj-template"><div class="wj-input"><div class="wj-input-group wj-input-btn-visible"><input wj-part="input" type="text" class="wj-form-control"/><span wj-part="btn" class="wj-input-group-btn"><button class="wj-btn wj-btn-default" tabindex="-1"><span class="wj-glyph-down"></span></button></span></div></div><div wj-part="dropdown" class="wj-content wj-dropdown-panel" style="display:none"></div></div>',e}(wijmo_1.Control);exports.DropDown=DropDown,function(t){t[t.None=0]="None",t[t.Click=1]="Click",t[t.Blur=2]="Blur",t[t.ClickOrBlur=3]="ClickOrBlur"}(PopupTrigger=exports.PopupTrigger||(exports.PopupTrigger={}));var Popup=function(t){function e(e,i){var o=t.call(this,e,null,!0)||this;o._showTrigger=PopupTrigger.Click,o._hideTrigger=PopupTrigger.Blur,o._hideAnim=[],o._fadeIn=!0,o._fadeOut=!0,o._removeOnHide=!0,o._visible=!1,o._ownerClickBnd=o._ownerClick.bind(o),o._ownerMousedownBnd=o._ownerMouseDown.bind(o),o.showing=new wijmo_1.Event,o.shown=new wijmo_1.Event,o.hiding=new wijmo_1.Event,o.hidden=new wijmo_1.Event;var n=o.hostElement;return wijmo_1.addClass(n,"wj-control wj-content wj-popup"),n.getAttribute("tabindex")||(n.tabIndex=0),wijmo_1.hidePopup(n,!1),o.addEventListener(n,"compositionstart",function(t){o._composing=!0}),o.addEventListener(n,"compositionend",function(t){o._composing=!1}),o.addEventListener(n,"keydown",function(t){if(!t.defaultPrevented){if(t.keyCode!=wijmo_1.Key.Escape||o._composing||(t.preventDefault(),o.hide()),t.keyCode==wijmo_1.Key.Enter){var e=o.dialogResultEnter;e&&(t.preventDefault(),o._validateAndHide(e))}t.keyCode==wijmo_1.Key.Tab&&o.modal&&(t.preventDefault(),wijmo_1.moveFocus(n,t.shiftKey?-1:1))}}),o.addEventListener(n,"click",function(t){if(t.target instanceof HTMLElement){var e=t.target.className.match(/\bwj-hide[\S]*\b/);e&&e.length>0&&(t.preventDefault(),t.stopPropagation(),o.hide(e[0]))}}),o.addEventListener(document,"wheel",function(t){if(o.isVisible&&o._modal){for(var e=t.target;e&&e!=document.body;e=e.parentElement)if(e.scrollHeight>e.clientHeight)return;t.preventDefault()}}),o.initialize(i),o}return __extends(e,t),Object.defineProperty(e.prototype,"owner",{get:function(){return this._owner},set:function(t){var e=this._owner;e&&(this.removeEventListener(e,"mousedown"),this.removeEventListener(e,"click")),(e=this._owner=null!=t?wijmo_1.getElement(t):null)&&(this.addEventListener(e,"mousedown",this._ownerMousedownBnd,!0),this.addEventListener(e,"click",this._ownerClickBnd,!0))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"content",{get:function(){return this.hostElement.firstElementChild},set:function(t){t!=this.content&&(this.hostElement.innerHTML="",t instanceof HTMLElement&&this.hostElement.appendChild(t))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"showTrigger",{get:function(){return this._showTrigger},set:function(t){this._showTrigger=wijmo_1.asEnum(t,PopupTrigger)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hideTrigger",{get:function(){return this._hideTrigger},set:function(t){this._hideTrigger=wijmo_1.asEnum(t,PopupTrigger)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fadeIn",{get:function(){return this._fadeIn},set:function(t){this._fadeIn=wijmo_1.asBoolean(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fadeOut",{get:function(){return this._fadeOut},set:function(t){this._fadeOut=wijmo_1.asBoolean(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"removeOnHide",{get:function(){return this._removeOnHide},set:function(t){this._removeOnHide=wijmo_1.asBoolean(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"modal",{get:function(){return this._modal},set:function(t){this._modal=wijmo_1.asBoolean(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isDraggable",{get:function(){return this._draggable},set:function(t){this._draggable=wijmo_1.asBoolean(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dialogResult",{get:function(){return this._result},set:function(t){this._result=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dialogResultEnter",{get:function(){return this._resultEnter},set:function(t){this._resultEnter=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isVisible",{get:function(){var t=this.hostElement;return this._visible&&null!=t&&t.offsetHeight>0},enumerable:!0,configurable:!0}),e.prototype.show=function(t,e){var i=this;if(!this.isVisible){var o=this.hostElement;this.dialogResult=null,this._callback=null,this._hideAnim.forEach(function(t){clearInterval(t)}),this._hideAnim.length=0;var n=new wijmo_1.CancelEventArgs;this.onShowing(n)&&(null!=t&&(this.modal=wijmo_1.asBoolean(t)),null!=e&&(this._callback=wijmo_1.asFunction(e)),wijmo_1.showPopup(o,this._owner,!1,this._fadeIn,!1),this._modal&&this._showBackdrop(),this._composing=!1,this._visible=!0,this.onShown(n),this.modal&&this.addEventListener(window,"focus",function(){i.containsFocus()||wijmo_1.moveFocus(o,0)}),this._dragged=!1,this._makeDraggable(this._draggable),this.addEventListener(window,"touchstart",function(t){i._hideTrigger&PopupTrigger.Blur&&!wijmo_1.contains(o,t.target,!0)&&i.hide()}),setTimeout(function(){if(!i.isTouching){var t=o.querySelector("input[autofocus]");t&&t.clientHeight>0&&!t.disabled&&t.tabIndex>-1&&!wijmo_1.closest(t,"[disabled],.wj-state-disabled")?(t.focus(),t.select()):wijmo_1.moveFocus(o,0)}i.containsFocus()||(o.tabIndex=0,o.focus())},200))}},e.prototype.hide=function(t){var e=this;if(this._makeDraggable(!1),this.removeEventListener(window,"touchstart"),this.isVisible){wijmo_1.isUndefined(t)||(this.dialogResult=t);var i=new wijmo_1.CancelEventArgs;if(this.onHiding(i)){for(var o=this.hostElement.querySelectorAll(".wj-control.wj-dropdown"),n=0;n<o.length;n++){var s=wijmo_1.Control.getControl(o[n]);s instanceof DropDown&&(s.isDroppedDown=!1)}var r=this.removeOnHide,a=this.fadeOut;this._bkdrop&&this._hideAnim.push(wijmo_1.hidePopup(this._bkdrop,r,a)),this._hideAnim.push(wijmo_1.hidePopup(this.hostElement,r,a)),this._visible=!1,this.removeEventListener(window,"focus"),this.containsFocus()&&wijmo_1.getActiveElement().blur(),setTimeout(function(){e._updateState(),e.onHidden(i),e._callback&&e._callback(e)})}}},e.prototype.onShowing=function(t){return this.showing.raise(this,t),!t.cancel},e.prototype.onShown=function(t){this.shown.raise(this,t)},e.prototype.onHiding=function(t){return this.hiding.raise(this,t),!t.cancel},e.prototype.onHidden=function(t){this.hidden.raise(this,t)},e.prototype.dispose=function(){this.owner=null,t.prototype.dispose.call(this)},e.prototype.onLostFocus=function(e){this.isVisible&&this._hideTrigger&PopupTrigger.Blur&&(this.containsFocus()||this.hide()),t.prototype.onLostFocus.call(this,e)},e.prototype.refresh=function(e){if(void 0===e&&(e=!0),t.prototype.refresh.call(this,e),this.isVisible&&!this._refreshing){this._refreshing=!0;var i=wijmo_1.getActiveElement(),o=this._owner?this._owner.getBoundingClientRect():null;wijmo_1.showPopup(this.hostElement,o),this._modal&&i instanceof HTMLElement&&i!=wijmo_1.getActiveElement()&&i.focus(),this._refreshing=!1}},e.prototype._makeDraggable=function(t){var i,o,n=this,s=this.hostElement,r=s?s.querySelector(".wj-dialog-header"):null,a=document,l="mousedown",h="mousemove",c="mouseup",u="touchstart",p="touchmove",d="touchend",m=!1,_=function(t){s&&wijmo_1.contains(r,t.target)&&!t.button&&(i=new wijmo_1.Point(s.offsetLeft,s.offsetTop),o=wijmo_1.mouseToPage(t),m=!1,[h,c,p,d].forEach(function(t){n.removeEventListener(a,t)}),[h,p].forEach(function(t){n.addEventListener(a,t,f,!1,!0)}),[c,d].forEach(function(t){n.addEventListener(a,t,w)}))},f=function(t){var r=wijmo_1.mouseToPage(t),a=r.x-o.x,l=r.y-o.y;(m||Math.abs(a)+Math.abs(l)>e._DRAG_THRESHOLD)&&(wijmo_1.setCss(s,{left:Math.max(i.x+a,50-s.offsetWidth),top:Math.max(i.y+(r.y-o.y),0)}),n._dragged=!0,m=!0)},w=function(t){[h,c,p,d].forEach(function(t){n.removeEventListener(a,t)})};[l,u].forEach(function(t){n.removeEventListener(a,t)}),r&&(wijmo_1.setCss(r,{touchAction:t?"none":""}),t&&[l,u].forEach(function(t){n.addEventListener(a,t,_)}))},e.prototype._handleResize=function(){this.isVisible&&!this._dragged&&this.refresh()},e.prototype._ownerClick=function(t){this.isVisible?this._hideTrigger&PopupTrigger.Click&&this.hide():this._showTrigger&PopupTrigger.Click&&(this._wasVisible||this.show())},e.prototype._ownerMouseDown=function(t){this._wasVisible=this.isVisible},e.prototype._showBackdrop=function(){var t=this;this._bkdrop||(this._bkdrop=document.createElement("div"),this._bkdrop.tabIndex=-1,wijmo_1.addClass(this._bkdrop,"wj-popup-backdrop"),this.addEventListener(this._bkdrop,"mousedown",function(e){e.preventDefault(),e.stopPropagation(),t.hostElement.focus(),t.hideTrigger&PopupTrigger.Blur&&t.hide()})),wijmo_1.setCss(this._bkdrop,{zIndex:wijmo_1.Control._POPUP_ZINDEX,display:""});var e=this.hostElement;e.parentElement.insertBefore(this._bkdrop,e)},e.prototype._validateAndHide=function(t){var e=this.hostElement.querySelector(":invalid");e?e.focus():this.hide(t)},e._DRAG_THRESHOLD=6,e}(wijmo_1.Control);exports.Popup=Popup;var InputDate=function(t){function e(e,i){var o=t.call(this,e)||this;if(o._format="d",o.valueChanged=new wijmo_1.Event,wijmo_1.addClass(o.hostElement,"wj-inputdate"),o._msk=new wijmo_1._MaskProvider(o._tbx),wijmo_1.isIE9()||(o.inputType="tel"),o._tbx.type.match(/date/i)&&(o.inputType=""),o.addEventListener(o.hostElement,"wheel",function(t){if(!t.defaultPrevented&&!o.isDroppedDown&&o.containsFocus()&&null!=o.value&&o._canChangeValue()){var e=wijmo_1.clamp(-t.deltaY,-1,1);o.value=o.selectionMode==DateSelectionMode.Month?wijmo_1.DateTime.addMonths(o.value,e):wijmo_1.DateTime.addDays(o.value,e),o.selectAll(),t.preventDefault()}}),o.value=wijmo_1.DateTime.newDate(),"INPUT"==o._orgTag){var n=o._tbx.getAttribute("value");n&&(o.value=wijmo_1.Globalize.parseDate(n,"yyyy-MM-dd"))}return o.isRequired=!0,o.initialize(i),o}return __extends(e,t),Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(t){if(wijmo_1.DateTime.equals(this._value,t))this._tbx.value=wijmo_1.Globalize.format(t,this.format);else{var e=!this.isRequired||null==t&&null==this.value;t=wijmo_1.asDate(t,e),t=this._clamp(t),this._isValidDate(t)?(this._tbx.value=t?wijmo_1.Globalize.format(t,this.format):"",t==this._value||wijmo_1.DateTime.equals(this._value,t)||(this._value=t,this.onValueChanged())):this._tbx.value=t?wijmo_1.Globalize.format(this.value,this.format):"",this._calChanging=!0,this._calendar.value=this.value,this._calChanging=!1,this.text!=this._oldText&&(this._oldText=this.text,this.onTextChanged())}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"text",{get:function(){return this._tbx.value},set:function(t){t!=this.text&&(this._setText(t,!0),this._commitText())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectionMode",{get:function(){return this.calendar.selectionMode},set:function(t){this.calendar.selectionMode=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"min",{get:function(){return this._calendar.min},set:function(t){this._calendar.min=wijmo_1.asDate(t,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"max",{get:function(){return this._calendar.max},set:function(t){this._calendar.max=wijmo_1.asDate(t,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"repeatButtons",{get:function(){return this.calendar.repeatButtons},set:function(t){this.calendar.repeatButtons=wijmo_1.asBoolean(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"showYearPicker",{get:function(){return this.calendar.showYearPicker},set:function(t){this.calendar.showYearPicker=wijmo_1.asBoolean(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"format",{get:function(){return this._format},set:function(t){t!=this.format&&(this._format=wijmo_1.asString(t),this._tbx.value=wijmo_1.Globalize.format(this.value,this.format))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mask",{get:function(){return this._msk.mask},set:function(t){this._msk.mask=wijmo_1.asString(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"calendar",{get:function(){return this._calendar},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inputElement",{get:function(){return this._tbx},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inputType",{get:function(){return this._tbx.type},set:function(t){this._tbx.type=wijmo_1.asString(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"itemValidator",{get:function(){return this._calendar.itemValidator},set:function(t){t!=this.itemValidator&&(this._calendar.itemValidator=wijmo_1.asFunction(t),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"itemFormatter",{get:function(){return this.calendar.itemFormatter},set:function(t){t!=this.itemFormatter&&(this.calendar.itemFormatter=wijmo_1.asFunction(t))},enumerable:!0,configurable:!0}),e.prototype.onValueChanged=function(t){this.valueChanged.raise(this,t)},e.prototype.refresh=function(e){void 0===e&&(e=!0),t.prototype.refresh.call(this,e),this.isDroppedDown=!1,this._msk&&this._msk.refresh(),this._calendar&&this._calendar.refresh(),this._tbx.value=wijmo_1.Globalize.format(this.value,this.format)},e.prototype.onIsDroppedDownChanged=function(e){t.prototype.onIsDroppedDownChanged.call(this,e),this.isDroppedDown&&(this._calChanged=!1,this.dropDown.focus(),this._calendar.refresh())},e.prototype._createDropDown=function(){var t=this;this._calendar=new Calendar(this._dropDown),this._calendar.valueChanged.addHandler(function(){t._calChanging||(t.value=wijmo_1.DateTime.fromDateTime(t._calendar.value,t.value),t._calChanged=!0)}),this.addEventListener(this._dropDown,"click",function(e){var i=e.target;wijmo_1.hasClass(i,"wj-state-invalid")||wijmo_1.closest(i,".wj-header")&&wijmo_1.closest(i,".wj-calendar-year")||(t._calChanged&&!wijmo_1.closest(i,".wj-calendar-header")?t.isDroppedDown=!1:(i=wijmo_1.closest(i,".wj-btn"))&&"btn-today"==i.getAttribute("wj-part")&&(t.isDroppedDown=!1))})},e.prototype._updateDropDown=function(){this._commitText();var e=this._calendar;e.value=this.value,e.min=this.min,e.max=this.max,this.selectionMode!=DateSelectionMode.Month&&(e.monthView=!0);var i=getComputedStyle(this.hostElement);this._dropDown.style.minWidth=18*parseFloat(i.fontSize)+"px",this._calendar.refresh(),t.prototype._updateDropDown.call(this)},e.prototype._keydown=function(e){if(!(e.defaultPrevented||e.altKey||e.ctrlKey||e.metaKey))switch(e.keyCode){case wijmo_1.Key.Enter:this._commitText(),this.selectAll();break;case wijmo_1.Key.Escape:this.text=wijmo_1.Globalize.format(this.value,this.format),this.selectAll();break;case wijmo_1.Key.Up:case wijmo_1.Key.Down:if(!this.isDroppedDown&&this.value&&this._canChangeValue()){var i=e.keyCode==wijmo_1.Key.Up?1:-1,o=this.selectionMode==DateSelectionMode.Month?wijmo_1.DateTime.addMonths(this.value,i):wijmo_1.DateTime.addDays(this.value,i);this.value=wijmo_1.DateTime.fromDateTime(o,this.value),this.selectAll(),e.preventDefault()}}t.prototype._keydown.call(this,e)},e.prototype._canChangeValue=function(){return!this.isReadOnly&&this.selectionMode!=DateSelectionMode.None},e.prototype._clamp=function(t){return this.calendar._clamp(t)},e.prototype._commitText=function(){var t=this._tbx.value;if(t||this.isRequired){var e=wijmo_1.Globalize.parseDate(t,this.format,this.value);e?this.value=wijmo_1.DateTime.fromDateTime(e,this.value):this._tbx.value=wijmo_1.Globalize.format(this.value,this.format)}else this.value=null},e.prototype._isValidDate=function(t){if(t){if(this._clamp(t)!=t)return!1;if(this.itemValidator&&!this.itemValidator(t))return!1}return!0},e}(DropDown);exports.InputDate=InputDate;var InputColor=function(t){function e(e,i){var o=t.call(this,e)||this;o.valueChanged=new wijmo_1.Event,wijmo_1.addClass(o.hostElement,"wj-inputcolor");return o._ePreview=wijmo_1.createElement('<div class="wj-inputcolorbox"></div>',o.hostElement.firstElementChild),"INPUT"==o._orgTag&&(o._tbx.type="",o._commitText()),o.value="#ffffff",o.isRequired=!0,o.initialize(i),o.addEventListener(o._colorPicker.hostElement,"click",function(t){var e=t.target;e&&"DIV"==e.tagName&&((wijmo_1.closest(e,'[wj-part="div-pal"]')||wijmo_1.closest(e,'[wj-part="div-pv"]'))&&e.style.backgroundColor&&(o.isDroppedDown=!1))}),o}return __extends(e,t),Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(t){t!=this.value&&(!t&&this.isRequired||(this.text=wijmo_1.asString(t)))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"text",{get:function(){return this._tbx.value},set:function(t){t!=this.text&&(this._setText(wijmo_1.asString(t),!0),this._commitText())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"showAlphaChannel",{get:function(){return this._colorPicker.showAlphaChannel},set:function(t){this._colorPicker.showAlphaChannel=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"palette",{get:function(){return this._colorPicker.palette},set:function(t){this._colorPicker.palette=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"colorPicker",{get:function(){return this._colorPicker},enumerable:!0,configurable:!0}),e.prototype.onValueChanged=function(t){this.valueChanged.raise(this,t)},e.prototype.onIsDroppedDownChanged=function(e){t.prototype.onIsDroppedDownChanged.call(this,e),this.isDroppedDown&&!this.isTouching&&this.selectAll()},e.prototype._createDropDown=function(){var t=this;this._colorPicker=new ColorPicker(this._dropDown),wijmo_1.setCss(this._dropDown,{minWidth:420,minHeight:200}),this._colorPicker.valueChanged.addHandler(function(){t.value=t._colorPicker.value})},e.prototype._keydown=function(e){if(!e.defaultPrevented)switch(e.keyCode){case wijmo_1.Key.Enter:this._commitText(),this.selectAll();break;case wijmo_1.Key.Escape:this.text=this.value,this.selectAll()}t.prototype._keydown.call(this,e)},e.prototype._commitText=function(){if(this.value!=this.text){if(!this.isRequired&&!this.text)return this._value=this.text,void(this._ePreview.style.backgroundColor="");wijmo_1.Color.fromString(this.text)?(this._colorPicker.value=this.text,this._value=this._colorPicker.value,this._ePreview.style.backgroundColor=this.value,this.onValueChanged()):this.text=this._value?this._value:""}},e}(DropDown);exports.InputColor=InputColor;var ComboBox=function(t){function e(e,i){var o=t.call(this,e)||this;o._editable=!1,o._trimText=!0,o._delKey=0,o._composing=!1,o._pathHdr=new wijmo_1.Binding(null),o._bsCollapse=!0,o._fmtItemHandlers=0,o.itemsSourceChanged=new wijmo_1.Event,o.selectedIndexChanged=new wijmo_1.Event;var n=o.hostElement;return wijmo_1.addClass(n,"wj-combobox"),o.dropDown.id=wijmo_1.getUniqueId(n.id+"_dropdown"),o.autoExpandSelection=!1,o.addEventListener(o._tbx,"compositionstart",function(){o._composing=!0}),o.addEventListener(o._tbx,"compositionend",function(){o._composing=!1,setTimeout(function(){o._setText(o.text,!0)})}),o.addEventListener(n,"wheel",o._wheel.bind(o)),"SELECT"==o._orgTag&&o._lbx._initFromSelect(n),o._lbx.loadedItems.addHandler(function(t){o.selectedIndex>-1&&(o.selectedIndex=o._lbx.selectedIndex)}),o.isRequired=!0,o.initialize(i),o}return __extends(e,t),Object.defineProperty(e.prototype,"itemsSource",{get:function(){return this._lbx.itemsSource},set:function(t){this._lbx.itemsSource!=t&&(this._lbx.itemsSource=t,this.onItemsSourceChanged()),this._updateBtn()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"collectionView",{get:function(){return this._lbx.collectionView},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"showGroups",{get:function(){return this._lbx.showGroups},set:function(t){this._lbx.showGroups=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"displayMemberPath",{get:function(){return this._lbx.displayMemberPath},set:function(t){this._lbx.displayMemberPath=t;var e=this.getDisplayText();this.text!=e&&this._setText(e,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"headerPath",{get:function(){return this._pathHdr.path},set:function(t){this._pathHdr.path=wijmo_1.asString(t);var e=this.getDisplayText();this.text!=e&&this._setText(e,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectedValuePath",{get:function(){return this._lbx.selectedValuePath},set:function(t){this._lbx.selectedValuePath=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isContentHtml",{get:function(){return this._lbx.isContentHtml},set:function(t){if(t!=this.isContentHtml){this._lbx.isContentHtml=wijmo_1.asBoolean(t);var e=this.getDisplayText();this.text!=e&&this._setText(e,!0)}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"trimText",{get:function(){return this._trimText},set:function(t){t!=this._trimText&&(this._trimText=wijmo_1.asBoolean(t),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"itemFormatter",{get:function(){return this._lbx.itemFormatter},set:function(t){this._lbx.itemFormatter=wijmo_1.asFunction(t),this.selectedIndex=this._lbx.selectedIndex},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"formatItem",{get:function(){return this.listBox.formatItem},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectedIndex",{get:function(){return this._lbx.selectedIndex},set:function(t){t!=this.selectedIndex&&(this._lbx.selectedIndex=t),t=this.selectedIndex;var e=this.getDisplayText(t);this.text!=e&&this._setText(e,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectedItem",{get:function(){return this._lbx.selectedItem},set:function(t){this._lbx.selectedItem=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectedValue",{get:function(){return this.collectionView?this._lbx.selectedValue:this.text},set:function(t){this.collectionView?this._lbx.selectedValue=t:null!=t&&(this.text=t.toString())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isEditable",{get:function(){return this._editable},set:function(t){this._editable=wijmo_1.asBoolean(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxDropDownHeight",{get:function(){return this._lbx.maxHeight},set:function(t){this._lbx.maxHeight=wijmo_1.asNumber(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxDropDownWidth",{get:function(){var t=this._dropDown;return parseInt(t.style.maxWidth)},set:function(t){var e=this._dropDown;e.style.maxWidth=wijmo_1.asNumber(t)+"px",e.style.minWidth=""},enumerable:!0,configurable:!0}),e.prototype.getDisplayText=function(t){var e;if(void 0===t&&(t=this.selectedIndex),this.headerPath&&t>-1&&wijmo_1.hasItems(this.collectionView)){var i=this.collectionView.items[t];e=null!=(e=i?this._pathHdr.getValue(i):null)?e.toString():"",this.isContentHtml&&(e=wijmo_1.toPlainText(e))}else e=this._lbx.getDisplayText(t);return this._trimText?e.trim():e},e.prototype.indexOf=function(t,e){var i=this.collectionView;if(wijmo_1.hasItems(i)&&null!=t){var o=this.selectedIndex;if(e&&t==this.getDisplayText(o))return o;t=t.toString().toLowerCase();for(var n=0;n<i.items.length;n++)if(this.listBox.isItemEnabled(n)){var s=this.getDisplayText(n).toLowerCase();if(e){if(s==t)return n}else if(t&&0==s.indexOf(t))return n}}return-1},Object.defineProperty(e.prototype,"listBox",{get:function(){return this._lbx},enumerable:!0,configurable:!0}),e.prototype.onItemsSourceChanged=function(t){this.itemsSourceChanged.raise(this,t)},e.prototype.onSelectedIndexChanged=function(t){this._updateBtn(),this.selectedIndexChanged.raise(this,t)},e.prototype.refresh=function(e){void 0===e&&(e=!0),t.prototype.refresh.call(this,e),wijmo_1.hasItems(this.collectionView)&&(this._lbx.refresh(),this.selectedIndex>-1&&(this.selectedIndex=this._lbx.selectedIndex))},e.prototype.onLostFocus=function(e){this._composing&&(this._composing=!1,this._setText(this.text,!0)),this.isEditable&&this.isRequired&&!this.text&&wijmo_1.hasItems(this.collectionView)&&(this.selectedIndex=0),t.prototype.onLostFocus.call(this,e)},e.prototype.onIsDroppedDownChanging=function(e){return this.isDroppedDown||wijmo_1.hasItems(this.collectionView)?t.prototype.onIsDroppedDownChanging.call(this,e):(e.cancel=!0,!1)},e.prototype.onIsDroppedDownChanged=function(e){t.prototype.onIsDroppedDownChanged.call(this,e),this.isDroppedDown&&(this._fmtItemHandlers=this.formatItem.handlerCount,this._lbx.showSelection()),wijmo_1.setAttribute(this.dropDown,"aria-expanded",this.isDroppedDown)},e.prototype._updateBtn=function(){var e=this.collectionView,i=this._tbx,o=this.dropDown.id,n=wijmo_1.hasItems(e);t.prototype._updateBtn.call(this),this._btn.style.display=this._showBtn&&null!=e?"":"none",wijmo_1.enable(this._btn,n),wijmo_1.setAttribute(i,"role",n?"combobox":null),wijmo_1.setAttribute(i,"aria-autocomplete",n?"both":null),wijmo_1.setAttribute(i,"aria-owns",n&&this.dropDown.parentElement?o:null),wijmo_1.setAttribute(this.dropDown,"aria-expanded",!n&&null)},e.prototype._createDropDown=function(){var t=this;this._lbx||(this._lbx=new ListBox(this._dropDown)),this._lbx.maxHeight=200,this._lbx.selectedIndexChanged.addHandler(function(){t._updateBtn();var e=t._lbx.selectedIndex,i=t._lbx.hostElement.children,o=e>-1&&e<i.length?i[e].id:null;wijmo_1.setAttribute(t._tbx,"aria-activedescendant",o&&o.length?o:null),t.selectedIndex=e,t.onSelectedIndexChanged()}),this._lbx.itemsChanged.addHandler(function(){t._updateBtn()})},e.prototype._wheel=function(t){if(!t.defaultPrevented&&!this.isDroppedDown&&!this.isReadOnly&&this.containsFocus()&&this.selectedIndex>-1){var e=wijmo_1.clamp(-t.deltaY,-1,1);this.selectedIndex=wijmo_1.clamp(this.selectedIndex-e,0,this.collectionView.items.length-1),t.preventDefault()}},e.prototype._dropDownClick=function(e){e.defaultPrevented||e.target!=this._dropDown&&(this.isDroppedDown=!1),t.prototype._dropDownClick.call(this,e)},e.prototype._setText=function(e,i){if(!this._composing&&!this._settingText){if(this._settingText=!0,this.containsFocus()){var o=this.formatItem.handlerCount;this._fmtItemHandlers!=o&&(this._fmtItemHandlers=o,this._lbx.loadList())}null==e&&(e=""),e=e.toString();var n=this.selectedIndex,s=this.collectionView,r=this._getSelStart(),a=-1,l=!0;if(this.isEditable&&(this._delKey||this._getSelEnd()<e.length||!this.containsFocus())&&(i=!0,l=!1),n=this.indexOf(e,i),l&&(n<0&&i&&(n=this.indexOf(e,!1)),n<0&&r>0&&(n=this.indexOf(e.substr(0,r),!1))),n<0&&!this.isEditable&&wijmo_1.hasItems(s)&&(this.isRequired||e)){var h=this._oldText||"";n=Math.max(0,this.indexOf(h,!1));for(var c=0;c<e.length&&c<h.length;c++)if(e[c]!=h[c]){r=c;break}}n>-1&&(a=r,e=this.getDisplayText(n)),e!=this._tbx.value&&(this._tbx.value=e),a>-1&&this.containsFocus()&&!this.isTouching&&this._updateInputSelection(a),s&&s.moveCurrentToPosition(n),this._delKey=0,this._settingText=!1;var u=this._oldText,p=this.selectedIndex;t.prototype._setText.call(this,e,i),this.text!=u&&this.selectedIndex==p&&p<0&&this.onSelectedIndexChanged()}},e.prototype._findNext=function(t,e){var i=this.selectedIndex,o=this.collectionView,n=o?o.items.length:0,s=this.listBox;if(o&&n&&e){t=t.toLowerCase();for(var r=i+e;r>-1&&r<n;r+=e){if(0==this.getDisplayText(r).toLowerCase().indexOf(t))if(!this.dropDown.children[r]||s.isItemEnabled(r))return r}}return i},e.prototype._keydown=function(e){if(t.prototype._keydown.call(this,e),!e.defaultPrevented&&!this.isReadOnly&&!e.altKey&&wijmo_1.hasItems(this.collectionView)&&this._elRef==this._tbx){this._delKey=0;var i=this._getSelStart();switch(e.keyCode){case wijmo_1.Key.Back:if(this._bsCollapse&&!this.isEditable){var o=this._getSelEnd();i>0&&o==this._tbx.value.length&&wijmo_1.hasItems(this.collectionView)&&this._setSelRange(i-1,o)}this._delKey=e.keyCode;break;case wijmo_1.Key.Delete:this._delKey=e.keyCode;break;case wijmo_1.Key.Up:case wijmo_1.Key.Down:i==this.text.length&&(i=0),this.selectedIndex=this._findNext(this.text.substr(0,i),e.keyCode==wijmo_1.Key.Up?-1:1),this._setSelRange(i,this.text.length),e.preventDefault();break;case wijmo_1.Key.PageUp:this._lbx._selectPrevPage(),this.selectAll(),e.preventDefault();break;case wijmo_1.Key.PageDown:this._lbx._selectNextPage(),this.selectAll(),e.preventDefault()}}},e.prototype._updateInputSelection=function(t){this._elRef==this._tbx&&this._setSelRange(t,this._tbx.value.length)},e.prototype._getSelStart=function(){return this._tbx&&this._tbx.value?this._tbx.selectionStart:0},e.prototype._getSelEnd=function(){return this._tbx&&this._tbx.value?this._tbx.selectionEnd:0},e.prototype._setSelRange=function(t,e){var i=this._tbx;this._elRef!=i||i.readOnly||wijmo_1.setSelectionRange(i,t,e)},e}(DropDown);exports.ComboBox=ComboBox,wijmo_1._addCultureInfo("MultiSelect",{itemsSelected:"{count:n0} items selected",selectAll:"Select All"});var MultiSelect=function(t){function e(e,i){var o=t.call(this,e)||this;return o._maxHdrItems=2,o._readOnly=!1,o._hdrFmt=wijmo_1.culture.MultiSelect.itemsSelected,o.checkedItemsChanged=new wijmo_1.Event,wijmo_1.addClass(o.hostElement,"wj-multiselect"),o._tbx.readOnly=!0,o.checkedMemberPath=null,o.addEventListener(o.inputElement,"click",function(t){document.elementFromPoint(t.clientX,t.clientY)==o.inputElement&&(o._btnclick(t),t.preventDefault())}),o.addEventListener(o._selectAll,"click",function(t){wijmo_1.hasItems(o.collectionView)&&t.target==o._selectAllCheckbox&&(o.checkedItems=t.target.checked?o.collectionView.items:[])}),o.removeEventListener(o.dropDown,"click"),o._updateHeader(),o.listBox.itemsChanged.addHandler(function(){o._updateHeader()}),o.listBox.checkedItemsChanged.addHandler(function(){o._updateHeader(),o.onCheckedItemsChanged()}),o.initialize(i),o}return __extends(e,t),Object.defineProperty(e.prototype,"showSelectAllCheckbox",{get:function(){return""==this._selectAll.style.display},set:function(t){this._selectAll.style.display=wijmo_1.asBoolean(t)?"":"none"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectAllLabel",{get:function(){return this._selectAllLabel},set:function(t){t!=this._selectAllLabel&&(this._selectAllLabel=wijmo_1.asString(t),this.refresh())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"checkedMemberPath",{get:function(){var t=this.listBox.checkedMemberPath;return t!=e._DEF_CHECKED_PATH?t:null},set:function(t){t=wijmo_1.asString(t),this.listBox.checkedMemberPath=t||e._DEF_CHECKED_PATH},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxHeaderItems",{get:function(){return this._maxHdrItems},set:function(t){this._maxHdrItems!=t&&(this._maxHdrItems=wijmo_1.asNumber(t),this._updateHeader())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"headerFormat",{get:function(){return this._hdrFmt},set:function(t){t!=this._hdrFmt&&(this._hdrFmt=wijmo_1.asString(t),this._updateHeader())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"headerFormatter",{get:function(){return this._hdrFormatter},set:function(t){t!=this._hdrFormatter&&(this._hdrFormatter=wijmo_1.asFunction(t),this._updateHeader())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"checkedItems",{get:function(){return this.listBox.checkedItems},set:function(t){this.listBox.checkedItems=wijmo_1.asArray(t)},enumerable:!0,configurable:!0}),e.prototype.onCheckedItemsChanged=function(t){this.checkedItemsChanged.raise(this,t)},e.prototype.onIsDroppedDownChanged=function(e){t.prototype.onIsDroppedDownChanged.call(this,e),this.isDroppedDown&&this.listBox.focus()},e.prototype._createDropDown=function(){this._selectAll=wijmo_1.createElement('<div class="wj-header wj-select-all wj-listbox-item" style="display:none" tabindex="0"><label><input type="checkbox"> <span></span></label></div>',this._dropDown),this._selectAllCheckbox=this._selectAll.querySelector("input[type=checkbox]"),this._selectAllSpan=this._selectAll.querySelector("label>span"),wijmo_1.setText(this._selectAllSpan,wijmo_1.culture.MultiSelect.selectAll);var e=wijmo_1.createElement("<div></div>",this._dropDown);this._lbx=new ListBox(e),t.prototype._createDropDown.call(this),wijmo_1.addClass(this.dropDown,"wj-control wj-listbox"),this.dropDown.style.overflow="hidden"},Object.defineProperty(e.prototype,"isReadOnly",{get:function(){return this._readOnly},set:function(t){this._readOnly=wijmo_1.asBoolean(t),wijmo_1.toggleClass(this.hostElement,"wj-state-readonly",this.isReadOnly)},enumerable:!0,configurable:!0}),e.prototype.refresh=function(e){void 0===e&&(e=!0),t.prototype.refresh.call(this,e),this._updateHeader(),this._selectAllSpan&&wijmo_1.setText(this._selectAllSpan,this._selectAllLabel||wijmo_1.culture.MultiSelect.selectAll)},e.prototype._setText=function(t,e){},e.prototype._keydown=function(e){t.prototype._keydown.call(this,e),!e.defaultPrevented&&wijmo_1.hasItems(this.collectionView)&&e.keyCode>32&&(this.isDroppedDown=!0)},e.prototype._updateHeader=function(){var t=this.checkedItems;if(wijmo_1.isFunction(this._hdrFormatter))this.inputElement.value=this._hdrFormatter();else{var e="";if(t.length>0)if(t.length<=this._maxHdrItems){if(this.displayMemberPath){var i=new wijmo_1.Binding(this.displayMemberPath);t=t.map(function(t){return i.getValue(t)})}e=t.join(", ")}else e=wijmo_1.format(this.headerFormat,{count:t.length});this.inputElement.value=e}var o=null,n=this.collectionView;wijmo_1.hasItems(n)&&(0==t.length?o=!1:t.length==n.items.length&&(o=!0)),this._selectAllCheckbox.indeterminate=null==o,null!=o&&(this._selectAllCheckbox.checked=o),this._updateState()},e._DEF_CHECKED_PATH="$checked",e}(ComboBox);exports.MultiSelect=MultiSelect;var Menu=function(t){function e(e,i){var o=t.call(this,e)||this;o._isButton=!1,o._openOnHover=!1,o._closeOnLeave=!0,o._hoverEnterBnd=o._hoverEnter.bind(o),o._hoverLeaveBnd=o._hoverLeave.bind(o),o._hoverOverBnd=o._hoverOver.bind(o),o.itemClicked=new wijmo_1.Event;var n=o.hostElement,s=o._tbx,r=o._lbx,a=o.dropDown;wijmo_1.addClass(n,"wj-menu"),s.style.display="none";o._hdr=o._elRef=wijmo_1.createElement('<div wj-part="header" class="wj-form-control"/>'),s.parentElement.insertBefore(o._hdr,o._tbx);var l=o._orgOuter.match(/tabindex="?(-?\d+)"?/i);return n.tabIndex=l?parseInt(l[1]):0,o.isRequired=!1,wijmo_1.setAttribute(n,"role","menubar",!0),wijmo_1.setAttribute(s,"role",null),wijmo_1.setAttribute(s,"aria-autocomplete",null),wijmo_1.setAttribute(s,"aria-owns",null),wijmo_1.setAttribute(a,"role","menu"),r.itemRole="menuitem","SELECT"==o._orgTag&&(o.header=n.getAttribute("header"),o._lbx.itemsSource&&(o.commandParameterPath="cmdParam")),o.isContentHtml=!0,o.maxDropDownHeight=500,o.addEventListener(o._hdr,"click",function(t){t.defaultPrevented||(o._clearHover(),o._isButton?(o.isDroppedDown=!1,o._raiseCommand()):o.isDroppedDown=!o.isDroppedDown)}),r.lostFocus.addHandler(function(){o.containsFocus()||(o.isDroppedDown=!1)}),wijmo_1.addClass(a,"wj-menu-items"),r.formatItem.addHandler(o._formatMenuItem.bind(o)),o.initialize(i),o}return __extends(e,t),Object.defineProperty(e.prototype,"header",{get:function(){return this._hdr.innerHTML},set:function(t){this._hdr.innerHTML=wijmo_1.asString(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"command",{get:function(){return this._cmd},set:function(t){this._cmd=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"commandPath",{get:function(){return this._cmdPath},set:function(t){this._cmdPath=wijmo_1.asString(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"commandParameterPath",{get:function(){return this._cmdParamPath},set:function(t){this._cmdParamPath=wijmo_1.asString(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"subItemsPath",{get:function(){return this._subPath},set:function(t){t!=this._subPath&&(this._subPath=t,this.refresh(!0))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"openOnHover",{get:function(){return this._openOnHover},set:function(t){this._openOnHover=wijmo_1.asBoolean(t),this._updateHoverEvents()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"closeOnLeave",{get:function(){return this._closeOnLeave},set:function(t){this._closeOnLeave=wijmo_1.asBoolean(t),this._updateHoverEvents()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isButton",{get:function(){return this._isButton},set:function(t){this._isButton=wijmo_1.asBoolean(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"owner",{get:function(){return this._owner},set:function(t){this._owner=wijmo_1.asType(t,HTMLElement,!0),this._enableDisableItems()},enumerable:!0,configurable:!0}),e.prototype.show=function(t){if(!this.isDroppedDown&&(this.selectedIndex=-1,this.onIsDroppedDownChanging(new wijmo_1.CancelEventArgs))){var e=this.owner||t.target,i=this.dropDown;e instanceof HTMLElement&&(i[wijmo_1.Control._OWNR_KEY]=e),wijmo_1.showPopup(i,t,!1,this.isAnimated),this.onIsDroppedDownChanged(),i.focus()}},e.prototype.hide=function(){this.isDroppedDown&&this.onIsDroppedDownChanging(new wijmo_1.CancelEventArgs)&&(wijmo_1.hidePopup(this.dropDown),this.onIsDroppedDownChanged())},e.prototype.onItemClicked=function(t){this.itemClicked.raise(this,t)},e.prototype.refresh=function(e){void 0===e&&(e=!0),t.prototype.refresh.call(this,e),this._enableDisableItems()},e.prototype.onIsDroppedDownChanged=function(e){t.prototype.onIsDroppedDownChanged.call(this,e),this.isDroppedDown?(this._closing=!0,this._defaultItem=this.selectedItem,this.isRequired=!1,this.selectedIndex=-1,this._enableDisableItems(),this._closing=!1,this.dropDown.focus()):this.selectedItem||(this.selectedItem=this._defaultItem)},e.prototype._updateHoverEvents=function(){var t=this.hostElement,e=this.dropDown,i=this.addEventListener.bind(this),o=this.removeEventListener.bind(this),n="mouseleave";o(t,"mouseenter",this._hoverEnterBnd),o(t,n,this._hoverLeaveBnd),o(e,"mouseover",this._hoverOverBnd),o(e,n,this._hoverLeaveBnd),this._openOnHover&&(i(t,"mouseenter",this._hoverEnterBnd),i(e,"mouseover",this._hoverOverBnd),this._closeOnLeave&&(i(t,n,this._hoverLeaveBnd),i(e,n,this._hoverLeaveBnd)))},e.prototype._getSubItems=function(t){var e=this.subItemsPath,i=t&&e?t[e]:null;return wijmo_1.isArray(i)&&i.length?i:null},e.prototype._formatMenuItem=function(t,e){var i=e.item;this._getSubItems(e.data)?wijmo_1.addClass(i,"wj-subitems"):"-"==i.innerHTML&&(i.innerHTML="",wijmo_1.addClass(i,"wj-separator"))},e.prototype._keydown=function(i){if(!i.defaultPrevented){var o=this._getKeyCode(i);if(this.isDroppedDown)switch(o){case wijmo_1.Key.Enter:case wijmo_1.Key.Right:if(this._showSubMenu())return void i.preventDefault();break;case wijmo_1.Key.Left:var n=wijmo_1.Control.getControl(this.owner);if(n instanceof e){var s=n.dropDown,r=n.selectedIndex;return(r>-1?s.children[r]:s).focus(),void i.preventDefault()}}o==wijmo_1.Key.Enter&&(this.isDroppedDown?this.getDisplayText(this.selectedIndex)&&this._raiseCommand():(this.isDroppedDown=!0,i.preventDefault()))}t.prototype._keydown.call(this,i)},e.prototype._dropDownClick=function(e){if(!e.defaultPrevented&&e.target!=this.dropDown){if(this._clearHover(),this._showSubMenu())return void e.preventDefault();this.getDisplayText(this.selectedIndex)&&this._raiseCommand()}t.prototype._dropDownClick.call(this,e)},e.prototype._showSubMenu=function(){var t=this,i=this._getSubItems(this.selectedItem);if(!i)return null;var o=this.dropDown.children[this.selectedIndex].getBoundingClientRect(),n=new wijmo_1.Point(o.right,o.top);if(0==o.height)return null;var s=this.rightToLeft||"rtl"==this.dropDown.getAttribute("dir");s&&(n.x=o.left);var r=new e(document.createElement("div"),{owner:this.hostElement,itemsSource:i,itemClicked:function(e,i){t.itemClicked.raise(e,i)}});"displayMemberPath,selectedValuePath,isContentHtml,command,commandPath,commandParameterPath,maxDropDownWidth,maxDropDownHeight,dropDownCssClass,isAnimated,subItemsPath,openOnHover,closeOnLeave".split(",").forEach(function(e){r[e]=t[e]});var a=r.dropDown;return wijmo_1.setAttribute(a,"dir",s?"rtl":null),r.show(n),a[wijmo_1.Control._OWNR_KEY]=this.dropDown,a.focus(),r},e.prototype._raiseCommand=function(t){var i=this.selectedItem,o=this._getSubItems(i),n=this._getCommand(i);if(n&&!o){var s=this._getCommandParm(i);if(!this._canExecuteCommand(n,s))return;this._executeCommand(n,s)}if(this.onItemClicked(t),this.containsFocus()){for(var r=this;r&&r.owner;){var a=wijmo_1.Control.getControl(r.owner);if(!(a instanceof e))break;r=a}var l=r.owner;!l&&r.dropDown&&(l=r.dropDown[wijmo_1.Control._OWNR_KEY]),r.isDroppedDown=!1,r.focus(),r.containsFocus()||l instanceof HTMLElement&&l.focus()}},e.prototype._getCommand=function(t){var e=t&&this._cmdPath?t[this._cmdPath]:null;return e||this._cmd},e.prototype._getCommandParm=function(t){var e=this._cmdParamPath;return t&&e?t[e]:t},e.prototype._executeCommand=function(t,e){t&&!wijmo_1.isFunction(t)&&(t=t.executeCommand),wijmo_1.isFunction(t)&&t(e)},e.prototype._canExecuteCommand=function(t,e){if(t){var i=t.canExecuteCommand;if(wijmo_1.isFunction(i))return i(e)}return!0},e.prototype._enableDisableItems=function(){if(this.collectionView&&(this._cmd||this._cmdPath))for(var t=this.collectionView.items,e=0;e<t.length;e++){var i=t[e],o=this._getCommand(i);if(o){var n=this._lbx.hostElement.children[e],s=this._getCommandParm(i);wijmo_1.toggleClass(n,"wj-state-disabled",!this._canExecuteCommand(o,s))}}},e.prototype._clearHover=function(){this._toHover&&clearTimeout(this._toHover),this._toHover=null},e.prototype._hoverEnter=function(t){var e=this;this._clearHover(),this._toHover=setTimeout(function(){e._toHover=null,e.isDroppedDown=!0},wijmo_1.Control._HOVER_DELAY)},e.prototype._hoverLeave=function(t){if(this._clearHover(),this.isDroppedDown){var e=document.elementFromPoint(t.clientX,t.clientY),i=wijmo_1.closest(e,".wj-listbox.wj-menu-items"),o=this._subMenu;i||wijmo_1.contains(this.hostElement,e)||(this.isDroppedDown=!1,o&&(o.isDroppedDown=!1))}},e.prototype._hoverOver=function(t){var e=this;this._clearHover(),this._toHover=setTimeout(function(){e._toHover=null;var i=e.listBox.indexOf(t.target);i>-1&&(e.selectedIndex=i,e._subMenu=e._showSubMenu())},wijmo_1.Control._HOVER_DELAY)},e}(ComboBox);exports.Menu=Menu;var InputTime=function(t){function e(e,i){var o=t.call(this,e)||this;if(o._format="t",o.valueChanged=new wijmo_1.Event,wijmo_1.addClass(o.hostElement,"wj-inputtime"),o.isEditable=!0,o._value=wijmo_1.DateTime.newDate(),o._msk=new wijmo_1._MaskProvider(o._tbx),wijmo_1.isIE9()||(o._tbx.type="tel"),"INPUT"==o._orgTag){var n=o._tbx.getAttribute("value");n&&(o.value=wijmo_1.Globalize.parseDate(n,"HH:mm:ss"))}return o.step=15,o.autoExpandSelection=!0,o.initialize(i),o}return __extends(e,t),Object.defineProperty(e.prototype,"inputElement",{get:function(){return this._tbx},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inputType",{get:function(){return this._tbx.type},set:function(t){this._tbx.type=wijmo_1.asString(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(t){(t=wijmo_1.asDate(t,!this.isRequired))&&(t=this._clamp(t)),this._setText(t?wijmo_1.Globalize.format(t,this.format):"",!0),this.selectedItem&&this.selectedItem.value&&(t=wijmo_1.DateTime.fromDateTime(t,this.selectedItem.value)),t==this._value||wijmo_1.DateTime.equals(t,this._value)||(this._value=t,this.onValueChanged())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"text",{get:function(){return this._tbx.value},set:function(t){t!=this.text&&(this._setText(t,!0),this._commitText())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"min",{get:function(){return this._min},set:function(t){this._min=wijmo_1.asDate(t,!0),this.isDroppedDown=!1,this._updateItems()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"max",{get:function(){return this._max},set:function(t){this._max=wijmo_1.asDate(t,!0),this.isDroppedDown=!1,this._updateItems()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"step",{get:function(){return this._step},set:function(t){this._step=wijmo_1.asNumber(t,!0),this.isDroppedDown=!1,this._updateItems()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"format",{get:function(){return this._format},set:function(t){t!=this.format&&(this._format=wijmo_1.asString(t),this._tbx.value=wijmo_1.Globalize.format(this.value,this.format),wijmo_1.hasItems(this.collectionView)&&this._updateItems())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mask",{get:function(){return this._msk.mask},set:function(t){this._msk.mask=wijmo_1.asString(t)},enumerable:!0,configurable:!0}),e.prototype.onValueChanged=function(t){this.valueChanged.raise(this,t)},e.prototype.onItemsSourceChanged=function(e){t.prototype.onItemsSourceChanged.call(this,e),this._hasCustomItems=null!=this.itemsSource},e.prototype.refresh=function(e){void 0===e&&(e=!0),t.prototype.refresh.call(this,e),this.isDroppedDown=!1,this._msk.refresh(),this._tbx.value=wijmo_1.Globalize.format(this.value,this.format),this._updateItems()},e.prototype.onSelectedIndexChanged=function(e){if(this.selectedIndex>-1&&!this._settingText){var i=this.value?this.value:wijmo_1.DateTime.newDate(),o=null!=this.selectedItem.value?this.selectedItem.value:wijmo_1.Globalize.parseDate(this.text,this.format,this.value);this.value=wijmo_1.DateTime.fromDateTime(i,o)}t.prototype.onSelectedIndexChanged.call(this,e)},e.prototype._clamp=function(t){return null!=this._min&&this._getTime(t)<this._getTime(this._min)&&(t=wijmo_1.DateTime.fromDateTime(t,this._min)),null!=this._max&&this._getTime(t)>this._getTime(this._max)&&(t=wijmo_1.DateTime.fromDateTime(t,this._max)),t},e.prototype._wheel=function(e){if(!e.defaultPrevented&&!this.isDroppedDown&&!this.isReadOnly&&this.containsFocus()&&this.selectedIndex<0&&this.value&&wijmo_1.isNumber(this.step)&&this.step>0){var i=wijmo_1.DateTime.addMinutes(this.value,this.step*wijmo_1.clamp(e.deltaY,-1,1));this.value=this._clamp(i),this.selectAll(),e.preventDefault()}t.prototype._wheel.call(this,e)},e.prototype._updateInputSelection=function(e){if(this._delKey)t.prototype._updateInputSelection.call(this,e);else{for(var i=this._tbx.value;e<i.length&&!i[e].match(/[a-z0-9]/i);)e++;wijmo_1.setSelectionRange(this._tbx,e,this._tbx.value.length)}},e.prototype._updateItems=function(){if(!this._hasCustomItems){var t=[],e=wijmo_1.DateTime.newDate(0,0,0,0,0),i=wijmo_1.DateTime.newDate(0,0,0,23,59,59);if(this.min&&e.setHours(this.min.getHours(),this.min.getMinutes(),this.min.getSeconds()),this.max&&i.setHours(this.max.getHours(),this.max.getMinutes(),this.max.getSeconds()),wijmo_1.isNumber(this.step)&&this.step>0)for(var o=e;o<=i;o=wijmo_1.DateTime.addMinutes(o,this.step))t.push({value:o,text:wijmo_1.Globalize.format(o,this.format)});var n=this.value;this._settingText=!0,this.displayMemberPath="text",this.selectedValuePath="text",this.itemsSource=t,this._hasCustomItems=!1,this._settingText=!1,this.value=n}},e.prototype._getTime=function(t){return 3600*t.getHours()+60*t.getMinutes()+t.getSeconds()},e.prototype._keydown=function(e){if(t.prototype._keydown.call(this,e),!e.defaultPrevented)switch(e.keyCode){case wijmo_1.Key.Enter:this.isDroppedDown||(this._commitText(),this.selectAll());break;case wijmo_1.Key.Escape:this.text=wijmo_1.Globalize.format(this.value,this.format),this.selectAll()}},e.prototype._commitText=function(){if(this.text||this.isRequired){var t=this.value?wijmo_1.Globalize.format(this.value,this.format):null;if(this.text!=t){var e=this.selectedItem&&this.selectedItem.value?this.selectedItem.value:wijmo_1.Globalize.parseDate(this.text,this.format,this.value);e?this.value=wijmo_1.DateTime.fromDateTime(this.value,e):this.text=t}}else this.value=null},e}(ComboBox);exports.InputTime=InputTime,wijmo_1._addCultureInfo("InputDateTime",{ariaLabels:{tglDate:"Toggle Calendar",tglTime:"Toggle Time List"}});var InputDateTime=function(t){function e(e,i){var o=t.call(this,e)||this;wijmo_1.addClass(o.hostElement,"wj-inputdatetime"),o._btnTm=o.hostElement.querySelector('[wj-part="btn-tm"]');var n=wijmo_1.culture.InputDateTime.ariaLabels;wijmo_1.setAriaLabel(o._btn,n.tglDate),wijmo_1.setAriaLabel(o._btnTm,n.tglTime),o.format="g",o._inputTime=new InputTime(document.createElement("div"),{valueChanged:function(t,e){o.value=wijmo_1.DateTime.fromDateTime(o.value,t.value)}});var s=o._inputTime.dropDown,r=o.calendar.hostElement,a=o.addEventListener.bind(o),l=o._keydown.bind(o);return a(s,"keydown",l,!0),a(s,"blur",function(){o._updateFocusState()},!0),a(s,"click",function(t){t.defaultPrevented||t.target!=s&&o.hostElement.focus()},!0),a(o._btn,"mousedown",function(t){o._setDropdown(r)&&o._btnclick(t)}),a(o._btnTm,"mousedown",function(t){o._setDropdown(s),o._btnclick(t),t.preventDefault()}),o.initialize(i),o}return __extends(e,t),Object.defineProperty(e.prototype,"timeMin",{get:function(){return this._inputTime.min},set:function(t){this._inputTime.min=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"timeMax",{get:function(){return this._inputTime.max},set:function(t){this._inputTime.max=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"timeFormat",{get:function(){return this._inputTime.format},set:function(t){this._inputTime.format=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"timeStep",{get:function(){return this._inputTime.step},set:function(t){this._inputTime.step=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inputTime",{get:function(){return this._inputTime},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this._setDropdown(this.calendar.hostElement),t.prototype.dispose.call(this),this._inputTime.dispose()},e.prototype.refresh=function(e){void 0===e&&(e=!0),this._setDropdown(this.calendar.hostElement),this._inputTime.refresh(),t.prototype.refresh.call(this,e)},e.prototype._updateBtn=function(){t.prototype._updateBtn.call(this),this._btnTm&&(this._btnTm.tabIndex=this._btn.tabIndex,this._btnTm.parentElement.style.display=this._btn.style.display)},e.prototype._clamp=function(t){return t&&(this.min&&t<this.min&&(t=this.min),this.max&&t>this.max&&(t=this.max)),t},e.prototype._commitText=function(){var t=this._tbx.value;if(t||this.isRequired){var e=wijmo_1.Globalize.parseDate(t,this.format,this.value);e?this.value=e:this._tbx.value=wijmo_1.Globalize.format(this.value,this.format)}else this.value=null},e.prototype._setDropdown=function(t){if(this._dropDown==t)return!1;this.isDroppedDown&&(this.isDroppedDown=!1);var e=this.dropDownCssClass;return this.dropDownCssClass="",this._dropDown=t,this.dropDownCssClass=e,!0},e.prototype._updateDropDown=function(){var e=this._inputTime;this._dropDown==e.dropDown?(this._commitText(),t.prototype._updateDropDown.call(this),e.isRequired=this.isRequired&&null!=this.value,e.value=this.value,this.isDroppedDown&&e.listBox.showSelection()):t.prototype._updateDropDown.call(this)},e.controlTemplate='<div class="wj-template"><div class="wj-input"><div class="wj-input-group wj-input-btn-visible"><input wj-part="input" type="text" class="wj-form-control"/><span class="wj-input-group-btn"><button wj-part="btn" class="wj-btn wj-btn-default" tabindex="-1"><span class="wj-glyph-calendar"></span></button><button wj-part="btn-tm" class="wj-btn wj-btn-default" tabindex="-1"><span class="wj-glyph-clock"></span></button></span></div></div><div wj-part="dropdown" class="wj-content wj-dropdown-panel" style="display:none"></div></div>',e}(InputDate);exports.InputDateTime=InputDateTime;var AutoComplete=function(t){function e(e,i){var o=t.call(this,e)||this;return o._cssMatch="wj-autocomplete-match",o._minLength=2,o._maxItems=6,o._itemCount=0,o._delay=500,o._query="",o._inCallback=!1,o._srchProps=[],wijmo_1.addClass(o.hostElement,"wj-autocomplete"),o._bsCollapse=!1,o.isEditable=!0,o.isRequired=!1,o.listBox.formatItem.addHandler(o._formatListItem,o),o._itemsSourceFnCallBackBnd=o._itemSourceFunctionCallback.bind(o),o.initialize(i),o}return __extends(e,t),Object.defineProperty(e.prototype,"minLength",{get:function(){return this._minLength},set:function(t){this._minLength=wijmo_1.asNumber(t,!1,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxItems",{get:function(){return this._maxItems},set:function(t){this._maxItems=wijmo_1.asNumber(t,!1,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"delay",{get:function(){return this._delay},set:function(t){this._delay=wijmo_1.asNumber(t,!1,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"searchMemberPath",{get:function(){return this._srchProp},set:function(t){this._srchProp=wijmo_1.asString(t),this._srchProps=t?t.trim().split(/\s*,\s*/):[]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"itemsSourceFunction",{get:function(){return this._itemsSourceFn},set:function(t){this._itemsSourceFn=wijmo_1.asFunction(t),wijmo_1.isFunction(this._itemsSourceFn)&&this.itemsSourceFunction(this.text,this.maxItems,this._itemsSourceFnCallBackBnd)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cssMatch",{get:function(){return this._cssMatch},set:function(t){this._cssMatch=wijmo_1.asString(t)},enumerable:!0,configurable:!0}),e.prototype._keydown=function(e){if(!e.defaultPrevented&&this.isDroppedDown)switch(e.keyCode){case wijmo_1.Key.Up:case wijmo_1.Key.Down:this.selectAll()}t.prototype._keydown.call(this,e)},e.prototype._setText=function(t){var e=this;if(!this._inCallback){if(!t&&this.selectedIndex>-1&&this.getDisplayText()&&(this.selectedIndex=-1),t!=this._oldText&&(this._tbx.value!=t&&(this._tbx.value=t),this._oldText=t,this.onTextChanged(),!t&&this.collectionView))return(this._query||this.selectedIndex<0)&&(this.isDroppedDown=!1),this._query=this._rxHighlight=null,void(this.collectionView.filter=null);this._toSearch&&clearTimeout(this._toSearch),t!=this.getDisplayText()&&(this._toSearch=setTimeout(function(){e._toSearch=null;var t=e.text.trim();if(t.length>=e._minLength&&t!=e._query){e._query=t,t=t.replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1");var i=wijmo_1.escapeHtml(t);e._rxMatch=new RegExp("(?=.*"+t.replace(/ /g,")(?=.*")+")","ig"),e._rxHighlight=e.isContentHtml?new RegExp("("+i.replace(/ /g,"|")+")(?![^<]*>|[^<>]* </)","ig"):new RegExp("("+i.replace(/ /g,"|")+")","ig"),e.itemsSourceFunction?e.itemsSourceFunction(t,e.maxItems,e._itemsSourceFnCallBackBnd):e._updateItems()}},this._delay))}},e.prototype._itemSourceFunctionCallback=function(t){this._inCallback=!0;var e=wijmo_1.asCollectionView(t);if(e&&e.moveCurrentToPosition(-1),this.itemsSource=e,this._inCallback=!1,this.containsFocus()){var i=this._tbx,o=i.selectionStart,n=i.selectionEnd;this.isDroppedDown=!0,wijmo_1.setSelectionRange(i,o,n),this.refresh()}},e.prototype.onIsDroppedDownChanged=function(e){if(t.prototype.onIsDroppedDownChanged.call(this,e),this.containsFocus()&&!this.isTouching&&this.selectedIndex<0){var i=this.collectionView.items,o=this.text;1==i.length&&i[0]==o?this.selectedIndex=0:wijmo_1.setSelectionRange(this._tbx,o.length)}this._query=""},e.prototype._updateItems=function(){var t=this.collectionView;if(t){this._inCallback=!0,t.beginUpdate(),this._itemCount=0,t.filter=this._filter.bind(this),t.moveCurrentToPosition(-1),t.endUpdate(),this._inCallback=!1;var e=t.items.length,i=this._tbx,o=i.selectionStart,n=i.selectionEnd;this.isDroppedDown=e>0&&this.containsFocus(),e||this.isEditable||(this.selectedIndex=-1),this.isDroppedDown&&wijmo_1.setSelectionRange(i,o,n),this.refresh()}},e.prototype._filter=function(t){if(this._itemCount>=this._maxItems)return!1;var e=this._getItemText(t,!1);if(this._srchProps)for(var i=0;i<this._srchProps.length;i++)e+="\0"+t[this._srchProps[i]];return this.isContentHtml&&(e=e.replace(/<[^>]*>/g,"")),!!e.match(this._rxMatch)&&(this._itemCount++,!0)},e.prototype._getItemText=function(t,e){var i=t?t.toString():"",o=e&&this.headerPath?this._pathHdr:this._lbx._pathDisplay;return o&&(i=null!=(i=o.getValue(t))?i.toString():""),i},e.prototype._formatListItem=function(t,e){if(this._cssMatch&&this._rxHighlight){var i='<span class="'+this._cssMatch+'">$1</span>';e.item.innerHTML=e.item.innerHTML.replace(this._rxHighlight,i)}},e}(ComboBox);exports.AutoComplete=AutoComplete;var MultiAutoComplete=function(t){function e(e,i){var o=t.call(this,e)||this;return o._selItems=[],o._lastInputValue="",o._selPath=new wijmo_1.Binding(null),o._notAddItm=!1,o.selectedItemsChanged=new wijmo_1.Event,wijmo_1.addClass(o.hostElement,"wj-multi-autocomplete"),o.showDropDownButton=!1,o.initialize(i),o._wjTpl=o.hostElement.querySelector(".wj-template"),o._wjInput=o.hostElement.querySelector(".wj-input"),o.addEventListener(o.hostElement,"keyup",o._keyup.bind(o),!0),o.addEventListener(window,"resize",o._adjustInputWidth.bind(o)),o.addEventListener(o._tbx,"focus",function(){o._itemOff()}),o._addHelperInput(),o._initSeltems(),o.listBox.itemsChanged.addHandler(function(){return o.selectedIndex=-1}),o._refreshHeader(),o}return __extends(e,t),Object.defineProperty(e.prototype,"showDropDownButton",{set:function(t){this._showBtn=!1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxSelectedItems",{get:function(){return this._maxSelItems},set:function(t){this._maxSelItems!=t&&(this._maxSelItems=wijmo_1.asNumber(t,!0),this._updateMaxItems(),this._refreshHeader(),this._clearSelIndex())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectedMemberPath",{get:function(){return this._selPath.path},set:function(t){(t=wijmo_1.asString(t))!==this.selectedMemberPath&&(this._selPath.path=t,this._initSeltems(),this._refreshHeader(),this.onSelectedItemsChanged())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectedItems",{get:function(){return this._selItems},set:function(t){if(this._selItems=wijmo_1.asArray(t),this.selectedMemberPath&&""!==this.selectedMemberPath&&this._selItems)for(var e=0;e<this._selItems.length;e++){var i=this._selItems[e];this._setSelItem(i,!1)}this._updateMaxItems(),this.onSelectedItemsChanged(),this._refreshHeader(),this._clearSelIndex()},enumerable:!0,configurable:!0}),e.prototype.onSelectedItemsChanged=function(t){this.selectedItemsChanged.raise(this,t)},e.prototype.onIsDroppedDownChanged=function(e){!this.isDroppedDown&&this.selectedIndex>-1&&!this._notAddItm&&this._addItem(!0),this._notAddItm=!1,t.prototype.onIsDroppedDownChanged.call(this,e)},e.prototype.refresh=function(e){void 0===e&&(e=!0),t.prototype.refresh.call(this,e),this._initSeltems(),this.isDroppedDown||this._refreshHeader()},e.prototype._keydown=function(e){if(!this.isReadOnly){if(!e.defaultPrevented)switch(e.keyCode){case wijmo_1.Key.Back:this._lastInputValue=this._tbx.value;break;case wijmo_1.Key.Enter:this._itemOff(),this._addItem(!0),wijmo_1.isIE&&wijmo_1.setSelectionRange(this._tbx,0,0);break;case wijmo_1.Key.Tab:this.isDroppedDown?(this._addItem(!1),this._tbx.value="",this._lbx.selectedIndex=-1,e.preventDefault()):this._updateFocus();break;case wijmo_1.Key.Space:if(""!==this._tbx.value)return;this.isDroppedDown||this._tbx.disabled||(this.isDroppedDown=!0,this._clearSelIndex());break;case wijmo_1.Key.Escape:this.isDroppedDown&&(this._notAddItm=!0);break;case wijmo_1.Key.Left:this._itemOn(!this.rightToLeft);break;case wijmo_1.Key.Right:this._itemOn(!!this.rightToLeft);break;case wijmo_1.Key.Up:case wijmo_1.Key.Down:var i=wijmo_1.getActiveElement();if(e.altKey){if(this._tbx==i)return this.isDroppedDown=!this.isDroppedDown,this.isDroppedDown||this._tbx.focus(),void e.preventDefault()}else if(this._tbx!==i)return;default:if(e.keyCode===wijmo_1.Key.Back||e.keyCode===wijmo_1.Key.Delete)return;this._itemOff(),null!=this._maxSelItems&&this._selItems.length>=this._maxSelItems&&e.preventDefault()}this._tbx.disabled||t.prototype._keydown.call(this,e)}},e.prototype._updateState=function(){t.prototype._updateState.call(this),this._wjTpl&&(wijmo_1.hasClass(this.hostElement,"wj-state-focused")||this._itemOff())},e.prototype._keyup=function(t){if(!this.isReadOnly&&!t.defaultPrevented)switch(t.keyCode){case wijmo_1.Key.Back:0===this._tbx.value.length&&0===this._lastInputValue.length&&this._delItem(!1);break;case wijmo_1.Key.Delete:this._delItem(!0)}},e.prototype._addHelperInput=function(){var t=document.createElement("input");t.type="text",t.tabIndex=-1,t.className="wj-token-helper",t.readOnly=!0,this._wjTpl.insertBefore(t,this._wjInput),this._helperInput=t},e.prototype._refreshHeader=function(){for(var t=this.hostElement.querySelectorAll(".wj-token"),e=0;e<t.length;e++)this._wjTpl.removeChild(t[e]);var i=this.selectedItems;if(!i||0===i.length)return this._wjInput.style.cssFloat=this.rightToLeft?"right":"left",void this._adjustInputWidth();for(e=0;e<i.length;e++)this._insertToken(i[e]);this._wjInput.style.cssFloat=this.rightToLeft?"right":"left",this._adjustInputWidth()},e.prototype._insertToken=function(t){var e=this._getItemText(t,!0);this.isContentHtml||(e=wijmo_1.escapeHtml(e)),this._wjTpl.insertBefore(this._createItem(e),this._wjInput)},e.prototype._updateMaxItems=function(){null!=this._maxSelItems&&this._selItems&&this._selItems.length>this._maxSelItems&&(this._selItems=this._selItems.slice(0,this._maxSelItems))},e.prototype._updateFocus=function(){var t=this,i=this._wjTpl.querySelector("."+e._clsActive);i?(wijmo_1.removeClass(i,e._clsActive),setTimeout(function(){t._tbx.focus()})):(this._clearSelIndex(),wijmo_1.removeClass(this.hostElement,"wj-state-focused"))},e.prototype._addItem=function(t){this.selectedItems.indexOf(this.selectedItem)>-1?this._clearSelIndex():this.selectedIndex>-1&&(this._updateSelItems(this.selectedItem,!0),this._refreshHeader(),t&&this._clearSelIndex(),this._disableInput(!0))},e.prototype._delItem=function(t){var i,o,n=this._wjTpl.querySelector("."+e._clsActive),s=!1;t&&!n||(n?(o=this._getItemIndex(n))>-1&&(i=this._selItems[o],s=!0):this._selItems.length>0&&(i=this._selItems[this._selItems.length-1],s=!0),s&&(this._updateSelItems(i,!1),this._refreshHeader(),this._clearSelIndex(),this._disableInput(!1)),this._tbx.focus())},e.prototype._updateSelItems=function(t,e){if(e){if(this._selItems&&0!==this._selItems.length||(this._selItems=[]),null!=this._maxSelItems&&this._selItems.length>=this._maxSelItems)return;this._selItems.push(t)}else{var i=this._selItems.indexOf(t);this._selItems.splice(i,1)}this._hasSelectedMemeberPath()&&this._setSelItem(t,e),this.onSelectedItemsChanged()},e.prototype._createItem=function(t){var i=this,o=document.createElement("div"),n=document.createElement("span"),s=document.createElement("a");return o.appendChild(n),o.appendChild(s),o.className="wj-token",n.className="wj-token-label",n.innerHTML=t,s.className="wj-token-close",s.href="#",s.tabIndex=-1,s.text="×",o.style.cssFloat=this.rightToLeft?"right":"left",this.addEventListener(o,"click",function(t){i._helperInput.focus();var n=i._wjTpl.querySelector("."+e._clsActive);n&&wijmo_1.removeClass(n,e._clsActive),wijmo_1.addClass(o,e._clsActive),t.stopPropagation(),t.preventDefault()}),this.addEventListener(s,"click",function(t){if(!i.isReadOnly){var e=i._getItemIndex(o);if(e>-1){var n=i._selItems[e];i._updateSelItems(n,!1)}i._wjTpl.removeChild(o),i._adjustInputWidth(),i._disableInput(!1),i._tbx.focus(),t.stopPropagation(),t.preventDefault()}}),o},e.prototype._itemOn=function(t){var i,o,n,s=wijmo_1.getActiveElement();if((this._tbx!=s||0===this._tbx.value.length)&&0!==(i=this._wjTpl.querySelectorAll(".wj-token")).length)if(o=this._wjTpl.querySelector("."+e._clsActive),n=this._getItemIndex(o),t){if(0===n)return;-1===n?(wijmo_1.addClass(i[i.length-1],e._clsActive),this._helperInput.focus()):(wijmo_1.removeClass(o,e._clsActive),wijmo_1.addClass(i[n-1],e._clsActive),this._helperInput.focus())}else if(!t){if(-1===n)return;n!==i.length-1?(wijmo_1.removeClass(o,e._clsActive),wijmo_1.addClass(i[n+1],e._clsActive),this._helperInput.focus()):(wijmo_1.removeClass(o,e._clsActive),this._tbx.focus())}},e.prototype._itemOff=function(){var t=this._wjTpl.querySelector("."+e._clsActive);t&&wijmo_1.removeClass(t,e._clsActive)},e.prototype._initSeltems=function(){if(this.selectedMemberPath&&""!==this.selectedMemberPath){var t=this.itemsSource;if(this._selItems.splice(0,this._selItems.length),t)for(var e=0;e<t.sourceCollection.length;e++)this._getSelItem(e)&&this._selItems.push(t.sourceCollection[e])}},e.prototype._getSelItem=function(t){var e=this.itemsSource.sourceCollection[t];return!(!wijmo_1.isObject(e)||!this.selectedMemberPath)&&this._selPath.getValue(e)},e.prototype._setSelItem=function(t,e){this.itemsSource;wijmo_1.isObject(t)&&this._selPath.getValue(t)!=e&&this._selPath.setValue(t,e)},e.prototype._clearSelIndex=function(){this.selectedIndex=-1},e.prototype._hasSelectedMemeberPath=function(){return this.selectedMemberPath&&""!==this.selectedMemberPath},e.prototype._disableInput=function(t){null!=this._maxSelItems&&(this._selItems.length<this._maxSelItems?(this._tbx.disabled=!1,this._tbx.focus()):(this._tbx.disabled=!0,this.hostElement.focus()))},e.prototype._adjustInputWidth=function(){this._tbx.style.width="60px";var t,e=wijmo_1.getElementRect(this.hostElement),i=wijmo_1.getElementRect(this._tbx),o=getComputedStyle(this._tbx),n=parseInt(o.paddingLeft,10),s=parseInt(o.paddingRight,10);t=this.rightToLeft?i.left+i.width-e.left-n-s-8:e.left+e.width-i.left-n-s-8,this._tbx.style.width=t+"px"},e.prototype._getItemIndex=function(t){for(var e=this.hostElement.querySelectorAll(".wj-token"),i=0;i<e.length;i++)if(t===e[i])return i;return-1},e._clsActive="wj-token-active",e}(AutoComplete);exports.MultiAutoComplete=MultiAutoComplete,wijmo_1._registerModule("wijmo.input",selfModule);