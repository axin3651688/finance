/*!
    *
    * Wijmo Library 5.20191.603
    * http://wijmo.com/
    *
    * Copyright(c) GrapeCity, Inc.  All rights reserved.
    *
    * Licensed under the GrapeCity Commercial License.
    * sales@wijmo.com
    * wijmo.com/products/wijmo-5/license/
    *
    */

"use strict";var __extends=this&&this.__extends||function(){var t=function(i,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var e in i)i.hasOwnProperty(e)&&(t[e]=i[e])})(i,e)};return function(i,e){function a(){this.constructor=i}t(i,e),i.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}}();Object.defineProperty(exports,"__esModule",{value:!0});var wijmo_1=require("wijmo/wijmo"),wijmo_chart_1=require("wijmo/wijmo.chart"),wijmo_chart_finance_1=require("wijmo/wijmo.chart.finance"),selfModule=require("wijmo/wijmo.chart.finance.analytics");function isValid(t){return isFinite(t)&&!isNaN(t)&&wijmo_1.isNumber(t)}var Fibonacci=function(t){function i(i){var e=t.call(this)||this;return e._levels=[0,23.6,38.2,50,61.8,100],e._uptrend=!0,e._labelPosition=wijmo_chart_1.LabelPosition.Left,e.rendering.addHandler(e._render),e.initialize(i),e}return __extends(i,t),Object.defineProperty(i.prototype,"low",{get:function(){return this._low},set:function(t){t!=this._low&&(this._low=wijmo_1.asNumber(t,!0),this._invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"high",{get:function(){return this._high},set:function(t){t!=this._high&&(this._high=wijmo_1.asNumber(t,!0),this._invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"labelPosition",{get:function(){return this._labelPosition},set:function(t){(t=wijmo_1.asEnum(t,wijmo_chart_1.LabelPosition,!0))!=this._labelPosition&&(this._labelPosition=t,this._invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"uptrend",{get:function(){return this._uptrend},set:function(t){t!=this._uptrend&&(this._uptrend=wijmo_1.asBoolean(t,!0),this._invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"levels",{get:function(){return this._levels},set:function(t){t!=this._levels&&(this._levels=wijmo_1.asArray(t,!0),this._invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"minX",{get:function(){return this._minX},set:function(t){t!=this._minX&&(this._minX=t,this._invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"maxX",{get:function(){return this._maxX},set:function(t){t!=this._maxX&&(this._maxX=t,this._invalidate())},enumerable:!0,configurable:!0}),i.prototype._getMinX=function(){return wijmo_1.isNumber(this._minX)?this._minX:wijmo_1.isDate(this._minX)?wijmo_1.asDate(this._minX).valueOf():this._getAxisX().actualMin},i.prototype._getMaxX=function(){return wijmo_1.isNumber(this._maxX)?this._maxX:wijmo_1.isDate(this._maxX)?wijmo_1.asDate(this._maxX).valueOf():this._getAxisX().actualMax},i.prototype._updateLevels=function(){var i=void 0,e=void 0;if(void 0===this._low||void 0===this._high){var a=t.prototype.getValues.call(this,0),s=t.prototype.getValues.call(this,1);if(a)for(var n=a.length,o=this._getMinX(),r=this._getMaxX(),l=0;l<n;l++){var _=a[l],h=s?s[l]:l;h<o||h>r||(isNaN(_)||((void 0===i||i>_)&&(i=_),(void 0===e||e<_)&&(e=_)))}}void 0===this._low&&void 0!==i?this._actualLow=i:this._actualLow=this._low,void 0===this._high&&void 0!==e?this._actualHigh=e:this._actualHigh=this._high},i.prototype._render=function(t,i){i.cancel=!0;var e=t;e._updateLevels();var a=e._getAxisX(),s=e._getAxisY(),n=i.engine,o=e._getSymbolStroke(e._chart.series.indexOf(e)),r=wijmo_chart_1._BasePlotter.cloneStyle(e.style,["fill"]),l=wijmo_chart_1._BasePlotter.cloneStyle(e.style,["stroke"]),_=e.chart._plotrectId;n.stroke=o,n.strokeWidth=2,n.textFill=o;var h=e._getMinX(),c=e._getMaxX();h<a.actualMin&&(h=a.actualMin),c>a.actualMax&&(c=a.actualMax),n.startGroup(null,_);for(var u=e._levels?e._levels.length:0,p=0;p<u;p++){var m=e._levels[p],d=a.convert(h),g=a.convert(c),f=e.uptrend?s.convert(e._actualLow+.01*m*(e._actualHigh-e._actualLow)):s.convert(e._actualHigh-.01*m*(e._actualHigh-e._actualLow));if(wijmo_chart_1._DataInfo.isValid(d)&&wijmo_chart_1._DataInfo.isValid(g)&&wijmo_chart_1._DataInfo.isValid(f)&&(n.drawLine(d,f,g,f,null,r),e.labelPosition!=wijmo_chart_1.LabelPosition.None)){var w=m.toFixed(1)+"%",y=0;switch((e.uptrend&&0==p||!e.uptrend&&p==u-1)&&(y=2),e.labelPosition){case wijmo_chart_1.LabelPosition.Left:wijmo_chart_1.FlexChartCore._renderText(n,w,new wijmo_1.Point(d,f),0,y,null,null,l);break;case wijmo_chart_1.LabelPosition.Center:wijmo_chart_1.FlexChartCore._renderText(n,w,new wijmo_1.Point(.5*(d+g),f),1,y,null,null,l);break;case wijmo_chart_1.LabelPosition.Right:wijmo_chart_1.FlexChartCore._renderText(n,w,new wijmo_1.Point(g,f),2,y,null,null,l)}}}n.stroke=null,n.strokeWidth=null,n.textFill=null,n.endGroup()},i.prototype._getChartType=function(){return wijmo_chart_1.ChartType.Line},i}(wijmo_chart_1.SeriesBase);exports.Fibonacci=Fibonacci;var FibonacciArcs=function(t){function i(i){var e=t.call(this)||this;return e._levels=[38.2,50,61.8],e._labelPosition=wijmo_chart_1.LabelPosition.Top,e.rendering.addHandler(e._render,e),e.initialize(i),e}return __extends(i,t),Object.defineProperty(i.prototype,"start",{get:function(){return this._start},set:function(t){t!==this.start&&(this._start=wijmo_1.asType(t,wijmo_chart_1.DataPoint),this._invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"end",{get:function(){return this._end},set:function(t){t!==this.end&&(this._end=wijmo_1.asType(t,wijmo_chart_1.DataPoint),this._invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"levels",{get:function(){return this._levels},set:function(t){t!==this._levels&&(this._levels=wijmo_1.asArray(t,!1),this._invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"labelPosition",{get:function(){return this._labelPosition},set:function(t){(t=wijmo_1.asEnum(t,wijmo_chart_1.LabelPosition))!==this.labelPosition&&(this._labelPosition=t,this._invalidate())},enumerable:!0,configurable:!0}),i.prototype._render=function(i,e){e.cancel=!0;var a=this._getX(0),s=this._getY(0),n=this._getX(1),o=this._getY(1);if(!(t.prototype._getLength.call(this)<=1)&&isValid(a)&&isValid(s)&&isValid(n)&&isValid(o)){var r,l=this._getAxisX(),_=this._getAxisY(),h=e.engine,c=this.chart.series.indexOf(this),u=this._getSymbolStroke(c),p=wijmo_chart_1._BasePlotter.cloneStyle(this.style,["fill"]),m=wijmo_chart_1._BasePlotter.cloneStyle(this.style,["stroke"]);h.stroke=u,h.strokeWidth=2,h.textFill=u;var d,g,f,w,y,j,v,V,b,x=this.chart._plotrectId,P=o-s;r=h.startGroup(null,x),wijmo_1.addClass(r,"fibonacci-arcs"),isValid(a)&&isValid(s)&&isValid(n)&&isValid(o)&&h.drawLines([l.convert(a),l.convert(n)],[_.convert(s),_.convert(o)],null,p),w=Math.sqrt(Math.pow(l.convert(n)-l.convert(a),2)+Math.pow(_.convert(o)-_.convert(s),2)),j=new wijmo_1.Point(n,o);for(var k=0;k<this.levels.length;k++)if(v=.01*this.levels[k],y=Math.abs(w*v),isValid(j.x)&&isValid(j.y)&&isValid(y)&&(d=l.convert(j.x),g=_.convert(j.y),h.drawDonutSegment(d,g,y,y,P>0?0:Math.PI,Math.PI,null,p),this.labelPosition!==wijmo_chart_1.LabelPosition.None&&0!==v)){switch(b=wijmo_1.Globalize.format(v,"p1"),V=h.measureString(b,null,null,m),f=P<=0?g-y:g+y,this.labelPosition){case wijmo_chart_1.LabelPosition.Center:f+=.5*V.height;break;case wijmo_chart_1.LabelPosition.Bottom:f+=P<=0?V.height:0;break;default:f+=P<=0?0:V.height}h.drawString(b,new wijmo_1.Point(d-.5*V.width,f),null,m)}h.stroke=null,h.strokeWidth=null,h.textFill=null,h.endGroup()}},i.prototype._getX=function(t){var i=null;return 0===t&&this.start?i=this.start.x:1===t&&this.end&&(i=this.end.x),wijmo_1.isDate(i)&&(i=wijmo_1.asDate(i).valueOf()),i},i.prototype._getY=function(t){var i=null;return 0===t&&this.start?i=this.start.y:1===t&&this.end&&(i=this.end.y),i},i.prototype._getChartType=function(){return wijmo_chart_1.ChartType.Line},i}(wijmo_chart_1.SeriesBase);exports.FibonacciArcs=FibonacciArcs;var FibonacciFans=function(t){function i(i){var e=t.call(this)||this;return e._levels=[0,23.6,38.2,50,61.8,100],e._labelPosition=wijmo_chart_1.LabelPosition.Top,e.rendering.addHandler(e._render,e),e.initialize(i),e}return __extends(i,t),Object.defineProperty(i.prototype,"start",{get:function(){return this._start},set:function(t){t!==this.start&&(this._start=wijmo_1.asType(t,wijmo_chart_1.DataPoint),this._invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"end",{get:function(){return this._end},set:function(t){t!==this.end&&(this._end=wijmo_1.asType(t,wijmo_chart_1.DataPoint),this._invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"levels",{get:function(){return this._levels},set:function(t){t!==this._levels&&(this._levels=wijmo_1.asArray(t,!1),this._invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"labelPosition",{get:function(){return this._labelPosition},set:function(t){(t=wijmo_1.asEnum(t,wijmo_chart_1.LabelPosition))!==this.labelPosition&&(this._labelPosition=t,this._invalidate())},enumerable:!0,configurable:!0}),i.prototype._updateLevels=function(){if(!this.start||!this.end){var i,e,a,s,n=this.chart._getPlotter(this),o=this._getAxisX(),r=t.prototype.getValues.call(this,0),l=t.prototype.getValues.call(this,1)||n.dataInfo.getXVals();r&&r.length>0&&(a=wijmo_chart_finance_1._minimum(r),s=wijmo_chart_finance_1._maximum(r)),l&&l.length>0?(i=wijmo_chart_finance_1._minimum(l),e=wijmo_chart_finance_1._maximum(l)):(i=o.actualMin,e=o.actualMax),isValid(i)&&isValid(a)&&isValid(e)&&isValid(s)&&(this.start=new wijmo_chart_1.DataPoint(i,a),this.end=new wijmo_chart_1.DataPoint(e,s))}},i.prototype._render=function(i,e){e.cancel=!0,this._updateLevels();var a=this._getX(0),s=this._getY(0),n=this._getX(1),o=this._getY(1);if(!(t.prototype._getLength.call(this)<=1)&&isValid(a)&&isValid(s)&&isValid(n)&&isValid(o)){var r=this._getAxisX(),l=this._getAxisY(),_=this.chart.series.indexOf(this),h=e.engine,c=this._getSymbolStroke(_),u=wijmo_chart_1._BasePlotter.cloneStyle(this.style,["fill"]),p=wijmo_chart_1._BasePlotter.cloneStyle(this.style,["stroke"]);h.stroke=c,h.strokeWidth=2,h.textFill=c;var m,d,g,f,w,y,j,v,V,b,x,P,k,L=o-s,X=n-a,M=this.chart._plotrectId;m=a,g=s,f=o;var B=d=n;h.startGroup(null,M);for(var I=0;I<this.levels.length;I++)if(d=X<0?r.actualMin:r.actualMax,f=(v=((f=g+(b=.01*this.levels[I])*L)-g)/(B-m))*d+(V=f-v*B),L>0&&f>l.actualMax?d=((f=l.actualMax)-V)/v:L<0&&f<l.actualMin&&(d=((f=l.actualMin)-V)/v),isValid(m)&&isValid(g)&&isValid(d)&&isValid(f)&&(w=new wijmo_1.Point(r.convert(m),l.convert(g)),y=new wijmo_1.Point(r.convert(d),l.convert(f)),h.drawLines([w.x,y.x],[w.y,y.y],null,u),this.labelPosition!=wijmo_chart_1.LabelPosition.None)){x=wijmo_1.Globalize.format(b,"p1"),P=h.measureString(x,null,null,p),k=180*Math.atan((y.y-w.y)/(y.x-w.x))/Math.PI,j=y.clone(),y.x=X>0?y.x-P.width:y.x;var O,C=k*Math.PI/180,S=new wijmo_1.Point,A=new wijmo_1.Point,D=new wijmo_1.Point,T=new wijmo_1.Point,Y=l.convert(l.actualMin),W=l.convert(l.actualMax),R=r.convert(r.actualMin),N=r.convert(r.actualMax),F=j.clone();switch(this.labelPosition){case wijmo_chart_1.LabelPosition.Center:y.y+=.5*P.height,F.y+=.5*P.height;break;case wijmo_chart_1.LabelPosition.Bottom:y.y+=P.height}X>0?(this.labelPosition===wijmo_chart_1.LabelPosition.Top||this.labelPosition===wijmo_chart_1.LabelPosition.Center?(T=F.clone(),D.x=T.x+P.height*Math.sin(C),D.y=T.y-P.height*Math.cos(C),S.x=T.x-P.width*Math.cos(C)+P.height*Math.sin(C),S.y=T.y-P.width*Math.sin(C)-P.height*Math.cos(C),A.x=T.x-P.width*Math.cos(C),A.y=T.y-P.width*Math.sin(C)):this.labelPosition===wijmo_chart_1.LabelPosition.Bottom&&(D=F.clone(),S.x=D.x-P.width*Math.cos(C),S.y=D.y-P.width*Math.sin(C),A.x=S.x-P.height*Math.sin(C),A.y=S.y+P.height*Math.cos(C),T.x=S.x+P.width*Math.cos(C)-P.height*Math.sin(C),T.y=S.y+P.width*Math.sin(C)+P.height*Math.cos(C)),L>0?(D.y<W&&(v=(l.convertBack(D.y)-l.convertBack(S.y))/(r.convertBack(D.x)-r.convertBack(S.x)),V=l.convertBack(D.y)-v*r.convertBack(D.x),O=r.convert((l.actualMax-V)/v),y.x-=Math.abs(D.x-O)),T.x>N&&(y.x-=Math.abs(N-T.x))):L<0&&(T.y>Y&&(v=(l.convertBack(A.y)-l.convertBack(T.y))/(r.convertBack(A.x)-r.convertBack(T.x)),V=l.convertBack(T.y)-v*r.convertBack(T.x),O=r.convert((l.actualMin-V)/v),y.x-=Math.max(Math.abs(O-T.x),Math.abs(Y-T.y))),D.x>N&&(y.x-=Math.abs(N-D.x)))):X<0&&(this.labelPosition===wijmo_chart_1.LabelPosition.Top||this.labelPosition===wijmo_chart_1.LabelPosition.Center?(A=F.clone(),S.x=A.x+P.height*Math.sin(C),S.y=A.y-P.height*Math.cos(C),T.x=A.x+P.width*Math.cos(C),T.y=A.y+P.width*Math.sin(C),D.x=S.x+P.width*Math.cos(C),D.y=S.y+P.width*Math.sin(C)):this.labelPosition===wijmo_chart_1.LabelPosition.Bottom&&(S=F.clone(),D.x=S.x+P.width*Math.cos(C),D.y=S.y+P.width*Math.sin(C),A.x=S.x-P.height*Math.sin(C),A.y=S.y+P.height*Math.cos(C),T.x=S.x+P.width*Math.cos(C)-P.height*Math.sin(C),T.y=S.y+P.width*Math.sin(C)+P.height*Math.cos(C)),L>0?(S.y<W&&(v=(l.convertBack(S.y)-l.convertBack(D.y))/(r.convertBack(S.x)-r.convertBack(D.x)),V=l.convertBack(S.y)-v*r.convertBack(S.x),O=r.convert((l.actualMax-V)/v),y.x+=Math.abs(S.x-O)),A.x<R&&(y.x+=Math.abs(R-A.x))):L<0&&(A.y>Y&&(v=(l.convertBack(T.y)-l.convertBack(A.y))/(r.convertBack(T.x)-r.convertBack(A.x)),V=l.convertBack(A.y)-v*r.convertBack(A.x),O=r.convert((l.actualMin-V)/v),y.x+=Math.max(Math.abs(O-A.x),Math.abs(Y-A.y))),S.x<R&&(y.x+=Math.abs(R-S.x)))),0===k?h.drawString(x,y,null,p):h.drawStringRotated(x,y,j,k,null,p)}h.stroke=null,h.strokeWidth=null,h.textFill=null,h.endGroup()}},i.prototype._getX=function(t){var i=null;return 0===t&&this.start?i=this.start.x:1===t&&this.end&&(i=this.end.x),wijmo_1.isDate(i)&&(i=wijmo_1.asDate(i).valueOf()),i},i.prototype._getY=function(t){var i=null;return 0===t&&this.start?i=this.start.y:1===t&&this.end&&(i=this.end.y),i},i.prototype._getChartType=function(){return wijmo_chart_1.ChartType.Line},i}(wijmo_chart_1.SeriesBase);exports.FibonacciFans=FibonacciFans;var FibonacciTimeZones=function(t){function i(i){var e=t.call(this)||this;return e._levels=[0,1,2,3,5,8,13,21,34],e._labelPosition=wijmo_chart_1.LabelPosition.Right,e.rendering.addHandler(e._render,e),e.initialize(i),e}return __extends(i,t),Object.defineProperty(i.prototype,"startX",{get:function(){return this._startX},set:function(t){t!==this.startX&&(wijmo_1.isDate(t)?this._startX=wijmo_1.asDate(t):this._startX=wijmo_1.asNumber(t),this._invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"endX",{get:function(){return this._endX},set:function(t){t!==this.endX&&(wijmo_1.isDate(t)?this._endX=wijmo_1.asDate(t):this._endX=wijmo_1.asNumber(t),this._invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"levels",{get:function(){return this._levels},set:function(t){t!==this._levels&&(this._levels=wijmo_1.asArray(t,!1),this._invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"labelPosition",{get:function(){return this._labelPosition},set:function(t){(t=wijmo_1.asEnum(t,wijmo_chart_1.LabelPosition))!==this.labelPosition&&(this._labelPosition=t,this._invalidate())},enumerable:!0,configurable:!0}),i.prototype._render=function(i,e){e.cancel=!0,this._updateLevels();var a=this._getX(0),s=this._getX(1);if(!(t.prototype._getLength.call(this)<=1)&&isValid(a)&&isValid(s)){var n,o,r,l,_=s-a,h=this._getAxisX(),c=this._getAxisY(),u=this._chart.series.indexOf(this),p=e.engine,m=this._getSymbolStroke(u),d=wijmo_chart_1._BasePlotter.cloneStyle(this.style,["fill"]),g=wijmo_chart_1._BasePlotter.cloneStyle(this.style,["stroke"]),f=c.convert(c.actualMin),w=c.convert(c.actualMax),y=this.chart._plotrectId;if(p.stroke=m,p.strokeWidth=2,p.textFill=m,0!==_){p.startGroup(null,y);for(var j=0;j<this.levels.length;j++)if(!((o=_*(n=this.levels[j])+a)<h.actualMin||h.actualMax<o)&&isValid(o)&&(o=h.convert(o),p.drawLine(o,f,o,w,null,d),this.labelPosition!==wijmo_chart_1.LabelPosition.None)){switch(l=wijmo_1.Globalize.format(n,"n0"),r=p.measureString(l,null,null,g),this.labelPosition){case wijmo_chart_1.LabelPosition.Left:o-=r.width+2;break;case wijmo_chart_1.LabelPosition.Center:o-=r.width/2;break;case wijmo_chart_1.LabelPosition.Right:o+=2;break;default:o=_<0?o-r.width-2:o+2}p.drawString(l,new wijmo_1.Point(o,f),null,g)}p.stroke=null,p.strokeWidth=null,p.textFill=null,p.endGroup()}}},i.prototype._updateLevels=function(){var i=this.chart._getPlotter(this),e=t.prototype.getValues.call(this,1)||i.dataInfo.getXVals();if(!(t.prototype._getLength.call(this)<=1)){var a=this._getX(0),s=this._getX(1),n=wijmo_1.isNumber(a)&&wijmo_1.isNumber(s);n||e?!n&&e&&(this._startX=e[0],this._endX=e[1]):(this._startX=0,this._endX=1)}},i.prototype._getX=function(t){var i=null;return 0===t?i=this.startX:1===t&&(i=this.endX),wijmo_1.isDate(i)&&(i=wijmo_1.asDate(i).valueOf()),i},i.prototype._getChartType=function(){return wijmo_chart_1.ChartType.Line},i}(wijmo_chart_1.SeriesBase);exports.FibonacciTimeZones=FibonacciTimeZones;var OverlayIndicatorBase=function(t){function i(i){var e=t.call(this,i)||this;return e._seriesCount=1,e}return __extends(i,t),Object.defineProperty(i.prototype,"_hitTester",{get:function(){return this._plotter&&!this.__hitTester&&(this.__hitTester=this._plotter.hitTester),this.__hitTester},enumerable:!0,configurable:!0}),i.prototype._getChartType=function(){return wijmo_chart_1.ChartType.Line},i.prototype._getXValues=function(){return t.prototype.getValues.call(this,1)||this._plotter.dataInfo.getXVals()},i.prototype._getDataPoint=function(t,i,e,a,s,n){var o=new wijmo_chart_1._DataPoint(e,a,t,i);return o.y=i,o.yfmt=n._formatValue(i),o.x=t,o.xfmt=s._formatValue(t),o},i.prototype._shouldCalculate=function(){return!0},i.prototype._init=function(){},i.prototype._calculate=function(){},i.prototype._clearValues=function(){t.prototype._clearValues.call(this),this.__hitTester=null},i.prototype._getName=function(t){var i=void 0;if(this.name)if(this.name.indexOf(",")){var e=this.name.split(",");e&&e.length-1>=t&&(i=e[t].trim())}else i=this.name;return i},i.prototype._getStyles=function(t){var i=null;if(t<0||null===this._styles)return i;var e=0;for(var a in this._styles){if(e===t&&this._styles.hasOwnProperty(a)){i=this._styles[a];break}e++}return i},i.prototype.legendItemLength=function(){return this._seriesCount},i.prototype.measureLegendItem=function(t,i){var e=this._getName(i),a=new wijmo_1.Size(0,0);return e&&(a=this._measureLegendItem(t,this._getName(i))),a},i.prototype.drawLegendItem=function(t,i,e){var a=this._getStyles(e)||this.style;this._getName(e)&&this._drawLegendItem(t,i,this._getChartType(),this._getName(e),a,this.symbolStyle)},i}(wijmo_chart_1.SeriesBase);exports.OverlayIndicatorBase=OverlayIndicatorBase;var SingleOverlayIndicatorBase=function(t){function i(i){var e=t.call(this,i)||this;return e._period=14,e}return __extends(i,t),Object.defineProperty(i.prototype,"period",{get:function(){return this._period},set:function(t){t!==this._period&&(this._period=wijmo_1.asInt(t,!1,!0),this._clearValues(),this._invalidate())},enumerable:!0,configurable:!0}),i.prototype.getValues=function(i){var e=null;return t.prototype._getLength.call(this)<=0?e:(this._shouldCalculate()&&(this._init(),this._calculate()),0===i?e=this._yvals:1===i&&(e=this._xvals),e)},i.prototype.getDataRect=function(i,e){if(e)return e;var a=null;if(t.prototype._getLength.call(this)<=0)return a;this._shouldCalculate()&&(this._init(),this._calculate());var s=wijmo_chart_finance_1._minimum(this._xvals),n=wijmo_chart_finance_1._maximum(this._xvals),o=wijmo_chart_finance_1._minimum(this._yvals),r=wijmo_chart_finance_1._maximum(this._yvals);return wijmo_chart_1._DataInfo.isValid(s)&&wijmo_chart_1._DataInfo.isValid(n)&&wijmo_chart_1._DataInfo.isValid(o)&&wijmo_chart_1._DataInfo.isValid(r)&&(a=new wijmo_1.Rect(s,o,n-s,r-o)),a},i.prototype._clearValues=function(){t.prototype._clearValues.call(this),this._xvals=null,this._yvals=null},i.prototype._shouldCalculate=function(){return!this._yvals||!this._xvals},i.prototype._init=function(){t.prototype._init.call(this),this._yvals=[],this._xvals=[]},i.prototype._getItem=function(i){return t.prototype._getLength.call(this)<=0?t.prototype._getItem.call(this,i):(this._shouldCalculate()&&(this._init(),this._calculate()),i=t.prototype._getLength.call(this)-wijmo_chart_finance_1._minimum(this._yvals.length,this._xvals.length)+i,t.prototype._getItem.call(this,i))},i}(OverlayIndicatorBase);exports.SingleOverlayIndicatorBase=SingleOverlayIndicatorBase;var WilliamsR=function(t){function i(i){var e=t.call(this)||this;return e.period=14,e.initialize(i),e}return __extends(i,t),i.prototype._calculate=function(){var i=t.prototype._getLength.call(this);if(!(i<=0)){var e=t.prototype._getBindingValues.call(this,0),a=t.prototype._getBindingValues.call(this,1),s=t.prototype._getBindingValues.call(this,3),n=this._getXValues();this._yvals=_williamsR(e,a,s,this.period),this._xvals=n?n.slice(this.period-1):wijmo_chart_finance_1._range(this.period-1,i-1)}},i}(SingleOverlayIndicatorBase);function _williamsR(t,i,e,a){wijmo_1.asArray(t,!1),wijmo_1.asArray(i,!1),wijmo_1.asArray(e,!1),wijmo_1.asInt(a,!1,!0);var s,n=wijmo_chart_finance_1._minimum(t.length,i.length,e.length),o=[],r=[],l=[];for(wijmo_1.assert(n>a&&a>1,"Williams %R period must be an integer less than the length of the data and greater than one."),s=a;s<=t.length;s++)o.push(wijmo_chart_finance_1._maximum(t.slice(s-a,s))),r.push(wijmo_chart_finance_1._minimum(i.slice(s-a,s)));for(e.splice(0,a-1),s=0;s<o.length;s++)l.push((o[s]-e[s])/(o[s]-r[s])*-100);return l}exports.WilliamsR=WilliamsR,exports._williamsR=_williamsR;var Stochastic=function(t){function i(i){var e=t.call(this)||this;return e._kPeriod=14,e._dPeriod=3,e._smoothingPeriod=1,e._seriesCount=2,e.rendering.addHandler(e._rendering,e),e.initialize(i),e}return __extends(i,t),Object.defineProperty(i.prototype,"kPeriod",{get:function(){return this._kPeriod},set:function(t){t!==this._kPeriod&&(this._kPeriod=wijmo_1.asInt(t,!1,!0),this._clearValues(),this._invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"dPeriod",{get:function(){return this._dPeriod},set:function(t){t!==this._dPeriod&&(this._dPeriod=wijmo_1.asInt(t,!1,!0),this._clearValues(),this._invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"smoothingPeriod",{get:function(){return this._smoothingPeriod},set:function(t){t!==this._smoothingPeriod&&(this._smoothingPeriod=wijmo_1.asInt(t,!1,!0),this._clearValues(),this._invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"styles",{get:function(){return this._styles},set:function(t){t!==this._styles&&(this._styles=t,this._invalidate())},enumerable:!0,configurable:!0}),i.prototype.getDataRect=function(i,e){if(e)return e;var a=null;if(t.prototype._getLength.call(this)<=0)return a;this._shouldCalculate()&&(this._init(),this._calculate());var s=this._kVals.concat(this._dVals),n=this._kXVals.concat(this._dXVals),o=wijmo_chart_finance_1._minimum(n),r=wijmo_chart_finance_1._maximum(n),l=wijmo_chart_finance_1._minimum(s),_=wijmo_chart_finance_1._maximum(s);return wijmo_chart_1._DataInfo.isValid(o)&&wijmo_chart_1._DataInfo.isValid(r)&&wijmo_chart_1._DataInfo.isValid(l)&&wijmo_chart_1._DataInfo.isValid(_)&&(a=new wijmo_1.Rect(o,l,r-o,_-l)),a},i.prototype._clearValues=function(){t.prototype._clearValues.call(this),this._kVals=null,this._kXVals=null,this._dVals=null,this._dXVals=null},i.prototype._shouldCalculate=function(){return!(this._kVals&&this._kXVals&&this._dVals&&this._dXVals)},i.prototype._init=function(){t.prototype._init.call(this),this._kVals=[],this._kXVals=[],this._dVals=[],this._dXVals=[]},i.prototype._calculate=function(){var i=t.prototype._getLength.call(this);if(!(t.prototype._getLength.call(this)<=0)){var e=t.prototype._getBindingValues.call(this,0),a=t.prototype._getBindingValues.call(this,1),s=t.prototype._getBindingValues.call(this,3),n=this._getXValues(),o=_stochastic(e,a,s,this.kPeriod,this.dPeriod,this.smoothingPeriod);this._kVals=o.ks,this._dVals=o.ds,this._kXVals=n?n.slice(this.kPeriod-1):wijmo_chart_finance_1._range(this.kPeriod-1,i-1),this.smoothingPeriod&&this.smoothingPeriod>1&&(this._kXVals=this._kXVals.slice(this._kXVals.length-this._kVals.length,this._kXVals.length)),this._dXVals=this._kXVals.slice(this._kXVals.length-this._dVals.length,this._kXVals.length)}},i.prototype._rendering=function(i,e){if(e.cancel=!0,!(t.prototype._getLength.call(this)<=0)){this._shouldCalculate()&&(this._init(),this._calculate());var a=this.chart.series.indexOf(this),s=e.engine,n=this._getAxisX(),o=this._getAxisY(),r=wijmo_chart_1._BasePlotter.cloneStyle(this.style,["fill"]),l=this._getSymbolStroke(a),_=this.chart._plotrectId,h=null,c=l,u=2,p=null,m=l,d=2;this.styles&&wijmo_1.isObject(this.styles)&&(this.styles.kLine&&wijmo_1.isObject(this.styles.kLine)&&(c=(h=wijmo_chart_1._BasePlotter.cloneStyle(this.styles.kLine,["fill"])).stroke?h.stroke:l,u=h.strokeWidth?h.strokeWidth:2),this.styles.dLine&&wijmo_1.isObject(this.styles.dLine)&&(m=(p=wijmo_chart_1._BasePlotter.cloneStyle(this.styles.dLine,["fill"])).stroke?p.stroke:l,d=p.strokeWidth?p.strokeWidth:2));var g,f,w,y,j=[],v=[],V=[],b=[],x=this._getLength();for(w=0;w<this._kVals.length;w++)y=x-this._kVals.length+w,v.push(n.convert(this._kXVals[w])),j.push(o.convert(this._kVals[w])),(g=this._getDataPoint(this._kXVals[w],this._kVals[w],a,y,n,o)).name=this._getName(0),(f=new wijmo_chart_1._CircleArea(new wijmo_1.Point(v[w],j[w]),.5*s.strokeWidth)).tag=g,this._hitTester.add(f,a);for(this._hitTester.add(new wijmo_chart_1._LinesArea(v,j),a),s.stroke=c,s.strokeWidth=u,s.drawLines(v,j,null,r,_),w=0;w<this._dVals.length;w++)y=x-this._dVals.length+w,b.push(n.convert(this._dXVals[w])),V.push(o.convert(this._dVals[w])),(g=this._getDataPoint(this._dXVals[w],this._dVals[w],a,y,n,o)).name=this._getName(1),(f=new wijmo_chart_1._CircleArea(new wijmo_1.Point(b[w],V[w]),.5*s.strokeWidth)).tag=g,this._hitTester.add(f,a);this._hitTester.add(new wijmo_chart_1._LinesArea(b,V),a),s.stroke=m,s.strokeWidth=d,s.drawLines(b,V,null,r,_)}},i.prototype.getCalculatedValues=function(i){i=wijmo_1.asString(i,!1);var e=[],a=0;if(t.prototype._getLength.call(this)<=0)return e;switch(this._shouldCalculate()&&(this._init(),this._calculate()),i){case"kLine":for(;a<this._kVals.length;a++)e.push({x:this._kXVals[a],y:this._kVals[a]});break;case"dLine":for(;a<this._dVals.length;a++)e.push({x:this._dXVals[a],y:this._dVals[a]})}return e},i}(OverlayIndicatorBase);function _stochastic(t,i,e,a,s,n){wijmo_1.asArray(t,!1),wijmo_1.asArray(i,!1),wijmo_1.asArray(e,!1),wijmo_1.asInt(a,!1,!0),wijmo_1.asInt(s,!1,!0),wijmo_1.asInt(n,!0,!0);var o,r=[],l=[],_=[];for(o=a;o<=t.length;o++)r.push(wijmo_chart_finance_1._maximum(t.slice(o-a,o))),l.push(wijmo_chart_finance_1._minimum(i.slice(o-a,o)));for(e=e.slice(a-1),o=0;o<e.length;o++)_.push((e[o]-l[o])/(r[o]-l[o])*100);return n&&n>1&&(_=wijmo_chart_finance_1._sma(_,n)),{ks:_,ds:wijmo_chart_finance_1._sma(_,s)}}exports.Stochastic=Stochastic,exports._stochastic=_stochastic;var RSI=function(t){function i(i){var e=t.call(this)||this;return e.period=14,e.initialize(i),e}return __extends(i,t),i.prototype._calculate=function(){var i=t.prototype._getLength.call(this);if(!(i<=0)){var e=t.prototype._getBindingValues.call(this,0),a=this._getXValues();this._yvals=_rsi(e,this.period),this._xvals=a?a.slice(this.period):wijmo_chart_finance_1._range(this.period,i)}},i}(SingleOverlayIndicatorBase);function _rsi(t,i){wijmo_1.asArray(t,!1),wijmo_1.asInt(i,!0,!1),wijmo_1.assert(t.length>i&&i>1,"RSI period must be an integer less than the length of the data and greater than one.");var e,a,s,n,o=[],r=[],l=[],_=[];for(n=1;n<t.length;n++)o.push(t[n]-t[n-1]);for(e=o.map(function(t){return t>0?t:0}),a=o.map(function(t){return t<0?Math.abs(t):0}),n=i;n<=o.length;n++)n===i?(r.push(wijmo_chart_finance_1._sum(e.slice(n-i,n))/i),l.push(wijmo_chart_finance_1._sum(a.slice(n-i,n))/i)):(r.push((e[n-1]+r[n-i-1]*(i-1))/i),l.push((a[n-1]+l[n-i-1]*(i-1))/i)),s=r[n-i]/l[n-i],s=isFinite(s)?s:0,_.push(100-100/(1+s));return _}exports.RSI=RSI,exports._rsi=_rsi;var MacdBase=function(t){function i(i){var e=t.call(this,i)||this;return e._fastPeriod=12,e._slowPeriod=26,e._smoothingPeriod=9,e}return __extends(i,t),Object.defineProperty(i.prototype,"fastPeriod",{get:function(){return this._fastPeriod},set:function(t){t!==this._fastPeriod&&(this._fastPeriod=wijmo_1.asInt(t,!1,!0),this._clearValues(),this._invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"slowPeriod",{get:function(){return this._slowPeriod},set:function(t){t!==this._slowPeriod&&(this._slowPeriod=wijmo_1.asInt(t,!1,!0),this._clearValues(),this._invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"smoothingPeriod",{get:function(){return this._smoothingPeriod},set:function(t){t!==this._smoothingPeriod&&(this._smoothingPeriod=wijmo_1.asInt(t,!1,!0),this._clearValues(),this._invalidate())},enumerable:!0,configurable:!0}),i.prototype._clearValues=function(){t.prototype._clearValues.call(this),this._macdVals=null,this._macdXVals=null,this._signalVals=null,this._signalXVals=null,this._histogramVals=null,this._histogramXVals=null},i.prototype._shouldCalculate=function(){return!(this._macdVals&&this._macdXVals&&this._signalVals&&this._signalXVals&&this._histogramVals&&this._histogramXVals)},i.prototype._init=function(){t.prototype._init.call(this),this._macdVals=[],this._macdXVals=[],this._signalVals=[],this._signalXVals=[],this._histogramVals=[],this._histogramXVals=[]},i.prototype._calculate=function(){var i=t.prototype._getLength.call(this);if(!(i<=0)){var e=t.prototype.getValues.call(this,0),a=this._getXValues(),s=_macd(e,this.fastPeriod,this.slowPeriod,this.smoothingPeriod);this._macdVals=s.macds,this._signalVals=s.signals,this._histogramVals=s.histograms,this._macdXVals=a?a.slice(i-this._macdVals.length,i):wijmo_chart_finance_1._range(i-this._macdVals.length,i-1),this._signalXVals=a?a.slice(i-this._signalVals.length,i):wijmo_chart_finance_1._range(i-this._signalVals.length,i-1),this._histogramXVals=a?a.slice(i-this._histogramVals.length,i):wijmo_chart_finance_1._range(i-this._histogramVals.length,i-1)}},i}(OverlayIndicatorBase);exports.MacdBase=MacdBase;var Macd=function(t){function i(i){var e=t.call(this)||this;return e._seriesCount=2,e.rendering.addHandler(e._rendering,e),e.initialize(i),e}return __extends(i,t),Object.defineProperty(i.prototype,"styles",{get:function(){return this._styles},set:function(t){t!==this._styles&&(this._styles=t,this._invalidate())},enumerable:!0,configurable:!0}),i.prototype.legendItemLength=function(){return this.name.indexOf(",")>-1?2:1},i.prototype.getDataRect=function(i,e){if(e)return e;var a=null;if(t.prototype._getLength.call(this)<=0)return a;this._shouldCalculate()&&(this._init(),this._calculate());var s=[],n=[];n.push.apply(n,this._macdXVals),n.push.apply(n,this._signalXVals),s.push.apply(s,this._macdVals),s.push.apply(s,this._signalVals);var o=wijmo_chart_finance_1._minimum(n),r=wijmo_chart_finance_1._maximum(n),l=wijmo_chart_finance_1._minimum(s),_=wijmo_chart_finance_1._maximum(s);return wijmo_chart_1._DataInfo.isValid(o)&&wijmo_chart_1._DataInfo.isValid(r)&&wijmo_chart_1._DataInfo.isValid(l)&&wijmo_chart_1._DataInfo.isValid(_)&&(a=new wijmo_1.Rect(o,l,r-o,_-l)),a},i.prototype._rendering=function(i,e){if(e.cancel=!0,!(t.prototype._getLength.call(this)<=0)){this._shouldCalculate()&&(this._init(),this._calculate());var a=this.chart.series.indexOf(this),s=e.engine,n=this._getAxisX(),o=this._getAxisY(),r=wijmo_chart_1._BasePlotter.cloneStyle(this.style,["fill"]),l=this._getSymbolStroke(a),_=this.chart._plotrectId,h=null,c=l,u=2,p=null,m=l,d=2;this.styles&&wijmo_1.isObject(this.styles)&&(this.styles.macdLine&&wijmo_1.isObject(this.styles.macdLine)&&(c=(h=wijmo_chart_1._BasePlotter.cloneStyle(this.styles.macdLine,["fill"])).stroke?h.stroke:l,u=h.strokeWidth?h.strokeWidth:2),this.styles.signalLine&&wijmo_1.isObject(this.styles.signalLine)&&(m=(p=wijmo_chart_1._BasePlotter.cloneStyle(this.styles.signalLine,["fill"])).stroke?p.stroke:l,d=p.strokeWidth?p.strokeWidth:2));var g,f,w,y,j=[],v=[],V=[],b=[],x=this._getLength();for(w=0;w<this._macdVals.length;w++)y=x-this._macdVals.length+w,v.push(n.convert(this._macdXVals[w])),j.push(o.convert(this._macdVals[w])),(g=this._getDataPoint(this._macdXVals[w],this._macdVals[w],a,y,n,o)).name=this._getName(0),(f=new wijmo_chart_1._CircleArea(new wijmo_1.Point(v[w],j[w]),.5*s.strokeWidth)).tag=g,this._hitTester.add(f,a);for(this._hitTester.add(new wijmo_chart_1._LinesArea(v,j),a),s.stroke=c,s.strokeWidth=u,s.drawLines(v,j,null,r,_),w=0;w<this._signalVals.length;w++)y=x-this._signalVals.length+w,b.push(n.convert(this._signalXVals[w])),V.push(o.convert(this._signalVals[w])),(g=this._getDataPoint(this._signalXVals[w],this._signalVals[w],a,y,n,o)).name=this._getName(1),(f=new wijmo_chart_1._CircleArea(new wijmo_1.Point(b[w],V[w]),.5*s.strokeWidth)).tag=g,this._hitTester.add(f,a);this._hitTester.add(new wijmo_chart_1._LinesArea(b,V),a),s.stroke=m,s.strokeWidth=d,s.drawLines(b,V,null,r,_)}},i.prototype.getCalculatedValues=function(i){i=wijmo_1.asString(i,!1);var e=[],a=0;if(t.prototype._getLength.call(this)<=0)return e;switch(this._shouldCalculate()&&(this._init(),this._calculate()),i){case"macdLine":for(;a<this._macdVals.length;a++)e.push({x:this._macdXVals[a],y:this._macdVals[a]});break;case"signalLine":for(;a<this._signalVals.length;a++)e.push({x:this._signalXVals[a],y:this._signalVals[a]})}return e},i}(MacdBase);exports.Macd=Macd;var MovingAverageType,MacdHistogram=function(t){function i(i){return t.call(this,i)||this}return __extends(i,t),i.prototype.getValues=function(i){var e=null;return t.prototype._getLength.call(this)<=0?e:(this._shouldCalculate()&&(this._init(),this._calculate()),0===i?e=this._histogramVals:1===i&&(e=this._histogramXVals),e)},i.prototype.getDataRect=function(i,e){if(e)return e;var a=null;if(t.prototype._getLength.call(this)<=0)return a;this._shouldCalculate()&&(this._init(),this._calculate());var s=wijmo_chart_finance_1._minimum(this._histogramXVals),n=wijmo_chart_finance_1._maximum(this._histogramXVals),o=wijmo_chart_finance_1._minimum(this._histogramVals),r=wijmo_chart_finance_1._maximum(this._histogramVals);return wijmo_chart_1._DataInfo.isValid(s)&&wijmo_chart_1._DataInfo.isValid(n)&&wijmo_chart_1._DataInfo.isValid(o)&&wijmo_chart_1._DataInfo.isValid(r)&&(a=new wijmo_1.Rect(s,o,n-s,r-o)),a},i.prototype._getChartType=function(){return wijmo_chart_1.ChartType.Column},i.prototype._getItem=function(i){return i=t.prototype._getLength.call(this)-wijmo_chart_finance_1._minimum(this._histogramVals.length,this._histogramXVals.length)+i,t.prototype._getItem.call(this,i)},i}(MacdBase);function _macd(t,i,e,a){wijmo_1.asArray(t,!1),wijmo_1.asInt(i,!1,!0),wijmo_1.asInt(e,!1,!0),wijmo_1.asInt(a,!1,!0);var s,n=i>e;n&&(s=e,e=i,i=s);var o,r,l=wijmo_chart_finance_1._ema(t,i),_=wijmo_chart_finance_1._ema(t,e),h=[],c=[];for(l.splice(0,e-i),r=0;r<l.length;r++)s=l[r]-_[r],n&&(s*=-1),h.push(s);o=wijmo_chart_finance_1._ema(h,a);var u=h.slice(h.length-o.length,h.length);for(r=0;r<u.length;r++)c.push(u[r]-o[r]);return{macds:h,signals:o,histograms:c}}exports.MacdHistogram=MacdHistogram,exports._macd=_macd,function(t){t[t.Simple=0]="Simple",t[t.Exponential=1]="Exponential"}(MovingAverageType=exports.MovingAverageType||(exports.MovingAverageType={}));var Envelopes=function(t){function i(i){var e=t.call(this)||this;return e._period=20,e._type=MovingAverageType.Simple,e._size=.025,e.rendering.addHandler(e._rendering,e),e.initialize(i),e}return __extends(i,t),Object.defineProperty(i.prototype,"period",{get:function(){return this._period},set:function(t){t!==this._period&&(this._period=wijmo_1.asInt(t,!1,!0),this._clearValues(),this._invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"type",{get:function(){return this._type},set:function(t){(t=wijmo_1.asEnum(t,MovingAverageType,!1))!==this._type&&(this._type=t,this._clearValues(),this._invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"size",{get:function(){return this._size},set:function(t){t!==this._size&&(this._size=wijmo_1.asNumber(t,!1,!0),this._clearValues(),this._invalidate())},enumerable:!0,configurable:!0}),i.prototype.getDataRect=function(i,e){if(e)return e;var a=null;if(t.prototype._getLength.call(this)<=0)return a;this._shouldCalculate()&&(this._init(),this._calculate());var s=this._upperYVals.concat(this._lowerYVals),n=wijmo_chart_finance_1._minimum(this._xVals),o=wijmo_chart_finance_1._maximum(this._xVals),r=wijmo_chart_finance_1._minimum(s),l=wijmo_chart_finance_1._maximum(s);return wijmo_chart_1._DataInfo.isValid(n)&&wijmo_chart_1._DataInfo.isValid(o)&&wijmo_chart_1._DataInfo.isValid(r)&&wijmo_chart_1._DataInfo.isValid(l)&&(a=new wijmo_1.Rect(n,r,o-n,l-r)),a},i.prototype._clearValues=function(){t.prototype._clearValues.call(this),this._upperYVals=null,this._lowerYVals=null,this._xVals=null},i.prototype._init=function(){t.prototype._init.call(this),this._upperYVals=[],this._lowerYVals=[],this._xVals=[]},i.prototype._shouldCalculate=function(){return!this._upperYVals||!this._lowerYVals||!this._xVals},i.prototype._calculate=function(){var i=this;if(!(t.prototype._getLength.call(this)<=0)){var e,a=t.prototype.getValues.call(this,0),s=this._getXValues();switch(this.type){case MovingAverageType.Exponential:e=wijmo_chart_finance_1._ema(a,this.period);break;case MovingAverageType.Simple:default:e=wijmo_chart_finance_1._sma(a,this.period)}this._xVals=s?s.slice(this.period-1):wijmo_chart_finance_1._range(this.period-1,t.prototype._getLength.call(this)-1),this._upperYVals=e.map(function(t){return t+t*i.size}),this._lowerYVals=e.map(function(t){return t-t*i.size})}},i.prototype._rendering=function(i,e){if(e.cancel=!0,!(t.prototype._getLength.call(this)<=0)){this._shouldCalculate()&&(this._init(),this._calculate());var a=this.chart.series.indexOf(this),s=e.engine,n=this._getAxisX(),o=this._getAxisY(),r=wijmo_chart_finance_1._minimum(this._upperYVals.length,this._lowerYVals.length,this._xVals.length),l=wijmo_chart_1._BasePlotter.cloneStyle(this.style,["fill"]),_=this._getSymbolStroke(a),h=this.chart._plotrectId;if(r&&!(r<=0)){s.stroke=_,s.strokeWidth=2;for(var c,u,p,m=[],d=[],g=[],f=this._getLength(),w=0;w<r;w++)p=f-r+w,m.push(n.convert(this._xVals[w])),d.push(o.convert(this._upperYVals[w])),c=this._getDataPoint(this._xVals[w],this._upperYVals[w],a,p,n,o),(u=new wijmo_chart_1._CircleArea(new wijmo_1.Point(m[w],d[w]),.5*s.strokeWidth)).tag=c,this._hitTester.add(u,a),g.push(o.convert(this._lowerYVals[w])),c=this._getDataPoint(this._xVals[w],this._lowerYVals[w],a,p,n,o),(u=new wijmo_chart_1._CircleArea(new wijmo_1.Point(m[w],g[w]),.5*s.strokeWidth)).tag=c,this._hitTester.add(u,a);this._hitTester.add(new wijmo_chart_1._LinesArea(m,d),a),this._hitTester.add(new wijmo_chart_1._LinesArea(m,g),a),s.drawLines(m,d,null,l,h),s.drawLines(m,g,null,l,h)}}},i.prototype.getCalculatedValues=function(i){i=wijmo_1.asString(i,!1);var e=[],a=0;if(t.prototype._getLength.call(this)<=0)return e;switch(this._shouldCalculate()&&(this._init(),this._calculate()),i){case"upperEnvelope":for(;a<this._upperYVals.length;a++)e.push({x:this._xVals[a],y:this._upperYVals[a]});break;case"lowerEnvelope":for(;a<this._lowerYVals.length;a++)e.push({x:this._xVals[a],y:this._lowerYVals[a]})}return e},i}(OverlayIndicatorBase);exports.Envelopes=Envelopes;var CCI=function(t){function i(i){var e=t.call(this)||this;return e._constant=.015,e.period=20,e.initialize(i),e}return __extends(i,t),Object.defineProperty(i.prototype,"constant",{get:function(){return this._constant},set:function(t){t!==this._constant&&(this._constant=wijmo_1.asNumber(t,!1),this._clearValues(),this._invalidate())},enumerable:!0,configurable:!0}),i.prototype._calculate=function(){var i=t.prototype._getLength.call(this);if(!(i<=0)){var e=t.prototype._getBindingValues.call(this,0),a=t.prototype._getBindingValues.call(this,1),s=t.prototype._getBindingValues.call(this,3),n=this._getXValues();this._yvals=_cci(e,a,s,this.period,this.constant),this._xvals=n?n.slice(this.period-1):wijmo_chart_finance_1._range(this.period-1,i-1)}},i}(SingleOverlayIndicatorBase);function _cci(t,i,e,a,s){wijmo_1.asArray(t,!1),wijmo_1.asArray(i,!1),wijmo_1.asArray(e,!1),wijmo_1.asInt(a,!1,!0),wijmo_1.asNumber(s,!1,!0);var n,o,r,l=wijmo_chart_finance_1._minimum(t.length,i.length,e.length),_=[],h=[],c=[];for(wijmo_1.assert(l>a&&a>1,"CCI period must be an integer less than the length of the data and greater than one."),o=0;o<l;o++)_.push(wijmo_chart_finance_1._average(t[o],i[o],e[o]));for(n=wijmo_chart_finance_1._sma(_,a),o=0;o<n.length;o++)r=_.slice(o,a+o).reduce(function(t,i){return t+Math.abs(n[o]-i)},0),h.push(r/a);for(_.splice(0,a-1),o=0;o<n.length;o++)c.push((_[o]-n[o])/(s*h[o]));return c}exports.CCI=CCI,exports._cci=_cci;var BollingerBands=function(t){function i(i){var e=t.call(this)||this;return e._period=20,e._multiplier=2,e.rendering.addHandler(e._rendering,e),e.initialize(i),e}return __extends(i,t),Object.defineProperty(i.prototype,"period",{get:function(){return this._period},set:function(t){t!==this._period&&(this._period=wijmo_1.asInt(t,!1,!0),this._clearValues(),this._invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"multiplier",{get:function(){return this._multiplier},set:function(t){t!==this._multiplier&&(this._multiplier=wijmo_1.asNumber(t,!1,!0),this._clearValues(),this._invalidate())},enumerable:!0,configurable:!0}),i.prototype.getDataRect=function(i,e){if(e)return e;if(t.prototype._getLength.call(this)<=0)return null;this._shouldCalculate()&&(this._init(),this._calculate());var a=this._upperYVals.concat(this._lowerYVals),s=wijmo_chart_finance_1._minimum(this._xVals),n=wijmo_chart_finance_1._maximum(this._xVals),o=wijmo_chart_finance_1._minimum(a),r=wijmo_chart_finance_1._maximum(a);return wijmo_chart_1._DataInfo.isValid(s)&&wijmo_chart_1._DataInfo.isValid(n)&&wijmo_chart_1._DataInfo.isValid(o)&&wijmo_chart_1._DataInfo.isValid(r)?new wijmo_1.Rect(s,o,n-s,r-o):null},i.prototype._clearValues=function(){t.prototype._clearValues.call(this),this._upperYVals=null,this._middleYVals=null,this._lowerYVals=null,this._xVals=null},i.prototype._shouldCalculate=function(){return!(this._upperYVals&&this._middleYVals&&this._lowerYVals&&this._xVals)},i.prototype._init=function(){t.prototype._init.call(this),this._upperYVals=[],this._middleYVals=[],this._lowerYVals=[],this._xVals=[]},i.prototype._calculate=function(){var i=t.prototype._getLength.call(this);if(!(i<=0)){var e=t.prototype.getValues.call(this,0),a=this._getXValues(),s=_bollingerBands(e,this.period,this.multiplier);this._upperYVals=s.uppers,this._middleYVals=s.middles,this._lowerYVals=s.lowers,this._xVals=a?a.slice(this.period-1):wijmo_chart_finance_1._range(this.period-1,i-1)}},i.prototype._rendering=function(i,e){if(e.cancel=!0,!(t.prototype._getLength.call(this)<=0)){this._shouldCalculate()&&(this._init(),this._calculate());var a=this.chart.series.indexOf(this),s=e.engine,n=this._getAxisX(),o=this._getAxisY(),r=wijmo_chart_finance_1._minimum(this._upperYVals.length,this._middleYVals.length,this._lowerYVals.length,this._xVals.length),l=wijmo_chart_1._BasePlotter.cloneStyle(this.style,["fill"]),_=this._getSymbolStroke(a),h=this.chart._plotrectId;if(r&&!(r<=0)){s.stroke=_,s.strokeWidth=2;for(var c,u,p,m=[],d=[],g=[],f=[],w=this._getLength(),y=0;y<r;y++)p=w-r+y,m.push(n.convert(this._xVals[y])),d.push(o.convert(this._upperYVals[y])),c=this._getDataPoint(this._xVals[y],this._upperYVals[y],a,p,n,o),(u=new wijmo_chart_1._CircleArea(new wijmo_1.Point(m[y],d[y]),.5*s.strokeWidth)).tag=c,this._hitTester.add(u,a),g.push(o.convert(this._middleYVals[y])),c=this._getDataPoint(this._xVals[y],this._middleYVals[y],a,p,n,o),(u=new wijmo_chart_1._CircleArea(new wijmo_1.Point(m[y],g[y]),.5*s.strokeWidth)).tag=c,this._hitTester.add(u,a),f.push(o.convert(this._lowerYVals[y])),c=this._getDataPoint(this._xVals[y],this._lowerYVals[y],a,p,n,o),(u=new wijmo_chart_1._CircleArea(new wijmo_1.Point(m[y],f[y]),.5*s.strokeWidth)).tag=c,this._hitTester.add(u,a);this._hitTester.add(new wijmo_chart_1._LinesArea(m,d),a),this._hitTester.add(new wijmo_chart_1._LinesArea(m,g),a),this._hitTester.add(new wijmo_chart_1._LinesArea(m,f),a),s.drawLines(m,d,null,l,h),s.drawLines(m,g,null,l,h),s.drawLines(m,f,null,l,h)}}},i.prototype.getCalculatedValues=function(i){i=wijmo_1.asString(i,!1);var e=[],a=0;if(t.prototype._getLength.call(this)<=0)return e;switch(this._shouldCalculate()&&(this._init(),this._calculate()),i){case"upperBand":for(;a<this._upperYVals.length;a++)e.push({x:this._xVals[a],y:this._upperYVals[a]});break;case"middleBand":for(;a<this._middleYVals.length;a++)e.push({x:this._xVals[a],y:this._middleYVals[a]});break;case"lowerBand":for(;a<this._lowerYVals.length;a++)e.push({x:this._xVals[a],y:this._lowerYVals[a]})}return e},i}(OverlayIndicatorBase);function _bollingerBands(t,i,e){wijmo_1.asArray(t,!1),wijmo_1.asInt(i,!1,!0),wijmo_1.asNumber(e,!1,!0),wijmo_1.assert(t.length>i&&i>1,"Bollinger Bands period must be an integer less than the length of the data and greater than one.");var a,s=wijmo_chart_finance_1._sma(t,i),n=[];for(a=i;a<=t.length;a++)n.push(wijmo_chart_finance_1._stdDeviation(t.slice(a-i,a)));var o=s,r=s.map(function(t,i){return t+n[i]*e});return{lowers:s.map(function(t,i){return t-n[i]*e}),middles:o,uppers:r}}exports.BollingerBands=BollingerBands,exports._bollingerBands=_bollingerBands;var ATR=function(t){function i(i){var e=t.call(this)||this;return e.period=14,e.initialize(i),e}return __extends(i,t),i.prototype._calculate=function(){if(!(t.prototype._getLength.call(this)<=0)){var i=t.prototype._getBindingValues.call(this,0),e=t.prototype._getBindingValues.call(this,1),a=t.prototype._getBindingValues.call(this,3),s=this._getXValues();this._yvals=wijmo_chart_finance_1._avgTrueRng(i,e,a,this.period),this._xvals=s?s.slice(this.period-1):wijmo_chart_finance_1._range(this.period-1,i.length)}},i}(SingleOverlayIndicatorBase);exports.ATR=ATR,wijmo_1._registerModule("wijmo.chart.finance.analytics",selfModule);